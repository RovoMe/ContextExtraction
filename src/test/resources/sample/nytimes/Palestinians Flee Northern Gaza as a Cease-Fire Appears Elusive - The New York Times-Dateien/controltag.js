
/* Controltag Loader for New York Times */
(function(){
  var debugging = /kxdebug/.test(location);
  var log = function() {
    // It's a flag, so if it's there, then it means debug.
    debugging && window.console && console.log([].slice.call(arguments).join(' '));
  };

  var load = function(url, callback) {
    log('Loading script from:', url);
    var node = document.createElement('script');
    node.async = true;  // This is just to be friendly.
    node.src = url;

    // Connect to both in case we're in older IE.
    node.onload = node.onreadystatechange = function() {
      var state = node.readyState;
      if (!callback.done && (!state || /loaded|complete/.test(state))) {
        log('Script loaded from:', url);
        callback.done = true;  // Mark the callback, so we don't load it twice on accident.
        callback();
      }
    };

    // Fetch the first script element, so we can insert the
    // controltag before it. There *must* be at least one
    // script element, or this code would never be called
    var sibling = document.getElementsByTagName('script')[0];
    sibling.parentNode.insertBefore(node, sibling);
  };

  // ControlTag simply crashes when opening a website from Twitter browser on
  // iOS, temporarily disable CT when Twitter for iPhone is detected until they
  // fix this (works fine with other twitter client though)
  if (/Twitter for iPhone/.test(window.navigator.userAgent || '')) return;

  var config = {"partner_segment_map": {}, "context_terms": [{"id": "It7twOd-", "value": "earnings"}, {"id": "It7twOuC", "value": "hedge fund"}, {"id": "It7twO8P", "value": "assets under management"}, {"id": "It7twPLA", "value": "alpha"}, {"id": "It7twPZI", "value": "asset allocation"}, {"id": "It7twPoN", "value": "leverage"}, {"id": "It7twP1T", "value": "hedge"}, {"id": "It7twQDG", "value": "currency"}, {"id": "It7twQTj", "value": "fixed income"}, {"id": "It7twQhF", "value": "commodity"}, {"id": "It7twQ1Q", "value": "commodities"}, {"id": "It7twRCv", "value": "currencies"}, {"id": "It7twRQs", "value": "yen"}, {"id": "It7twRfW", "value": "euro"}, {"id": "It7twR4H", "value": "pound"}, {"id": "It7twSN8", "value": "oil"}, {"id": "It7twSci", "value": "natural gas"}, {"id": "It7twStj", "value": "platinum"}, {"id": "It7twS9F", "value": "gold"}, {"id": "It7twTK8", "value": "copper"}, {"id": "It7twTYy", "value": "silver"}, {"id": "It7twTny", "value": "light sweet crude"}, {"id": "It7twT6t", "value": "brent crude"}, {"id": "It7twUJY", "value": "heating oil"}, {"id": "It7twUZG", "value": "RBOB gasoline"}, {"id": "It7twUoy", "value": "palladium"}, {"id": "It7twU3w", "value": "High-grade copper"}, {"id": "It7twVGD", "value": "corn"}, {"id": "It7twVXf", "value": "soybeans"}, {"id": "It7twVnB", "value": "wheat"}, {"id": "It7twV0H", "value": "oats"}, {"id": "It7twWBG", "value": "rough rice"}, {"id": "It7twWOr", "value": "peso"}, {"id": "It7twWcA", "value": "franc"}, {"id": "It7twWpq", "value": "krona"}, {"id": "It7twW2_", "value": "krone"}, {"id": "It7twXEk", "value": "yuan"}, {"id": "It7twXVy", "value": "hong kong dollar"}, {"id": "It7twXjJ", "value": "south korea won"}, {"id": "It7twXwZ", "value": "dollar U.S."}, {"id": "It7twYBJ", "value": "U.S. dollar"}, {"id": "It7twYPK", "value": "S&P 500"}, {"id": "It7twYeD", "value": "Dow Jones Industrials"}, {"id": "It7twYse", "value": "Dow Jones Industrials average"}, {"id": "It7twY5o", "value": "NASDAQ"}, {"id": "It7twZIs", "value": "NASDAQ 100"}, {"id": "It7twZZu", "value": "FTSE 100"}, {"id": "It7twZnE", "value": "DAX"}, {"id": "It7twZ1S", "value": "CAC 40"}, {"id": "It7twaDe", "value": "FTSE Eurofirst 300"}, {"id": "It7twaQu", "value": "Nikkei 225"}, {"id": "It7twaeO", "value": "Shanghai Composite"}, {"id": "It7twarZ", "value": "Hang Seng"}, {"id": "It7twa4p", "value": "CASE 30"}, {"id": "It7twbGl", "value": "Tel Aviv 100"}, {"id": "It7twbUb", "value": "3-month T-bill"}, {"id": "It7twbiB", "value": "6-month T-bill"}, {"id": "It7twbvS", "value": "2-year treasury note"}, {"id": "It7twb8i", "value": "5-year treasury note"}, {"id": "It7twcKU", "value": "10-year treasury note"}, {"id": "It7twcX5", "value": "30-year treasury bond"}, {"id": "It7twcmc", "value": "Prime rate"}, {"id": "It7twc96", "value": "Fed funds rate"}, {"id": "It7twdNF", "value": "Chicago Board of Trade"}, {"id": "It7twdbG", "value": "New York Mercantile Exchange"}, {"id": "It7twdpr", "value": "Comex"}, {"id": "It7twd8G", "value": "market capitalization"}, {"id": "It7tweJV", "value": "trader"}, {"id": "It7tweYJ", "value": "equity trading"}, {"id": "It7twelU", "value": "earnings report"}, {"id": "It7twe05", "value": "liquidity pool"}, {"id": "It7twfCI", "value": "earnings call"}, {"id": "It7twfPf", "value": "earnings season"}, {"id": "It7twffL", "value": "bond trading"}, {"id": "It7twfvK", "value": "FX"}, {"id": "It7twf_O", "value": "currency trading"}, {"id": "It7twgNP", "value": "commodities trading"}, {"id": "It7twga3", "value": "short sale"}, {"id": "It7twgom", "value": "IPO"}, {"id": "It7twg2j", "value": "secondary offering"}, {"id": "It7twhEr", "value": "convertible offering"}, {"id": "It7twhUh", "value": "arbitrage"}, {"id": "It7twhkB", "value": "equity-linked securities"}, {"id": "It7twhyN", "value": "value stock"}, {"id": "It7twiAd", "value": "growth stock"}, {"id": "It7twiPV", "value": "global macro"}, {"id": "It7twicz", "value": "long-short"}, {"id": "It7twirG", "value": "long/short"}, {"id": "It7twi4W", "value": "equity hedge"}, {"id": "It7twjF_", "value": "market neutral"}, {"id": "It7twjXY", "value": "relative value"}, {"id": "It7twjlp", "value": "relative value arbitrage"}, {"id": "It7twjy5", "value": "convertible arbitrage"}, {"id": "It7twkBU", "value": "distressed"}, {"id": "It7twkQC", "value": "distressed debt"}, {"id": "It7twkiY", "value": "convertible hedge"}, {"id": "It7twkwa", "value": "call option"}, {"id": "It7twlBe", "value": "put option"}, {"id": "Iuee5NPn", "value": "sleep apnea"}, {"id": "Iuee5OT8", "value": "insomnia"}, {"id": "Iuee5O7g", "value": "bonds"}, {"id": "Iuee5PF-", "value": "corporate bond"}, {"id": "Iuee5PTM", "value": "bond"}, {"id": "Iuee5Pvj", "value": "investment grade"}, {"id": "Iuee5QRy", "value": "high yield"}, {"id": "Iuee5QhY", "value": "yield curve"}, {"id": "Iuee5Q6q", "value": "Treasury yield"}, {"id": "Iuee5RFG", "value": "convertibles"}, {"id": "Iuee5Rt9", "value": "FINRA TRACE Coporate Bonds"}, {"id": "Iuee5R83", "value": "Government Bonds"}, {"id": "Iuee5SPr", "value": "sleep"}, {"id": "Iuee5Sdi", "value": "sleep disorder"}, {"id": "Iuee5SnR", "value": "apnea"}, {"id": "Iuee5S8X", "value": "snoring"}, {"id": "JKzZqbR8", "value": "nonprofit"}, {"id": "JKzZqbgf", "value": "non profit"}, {"id": "JKzZqbu3", "value": "non-profit"}, {"id": "JKzZqb-8", "value": "not for profit"}, {"id": "JKzZqcOD", "value": "fundraise"}, {"id": "JKzZqccZ", "value": "fund raise"}, {"id": "JKzZqctV", "value": "fund raising"}, {"id": "JKzZqc7_", "value": "relief fund"}, {"id": "JKzZqdJw", "value": "charity"}, {"id": "JKzZqdaX", "value": "charities"}, {"id": "JKzZqdtu", "value": "charitable"}, {"id": "JKzZqd85", "value": "donate"}, {"id": "JKzZqeLr", "value": "donation"}, {"id": "JKzZqeaQ", "value": "volunteer"}, {"id": "JKzZqeox", "value": "community service"}, {"id": "JKzZqe4_", "value": "world hunger"}, {"id": "JKzZqfK6", "value": "philanthropy"}, {"id": "JKzZqfdk", "value": "philanthropic"}, {"id": "JKzZqfr5", "value": "disaster relief"}, {"id": "JKzZqf57", "value": "red cross"}, {"id": "JKzZqgHu", "value": "UNICEF"}, {"id": "JKzZqgVc", "value": "United Nations Foundation"}, {"id": "JKzZqgjp", "value": "UN Foundation"}, {"id": "JKzZqgxP", "value": "Habitat for Humanity"}, {"id": "JKzZqg-7", "value": "Make-A-Wish"}, {"id": "JKzZqhMp", "value": "Greenpeace"}, {"id": "JNW0ERTd", "value": "nissan motor co"}, {"id": "JNW0ETKR", "value": "toyota motor corp"}, {"id": "JNW0EVhB", "value": "honda motor co ltd"}, {"id": "JPx4HRK1", "value": "mobileiron"}, {"id": "JP5ccbks", "value": "mobile iron"}, {"id": "JSbyYQH6", "value": "Three-tier system"}, {"id": "JSbyYT8e", "value": "Brewery"}, {"id": "JSbyYUSz", "value": "Breweries"}, {"id": "JSbyYUnl", "value": "beer wholesaler"}, {"id": "JSbyYU7y", "value": "beer"}, {"id": "JSbyYVP8", "value": "stout"}, {"id": "JSbyYVki", "value": "porter"}, {"id": "JSbyYV6s", "value": "ale"}, {"id": "JSbyYWf0", "value": "homebrewing"}, {"id": "JSbyYW0P", "value": "home brew"}, {"id": "JSbyYXOI", "value": "microbrewery"}, {"id": "JSbyYXh2", "value": "winter wheat"}, {"id": "JSbyYX3r", "value": "Anheuser-Busch"}, {"id": "JSbyYYL0", "value": "Heineken"}, {"id": "JSbyYYf9", "value": "MillerCoors"}, {"id": "JSbyYY0Z", "value": "Pabst Brewing"}, {"id": "JSbyYZJg", "value": "Yuengling"}, {"id": "JSbyYZeh", "value": "Lagunitas"}, {"id": "JSbyYaop", "value": "Bell's Brewery"}, {"id": "JSbyYcXu", "value": "Brooklyn Brewery"}, {"id": "JSbyYcrg", "value": "Sierra Nevada Brewing"}, {"id": "JSbyYc_l", "value": "Abita Brewing Company"}, {"id": "JSbyYdU3", "value": "Great Lakes Brewing Company"}, {"id": "JSbyYd3_", "value": "Harpoon Brewery"}, {"id": "JSbyYeLw", "value": "Dogfish Head Craft Brewery"}, {"id": "JSbyYefC", "value": "Boston Beer Co."}, {"id": "JSbyYe0V", "value": "New Belgium Brewing Co."}, {"id": "JSbyYfIK", "value": "Stella Artois"}, {"id": "JSbyYfdz", "value": "Beck's"}, {"id": "JSbyYf1w", "value": "Bud Light"}, {"id": "JSbyYgKQ", "value": "Budweiser"}, {"id": "JSbyYgeC", "value": "Busch"}, {"id": "JSbyYgyB", "value": "Goose Island"}, {"id": "JSbyYhH5", "value": "Landshark"}, {"id": "JSbyYhc2", "value": "Michelob"}, {"id": "JSbyYhwj", "value": "Rolling Rock"}, {"id": "JSbyYiET", "value": "Shock Top"}, {"id": "JSbyYidg", "value": "Pabst"}, {"id": "JSbyYiy9", "value": "Schlitz"}, {"id": "JSbyYjIg", "value": "Sam Adams brands"}, {"id": "JSbyYjdE", "value": "Genesee"}, {"id": "JSbyYjxf", "value": "Magic Hat"}, {"id": "JSbyYkEy", "value": "Ommegang"}, {"id": "JSbyYkcG", "value": "Long Trail"}, {"id": "JSbyYkwd", "value": "Kingfisher"}, {"id": "Js7UYlcf", "value": "the met"}, {"id": "Js7UYllv", "value": "metropolitan museum of art"}, {"id": "JxM4laDD", "value": "volvo"}, {"id": "JxfHw3u_", "value": "hepatitis"}, {"id": "JxfHw36L", "value": "hepatitis c"}, {"id": "JxfHw4Cx", "value": "hep c"}, {"id": "Jzu3ClM5", "value": "Spanish Steps"}, {"id": "Jzu3Cld9", "value": "Palatine Hill"}, {"id": "Jzu3Cl1Z", "value": "Colosseum"}, {"id": "Jzu3CmD9", "value": "Florence Cathedral"}, {"id": "Jzu3CmSy", "value": "Grand Canal"}, {"id": "Jzu3CmhH", "value": "Basilica"}, {"id": "Jzu3CmvY", "value": "Amalfi Coast"}, {"id": "Jzu3Cm92", "value": "Roman Forum"}, {"id": "Jzu3CnNN", "value": "Pantheon"}, {"id": "Jzu3Cnbu", "value": "Sistine Chapel"}, {"id": "Jzu3Cnrz", "value": "Leaning Tower of Pisa"}, {"id": "Jzu3Cn69", "value": "Piazza San Marco"}, {"id": "Jzu3CobA", "value": "Lake Como"}, {"id": "Jzu3CosA", "value": "Galleria Borghese"}, {"id": "Jzu3Co6x", "value": "Mount Vesuvius"}, {"id": "Jzu3CpNv", "value": "Trevi Fountain"}, {"id": "Jzu3CpcK", "value": "Pizza della Signoria"}, {"id": "Jzu3Cpqj", "value": "Milan Cathedral"}, {"id": "Jzu3Cp5D", "value": "Piazza Navona"}, {"id": "Jzu3CqJF", "value": "Archbasilica"}, {"id": "Jzu3CqXm", "value": "Rialto Bridge"}, {"id": "Jzu3Cq1y", "value": "Teatro alla Scala"}, {"id": "Jzu3CrUw", "value": "Palazzo Vecchio"}, {"id": "Jzu3CrwX", "value": "Ponte Vecchio"}, {"id": "Jzu3CsHL", "value": "Piazzale Michelangelo"}, {"id": "Jzu3CsVe", "value": "Lake Garda"}, {"id": "Jzu3Csjn", "value": "Piazza del Campo"}, {"id": "Jzu3CtC2", "value": "San Miniato al Monte"}, {"id": "Jzu3CtRR", "value": "Palazzo Pitti"}, {"id": "Jzu3Ctfh", "value": "Capitoline Hill"}, {"id": "Jzu3CtvN", "value": "Villa Borghese"}, {"id": "Jzu3Ct9l", "value": "Teatro La Fenice"}, {"id": "Jzu3CuMe", "value": "Siena Cathedral"}, {"id": "KElbNouu", "value": "heart disease"}, {"id": "KElbNpgb", "value": "stroke"}, {"id": "KElbNqKL", "value": "atrial fibrillation"}, {"id": "KE7mHY93", "value": "volkswagen"}, {"id": "KE7mHZIA", "value": "audi"}, {"id": "KE7mHZR2", "value": "vw"}, {"id": "KFeAZkTf", "value": "LGBT"}, {"id": "KFeAZkrz", "value": "Lesbian"}, {"id": "KFeAZlBl", "value": "Gay Rights"}, {"id": "KFeAZlXc", "value": "Transgender"}, {"id": "KFeAZlzn", "value": "Bisexual"}], "tags": [{"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid && typeof kuid != 'undefined') {\r\n      var prefix = location.protocol == 'https:' ? \"https:\" :\"http:\";\r\n      var r_url = prefix + '//cm.g.doubleclick.net/pixel'\r\n      var kurl = prefix + '//apiservices.krxd.net/um?partner=google&r=' + r_url;\r\n      var i = new Image();\r\n      i.src = kurl;\r\n  }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "type": "publisher", "id": 28172, "name": "Google User Matching"}, {"content": "<script>\r\n(function(){\r\n  if (window.location.protocol == \"http:\") {\r\n    (new Image()).src=\"http://ckm-m.xp1.ru4.com/activity?_o=62795&_t=kx_cm&redirect=20\";\r\n    }\r\n  if (window.location.protocol == \"https:\"){\r\n    (new Image()).src=\"https://msec.xp1.ru4.com/activity?_o=62795&_t=kx_cm&redirect=20\";\r\n    }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "type": "publisher", "id": 35674, "name": "x+1 User Match"}, {"content": "", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "id": 57186, "name": "Dun & Bradstreet provider tag"}, {"content": "", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "id": 57190, "name": "Webbula provider tag"}, {"content": "", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "id": 57191, "name": "Nielsen - Precision Marketing (via Exelate) provid"}, {"content": "", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "id": 57192, "name": "InfoGroup provider tag"}, {"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n      var url =\r\n\"https://analytics.twitter.com/i/adsct?p_user_id=\" + kuid +\r\n\"&p_id=10623\";\r\n      var i = new Image();\r\n      i.src = url;     \r\n  }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "type": "publisher", "id": 44173, "name": "Twitter user match"}, {"content": "", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "id": 45251, "name": "WhoToo Partner Network provider tag"}, {"content": "<script>\r\n// LiveRamp universal user match\r\n\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n      var liveramp_url = 'https://idsync.rlcdn.com/379708.gif?partner_uid=' + kuid;\r\n      var i = new Image();\r\n      i.src = liveramp_url;      \r\n  }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "type": "data provider", "id": 45252, "name": "NetProspex provider tag"}, {"content": "<script>\r\n// Blank\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 19, "content_type": "html", "freq_cap": 3, "timing": "asap", "method": "document", "type": "data provider", "id": 31476, "name": "Nielsen (via Exelate) provider tag"}, {"content": "<script>\r\n    (function() {\r\n        var kuid = Krux('get', 'user');\r\n        if (kuid) {\r\n            var prefix = location.protocol == 'https:' ? \"https:\" : \"http:\";\r\n            var kurl_params = encodeURIComponent(\"_kuid=\" + kuid + \"&_kdpid=2dd640a6-6ebd-4d4f-af30-af8baa441a0d&dlxid=<na_id>&dlxdata=<na_da>\");\r\n            var kurl = prefix + \"//beacon.krxd.net/data.gif?\" + kurl_params;\r\n            var dlx_url = '//r.nexac.com/e/getdata.xgi?dt=br&pkey=gpwn29rvapq62&ru=' + kurl;\r\n            var i = new Image();\r\n            i.src = dlx_url;\r\n        }\r\n    })();\r\n</script>", "target": null, "target_action": "append", "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 8, "content_type": "html", "freq_cap": 1, "timing": "onload", "method": "document", "type": "data provider", "id": 10508, "name": "DataLogix provider tag"}, {"content": "<script>\r\n    // Empty by design.\r\n</script>\r\n", "target": null, "target_action": "append", "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 27, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "data provider", "id": 27935, "name": "IXI Digital (Network) provider tag"}, {"content": "<img src=\"//adadvisor.net/adscores/g.js?sid=9212244187&_kdpid=2111c0af-fc3a-446f-ab07-63aa74fbde8e\" />", "target": null, "target_action": "append", "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 22, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "data provider", "id": 31339, "name": "AdAdvisor S2S provider tag"}, {"content": "<script>\r\n// this tag is intentionally blank\r\n</script>", "target": null, "target_action": "append", "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 6, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "data provider", "id": 15486, "name": "Technographic Data provider tag"}, {"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n    Krux('require:http').pixel({\r\n      url: \"//loadm.exelator.com/load\",\r\n      data: {\r\n          _kdpid: 'e4942ff0-4070-4896-a7ef-e6a5a30ce9f9',\r\n          buid: kuid,\r\n          p: '204',\r\n          g: '270',\r\n          j: '0'\r\n      }});\r\n  }\r\n  })();\r\n</script>", "target": null, "target_action": "append", "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 11, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "data provider", "id": 21418, "name": "eXelate Media provider tag"}, {"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid) {\r\n      var liveramp_url = 'https://idsync.rlcdn.com/379708.gif?partner_uid=' + kuid;\r\n      var i = new Image();\r\n      i.src = liveramp_url;      \r\n  }\r\n})();\r\n</script>", "target": null, "target_action": "append", "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 21, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "data provider", "id": 22998, "name": "Acxiom S2S provider tag"}, {"content": "", "target": null, "target_action": "append", "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 14, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "id": 21233, "name": "Krux Geographic Data provider tag"}, {"content": "<script>\r\n(function() {\r\n    if (window.location.pathname != '/') {\r\n         var i = new Image();\r\n        i.src = '//p.rfihub.com/cm?in=1&pub=6919';\r\n    }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 31745, "name": "Rocket Fuel User-Match Pixel"}, {"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  var cbust = Math.round(new Date().getTime() / 1000);\r\n  if (kuid) {\r\n    Krux('require:http').pixel({\r\n      url: \"//ib.adnxs.com/pxj\",\r\n      data: {\r\n          bidder: '140',\r\n          seg: '381342',\r\n          action: \"setuid('\" + kuid + \"')\",\r\n          bust: cbust\r\n      }});\r\n  }\r\n  })();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 28173, "name": "Appnexus Extension User Matching"}, {"criteria": [{"operator": "notContains", "name": "url", "value": "https"}], "content": "<script>\r\n(function(){\r\n    var prefix = window.location.protocol == 'https:' ? 'https:' : 'http:';\r\n    var url = prefix + '//kr.ixiaa.com/C726AB29-0470-440B-B8D2-D552CED3A3DC/a.gif';\r\n    new Image().src = url;\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "data provider", "id": 27728, "name": "IXI Digital (Open Market) provider tag"}, {"content": "<script>\r\n(function() { \r\n  function getMetaValue(name) {\r\n    if (! document.querySelector) {\r\n      return;\r\n    }\r\n    var metaTag = document.querySelector(\"meta[name='\" + name + \"']\");\r\n    return metaTag && metaTag.content || \"\";\r\n  }\r\n\r\n  Krux('set', 'section', getMetaValue('CG'));\r\n  Krux('set', 'subsection', getMetaValue('SCG'));\r\n  Krux('set', 'page_attr_page_type', getMetaValue('PT'));\r\n  Krux('scrape', {\r\n    page_attr_cg: {\r\n      meta_name: \"CG\"\r\n    },\r\n    page_attr_scg: {\r\n      meta_name: \"SCG\"\r\n    },\r\n    page_attr_prot: {\r\n      meta_name: \"WT.z_prot\"\r\n    },\r\n    page_attr_ref: {\r\n    url_param: \"ref\"\r\n    },\r\n    page_attr_pst: {\r\n      meta_name: \"PST\"\r\n    },\r\n    page_attr_des: {\r\n      meta_name: \"des\"\r\n    },\r\n    page_attr_per: {\r\n      meta_name: \"per\"\r\n    },\r\n    page_attr_org: {\r\n      meta_name: \"org\"\r\n    },\r\n    page_attr_geo: {\r\n      meta_name: \"geo\"\r\n    },\r\n    page_attr_author: {\r\n      meta_name: \"author\"\r\n    }, \r\n    page_attr_reco: {\r\n      meta_name: \"RECO\"\r\n    },  \r\n    page_attr_rer: {\r\n      meta_name: \"RER\"\r\n    },  \r\n    page_attr_res: {\r\n      meta_name: \"RES\"\r\n    },  \r\n    page_attr_resz: {\r\n      meta_name: \"RESZ\"\r\n    },  \r\n    page_attr_rentals: {\r\n      meta_name: \"PSSST\"\r\n    },  \r\n    page_attr_ticker: {\r\n      meta_name: \"ticker\"\r\n    },\r\n    page_attr_registered: {\r\n      javascript: 'regstatus'\r\n    },\r\n    page_attr_referrer: {\r\n      javascript: 'document.referrer'\r\n    },\r\n    page_attr_url_path_1: {\r\n      url_path: \"1\"\r\n    }\r\n  });\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": 1, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 13157, "name": "Krux Scrape Page Attributes"}, {"content": "<script>\r\n    var prefix = location.protocol == 'https:' ? 'https:' :'http:';\r\n    var pageViews = Krux('require:store').get('kxtag47674.day');\r\n\r\n    if (pageViews >= 1 && pageViews <= 3) {\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=seque0;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n\r\n        // exclusion pixel for 4-6 page views\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier200;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n\r\n        // exclusion pixel for 6+ page views\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier300;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n    }\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 47208, "name": "1-3_PageViews"}, {"content": "<script>\r\n    var prefix = location.protocol == 'https:' ? 'https:' :'http:';\r\n    var pageViews = Krux('require:store').get('kxtag47674.day');\r\n\r\n    if (pageViews >= 4 && pageViews < 6) {\r\n        // exclusion pixel for 1-3 page views\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier10;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier20;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n\r\n        // exclusion pixel for 6+ page views\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier300;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n    }\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 47209, "name": "4-6_PageViews"}, {"content": "<script>\r\n    var prefix = location.protocol == 'https:' ? 'https:' :'http:';\r\n    var pageViews = Krux('require:store').get('kxtag47674.day');\r\n\r\n    if (pageViews >= 6) {\r\n        // exclusion pixel for 1-3 page views\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier10;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n\r\n        // exclusion pixel for 4-6 page views\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier200;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n\r\n        var axel = Math.random() + \"\";\r\n        var a = axel * 10000000000000;\r\n        document.write('<iframe src=\"' + prefix + '//3951336.fls.doubleclick.net/activityi;src=3951336;type=digit0;cat=tier30;ord=' + a + '?\" width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"></iframe>');\r\n    }\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 47210, "name": "6+_PageVIews"}, {"content": "<script>\r\n(function () {\r\n\tKrux('scrape', {\"user_attr_cookie_isEDU\": {cookie: \"isEDU\"}});\r\n\tKrux('scrape', {\"user_attr_cookie_subBundle\": {cookie: \"subBundle\"}});\r\n\tKrux('scrape', {\"user_attr_cookie_HDstatus\": {cookie: \"HDstatus\"}});\r\n\tKrux('scrape', {\"user_attr_cookie_userProp\": {cookie: \"userProp\"}});\t\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 64154, "name": "Cookie reader isEDU subBundle HDstatus"}, {"criteria": [{"operator": "=", "name": "segment", "value": "oxhxo9xee"}], "content": "<img width=\"1\" height=\"1\" src=\"//action.media6degrees.com/orbserv/nspix?pixId=25711&pcv=54&ns=483&ncv=31&nc=259975\" />", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 48559, "name": "Dstillery Arts Reader"}, {"criteria": [{"operator": "=", "name": "segment", "value": "n58825q2q"}], "content": "<img width=\"1\" height=\"1\" src=\"//action.media6degrees.com/orbserv/nspix?pixId=25711&pcv=54&ns=483&ncv=31&nc=259976\" />", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 48560, "name": "Dstillery Sports Reader"}, {"criteria": [{"operator": "=", "name": "segment", "value": "oc3xz8suw"}], "content": "<img width=\"1\" height=\"1\" src=\"//action.media6degrees.com/orbserv/nspix?pixId=25711&pcv=54&ns=483&ncv=31&nc=259977\" />", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 48561, "name": "Distillery Prospecting Food"}, {"criteria": [{"operator": "=", "name": "segment", "value": "m9pwg0j70"}], "content": "<img width=\"1\" height=\"1\" src=\"//action.media6degrees.com/orbserv/nspix?pixId=25711&pcv=54&ns=483&ncv=31&nc=259978\" />", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 48562, "name": "Dstillery Registered Users"}, {"criteria": [{"operator": "=", "name": "segment", "value": "osihzsglx"}], "content": "<img width=\"1\" height=\"1\" src=\"//action.media6degrees.com/orbserv/nspix?pixId=25711&pcv=54&ns=483&ncv=31&nc=259979\" />", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 48563, "name": "Dstillery Prospecting Travel"}, {"criteria": [{"operator": "=", "name": "segment", "value": "lmvity5kb"}], "content": "<img width=\"1\" height=\"1\" src=\"//action.media6degrees.com/orbserv/nspix?pixId=25711&pcv=54&ns=483&ncv=31&nc=259980\" />", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 48564, "name": "Dstillery Medium Users"}, {"criteria": [{"operator": "=", "name": "segment", "value": "obz8k7b8a"}], "content": "<img width=\"1\" height=\"1\" src=\"//action.media6degrees.com/orbserv/nspix?pixId=25711&pcv=54&ns=483&ncv=31&nc=259981\" />", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 48566, "name": "Dstillery Magazine Readers"}, {"content": "<script type=\"text/javascript\">Krux('social.init');</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": false, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 30903, "name": "Krux Track Social"}, {"content": "<script>\r\n(function(){\r\n  if (window.location.pathname != '/') {\r\n    var kuid = Krux('get', 'user');\r\n    if (kuid) {\r\n      var liveramp_url = 'https://idsync.rlcdn.com/379708.gif?partner_uid=' + kuid;\r\n      var i = new Image();\r\n      i.src = liveramp_url;\r\n    }\r\n  }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 64439, "name": "Live Ramp NYT specific (will not fire on homepage)"}, {"content": "<script>\r\n(function() {\r\n  Krux('scrape', { 'user_attr_new-ref': {meta_name: 'WT.z_ref'}});\r\n})();\r\n// Using Globals PriceMin to produce page attribute pricemin\r\nKrux('scrape', { \"page_attr_pricemin\": {js_global: \"PriceMin\"}});\r\n// Using Globals PriceMax to produce page attribute pricemax\r\nKrux('scrape', { \"page_attr_pricemax\": {js_global: \"PriceMax\"}});\r\n// Using Meta keywords to produce page attribute keywords\r\nKrux('scrape', { \"page_attr_keywords2\": {meta_name: \"keywords\"}});\r\n// Using UrlPath 2 to produce page attribute url_path_2\r\nKrux('scrape', { \"page_attr_url_path_2\": {url_path: \"2\"}});\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": 1, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 23488, "name": "Krux Data Transfer Code "}, {"criteria": [{"operator": "notContains", "name": "url", "value": "https"}], "content": "<script>\r\n(function(){\r\n        var kuid = Krux('get', 'user');\r\n        var prefix = location.protocol;\r\n        if (kuid) {\r\n           var dxu_url = '//i.w55c.net/ping_match.gif?st=Krux&rurl=' + prefix + '//beacon.krxd.net/usermatch.gif?partner=dataxu&uid=_wfivefivec_';\r\n           var i = new Image();\r\n           i.src = dxu_url;\r\n        }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 31698, "name": "DataXu User Matching"}, {"content": "<script>\r\n  Krux('scrape', {\r\n\t\"user_attr_nyt_cookie\": {\r\n\t\tjavascript: \"TAGX.data.get('cookies.nyt-a')\"\r\n\t},\r\n\t\"user_attr_nyt_user_id\": {\r\n\t\tjavascript: \"TAGX.data.get('user.uid')\"\r\n\t},\r\n\t\"user_attr_nyt_user_type\": {\r\n\t\tjavascript: \"TAGX.data.get('user.type')\"\r\n\t},\r\n\t\"user_attr_nyt_insiderAB\": {\r\n\t\tcookie: \"insiderAB\"\r\n\t}\r\n  });\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": 1, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 67546, "name": "DTC to capture NYT user data "}, {"content": "<script>\r\n(function(){\r\n   if (window.location.pathname != '/') {\r\n        var kuid = window.Krux('get', 'user');\r\n            if (kuid) {\r\n                var min = 1000000000;\r\n                var max = 9999999999;\r\n                var rand = Math.floor(Math.random() * (max - min)) + min;\r\n                var prefix = location.protocol == 'https:' ? \"https:\" :\"http:\";\r\n                var url = prefix\r\n                        + '//t.mookie1.com/t/v1/event?migClientId=6726&migAction=krux&migSource=mig&migRandom='\r\n                        + rand\r\n                        +'&migParam1='\r\n                        + kuid;\r\n                (new Image()).src = url;\r\n        }\r\n    }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": false, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 57309, "name": "Krux- Xaxis Tag"}, {"content": "<script>\r\n    (function() {\r\n        var prefix = location.protocol == 'https:' ? \"https:\" : \"http:\";\r\n        var tm_url = prefix + '//rtd.tubemogul.com/upi/pid/NC4WTmcy?redir=http%3A%2F%2Fbeacon.krxd.net%2Fusermatch.gif%3Fpartner_id%3Dcb276571-e0d9-4438-9fd4-80a1ff034b01%26puid%3D%24%7BTM_USER_ID%7D'\r\n        var i = new Image();\r\n        i.src = tm_url;\r\n    })();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "criteria": [{"operator": "contains", "name": "url", "value": "kxtest=1"}], "timing": "onload", "method": "document", "type": "publisher", "id": 23780, "name": "TubeMogul User Match"}, {"content": "<script>\r\n// Using Cookie RMID to produce page attribute cookie_rmid\r\nKrux('scrape', { \"user_attr_cookie_rmid\": {cookie: \"RMID\"}});\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": 1, "content_type": "html", "timing": "onload", "method": "document", "type": "publisher", "id": 18687, "name": "Krux Pull RMID"}, {"content": "<script>\r\n(function(){\r\n    var kuid = Krux('get', 'user');\r\n        if (kuid) {\r\n            var prefix = 'https:';\r\n            var rurl = prefix + '//cms.analytics.yahoo.com/cms?partner_id=KRUX';\r\n            var i = new Image();\r\n            i.src = rurl;\r\n        }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 5, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 71078, "name": "Test Yahoo! DataX"}, {"content": "<script type=\"text/javascript\">\r\n(function() {\r\n    (new Image()).src = '//adadvisor.net/adscores/g.js?sid=9212244187&_kdpid=2111c0af-fc3a-446f-ab07-63aa74fbde8e';\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 5, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 71079, "name": "Test Neustar User Matching"}, {"content": "<script>\r\n(function(){\r\n        var kuid = Krux('get', 'user');\r\n        var prefix = window.location.protocol == 'https:' ? 'https:' : 'http:';\r\n        if (kuid) {\r\n           var url = prefix + '//pix.btrll.com/partner/868092.png';\r\n           (new Image()).src = url;\r\n        }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 5, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 71080, "name": "Test BrightRoll user match"}, {"content": "<script type=\"text/javascript\">\r\n(function() {\r\n    (new Image()).src = '//sync.tidaltv.com/genericusersync.ashx?dpid=395';\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 5, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 71081, "name": "Test Videology User Matching"}, {"content": "<script>\r\n(function(){\r\n  var kuid = Krux('get', 'user');\r\n  if (kuid && typeof kuid != 'undefined') {\r\n      var prefix = location.protocol == 'https:' ? \"https:\" :\"http:\";\r\n      var r_url = prefix + '//cm.g.doubleclick.net/pixel'\r\n      var kurl = prefix + '//apiservices.krxd.net/um?partner=google&r=' + r_url;\r\n      var i = new Image();\r\n      i.src = kurl;\r\n  }\r\n})();\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 5, "internal": 1, "content_type": "html", "freq_cap": 3, "timing": "onload", "method": "document", "type": "publisher", "id": 69335, "name": "The Trade Desk Test"}, {"content": "", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": null, "tier": 1, "internal": 1, "content_type": "html", "freq_cap": 6, "timing": "onready", "method": "document", "id": 47674, "name": "pageViews_counter"}, {"content": "<script>\r\n(function() {\r\n  var _ = Krux._;\r\n  var store = Krux('require:store');\r\n  var old_set = store.set;\r\n\r\n  store.set = function (key, value, ttl) {\r\n    old_set(key, value, ttl);\r\n    if (key === 'segs') {\r\n      store.cookie.set(\r\n          'krux_segs',\r\n          value.replace(/,/g, '|'),\r\n          48 * 60 * 60,\r\n          {domain: 'nytimes.com'}\r\n      );\r\n    }\r\n  };\r\n})();\r\n</script>\r\n<script type=\"text/javascript\">\r\n(function(require) {\r\n    var config = require('config')();\r\n    var store = require('store');\r\n    var _ = require('util');\r\n    var segments;\r\n\r\n    function handleUserDataResponse(r) {\r\n        // Handle the response as usual.\r\n        segments.handleUserDataResponse(r);\r\n\r\n    }\r\n\r\n    function useFirstPartyCookie() {\r\n        // Older versions of CT don't have feature.\r\n        try {\r\n            var feature = Krux('require:feature');\r\n            // If they don't have 3rd party cookies, then we rely on 1st party.\r\n            return !feature.hasThirdPartyCookies();\r\n        } catch (e){\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Our own fetch uses our own handleResponse\r\n    function fetch() {\r\n        var data = {pub: _.get('pubid')};\r\n\r\n        // Skip \r\n        if (useFirstPartyCookie() && Krux('get', 'user')) {\r\n            data._kuid = Krux('get', 'user');\r\n        }\r\n        var options = {\r\n            url: _.get('url_userdata'),\r\n            data: data,\r\n            callback: 'kxjsonp_userdata',\r\n            done: handleUserDataResponse\r\n        };\r\n\r\n        // SEE: SCRUM-1129\r\n        var orgUserId = _.get('org_user_id');\r\n        if(orgUserId) {\r\n            options.data._kuid = orgUserId;\r\n        }\r\n\r\n        var fpId, fp;\r\n        var useFingerprint = config.get('params.fingerprint', false);\r\n        if (useFingerprint) {\r\n            fpId = _.get('fp_id');\r\n            options.data.kxfp = fp = _.get('fp');\r\n            // Ensure we don't send the fingerprint as the id (it mascarades in fallback mode)\r\n            if (fpId && fpId.length !== fp.length) {\r\n                options.data.kfuid = fpId;\r\n            }\r\n        }\r\n\r\n        if(!segments.readTechFromStore()) {\r\n            options.data.technographics = 1;\r\n        }\r\n        require('http').jsonp(options);\r\n    }\r\n\r\n    if (!useFirstPartyCookie()) {\r\n        Krux('set', 'user', Krux('require:store').get('kuid'));\r\n    }\r\n\r\n    if(!store.get('segWait')) {\r\n        // disable segments.fetch and use our own\r\n        _.set('segWait', 1, store.MINUTES*5);\r\n        _.onOnce('dom:load', fetch);\r\n        _.fire('user_data_fetch_scheduled');\r\n    }\r\n\r\n    // Finally, require segments as usual.\r\n    segments = require('segments');\r\n}(Krux.require));\r\n</script>", "target": "", "target_action": null, "require": "", "docwrite": null, "template_replacement": 1, "execution_results": {"onloadSafe": true, "docwrite": false, "listeners": []}, "tier": 1, "internal": 1, "content_type": "html", "timing": "onready", "method": "document", "type": "publisher", "id": 50544, "name": "Load Segments NYT specific"}], "buckets": [], "publisher": {"uuid": "79816aa8-435a-471a-be83-4b3e0946daf2", "id": 43, "name": "New York Times"}, "controltag_options": {"async": "true", "render": true}, "site": {"id": 935, "name": "nytimes"}, "realtime_segments": [{"test": ["and", ["or", ["and", ["or", ["intersects", "$page_attr_keywords2:,", "[\"dating and courtship\", \"marriages\", \"love\", \"love (emotion)\", \"dating and relationships\", \"dating (social)\"]"]]]]], "id": "pc9fhzd0e"}, {"test": ["and", ["or", ["and", ["or", ["intersects", "$user_segments", "[null]"]]]]], "id": "pdv53oz83"}, {"test": ["and", ["or", ["and", ["or", ["intersects", "$user_segments", "[null]"]]]]], "id": "pdv6brf77"}, {"test": ["and", ["or", ["and", ["or", ["intersects", "$user_segments", "[null]"]]]]], "id": "pdv6g7xrg"}, {"test": ["and", ["or", ["and", ["or", ["intersects", "$user_attr_cookie_isEDU", "[\"true\"]"]]]]], "id": "pox3vefah"}, {"test": ["and", ["or", ["and", ["or", ["intersects", "$page_attr_propensityEDU", "[\"dowling\"]"]]]]], "id": "po1oe07a8"}, {"test": ["and"], "id": "pugnzh4xk"}, {"test": ["and", ["or", ["and", ["or", ["intersects", "$user_attr_nyt_insiderAB", "[\"true\"]"]]]]], "id": "p116o8pls"}, {"test": ["and", ["or", ["and", ["or", ["intersects", "$user_attr_nyt_insiderAB", "[\"true\"]"]]]]], "id": "p2toyic3f"}], "dnt": null, "params": {"connector_host": "connector.krxd.net", "first_party_uid": false, "control_tag_load_sync": "false", "userData_host": "cdn.krxd.net", "disable_http_compression": false, "remove_kxhead": true, "supertag_requires_approval": false, "control_tag_namespace": null, "control_tag_stats_prefix": "nyt", "optimize_realtime_segments": false, "beacon_host": "beacon.krxd.net", "control_tag_pixel_throttle": null, "store_realtime_segments": false, "user_id_cookie": null, "max_segments": null, "no_pii": 0, "recommend": false, "revenue_optimization": false, "context_terms": "true", "jslog_host": "jslog.krxd.net", "buckets": "", "site_level_supertag_config": "site", "max_slot_time": 1000, "services_host": "apiservices.krxd.net", "capture_leakage": true, "client_side_storage": "localStorage,cookie", "fingerprint": false, "config_source": 1, "control_tag_version": "locked", "capture_js_errors": true, "datatag_version": "3", "dfp_premium": false, "userdata_host": "cdn.krxd.net", "target_fingerprint": false}, "services": {"event": "//beacon.krxd.net/event.gif", "impression": "//beacon.krxd.net/ad_impression.gif", "stats": "//apiservices.krxd.net/stats", "log": "//jslog.krxd.net/jslog.gif", "optout": "//beacon.krxd.net/optout_check", "um": "//apiservices.krxd.net/um", "pixel": "//beacon.krxd.net/pixel.gif", "contentConnector": "//connector.krxd.net/content_connector/", "is_optout": "//beacon.krxd.net/optout_check", "set_optin": "//apiservices.krxd.net/consumer/optin", "social": "//beacon.krxd.net/social.gif", "set_optout": "//apiservices.krxd.net/consumer/optout", "userData": "//cdn.krxd.net/userdata/get", "data": "//beacon.krxd.net/data.gif", "userdata": "//cdn.krxd.net/userdata/get", "addSegment": "//cdn.krxd.net/userdata/add"}, "geo": {}, "segments": [], "confid": "HrUwtkcl"};

  // Wrap in a function and comment, then toString the func and replace
  // everything that's not the beginning or end of a JSON object, so we get a
  // string that's either empty or JSON.
  var esiGeo = String(function(){/*
    <esi:include src="/geoip_esi"/>
  */}).replace(/^.*\/\*[^{]+|[^}]+\*\/.*$/g, '');

  if (esiGeo) {
    log('Got a request for:', esiGeo, 'adding geo to config.');
    try {
      config.geo = window.JSON.parse(esiGeo);
    } catch (__) {
      // Couldn't parse, so setting to {}
      log('Unable to parse geo from:', config.geo);
      config.geo = {};
    }
  }

  
  
  

  load('//cdn.krxd.net/ctjs/controltag.js.875fd5b280a77e06def8c74a5a268e2c', function() {
    
    
    log('Loading krux configuration.');

    Krux('config', config);

    
  });
})();
