/*! LaziestLoader - v0.3.0 - 2014-03-28
 * A responsive-aware jQuery plugin to smartly lazy load images and other elements.
 * https://github.com/sjwilliams/laziestloader
 * Thanks to Lu√≠s Almeida for 'unveil,' on which this project is based.
 * Copyright (c) 2014 Josh Williams; Licensed MIT
 */

define("node_modules/nytg-resizer/script",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/views/page-manager"],function(e,t,n,r){var i=n.extend({sizes:{180:".g-show-xsmall",300:".g-show-small",460:".g-show-smallplus",600:".g-show-submedium",720:".g-show-medium",945:".g-show-large",1050:".g-show-xlarge"},initialize:function(n){if(e("html").hasClass("g-resizer-init"))return!1;this.selector=t.values(this.sizes).join(", "),this.widths=t.map(t.keys(this.sizes),Number),t.bindAll(this,"render","selectElements"),this.selectElements(),this.pageManager.on("nyt:page-resize",this.render),this.render(),e("html").addClass("g-resizer-init"),e(document).ready(this.selectElements)},render:function(){var n=this;n.elements.each(function(){var r=e(this),i=r.parent().width(),s=t.max(t.filter(n.widths,function(e){return e<=i})),o=n.sizes[s]||"",u=r.hasClass(o.replace(".",""));r.toggle(u)})},selectElements:function(){this.elements=e(this.selector),this.elements.hide(),this.render()}});return new i}),define("jquery",["jquery/nyt"],function(e){return e}),function(e){typeof define=="function"&&define.amd?define("node_modules/laziestloader/jquery.laziestloader",["jquery"],e):e(jQuery)}(function(e){var t=function(n,r){function f(t){var r,i,s=t.data();return s.pattern&&s.widths&&e.isArray(s.widths)?(r=u?s.patternRetina:s.pattern,r=r||s.pattern,typeof s.widths[0]=="object"?(i=function(){var n=e.map(s.widths,function(e,t){return e.size}),r=h(t.width(),n);for(var i=s.widths.length-1;i>=0;i--)if(s.widths[i].size===r)return s.widths[i].slug}(),r=r.replace(n.sizePattern,i)):r=r.replace(n.sizePattern,h(t.width(),s.widths))):(r=u?s.srcRetina:s.src,r=r||s.src),r}function l(){s.one("laziestloader",function(){var t;e(this).data().ratio&&d.call(this),n.setSourceMode?(t=n.getSource(e(this)),t&&this.getAttribute("src")!==t&&(this.setAttribute("src",t),typeof r=="function"&&r.call(this))):typeof r=="function"&&r.call(this)})}function c(){s.off("laziestloader")}function p(){var t=s.not(o).filter(function(){var t=e(this),r=n.threshold;if(t.is(":hidden"))return;var s=i.scrollTop(),o=s+i.height(),u=t.offset().top,a=u+t.height();return a>=s-r&&u<=o+r});t.trigger("laziestloader"),o.add(t)}function d(){var t=e(this),n=t.data();n.ratio=n.ratio||n.heightMultiplier,n.ratio&&t.css({height:Math.round(t.width()*n.ratio)})}var i=e(window),s=this,o=e(),u=window.devicePixelRatio>1,a=!1;n=e.extend(!0,{threshold:0,sizePattern:/{{SIZE}}/ig,getSource:f,scrollThrottle:250,sizeOffsetPercent:0,setSourceMode:!0},n);var h=t.bestFit=function(e,t){var r=t[t.length-1],i=t.length,s=e*(n.sizeOffsetPercent/100);t.sort(function(e,t){return e-t});while(i--)e-s<=t[i]&&(r=t[i]);return r};return s.each(d),l(),i.scroll(function(){a=!0}),setInterval(function(){a&&(a=!1,p())},n.scrollThrottle),i.resize(function(){o=e(),c(),l(),p()}),p(),this};e.fn.laziestloader=t}),require(["foundation/main"],function(){require(["jquery/nyt","node_modules/nytg-resizer/script","node_modules/laziestloader/jquery.laziestloader"],function(e){e(".g-aiImg").laziestloader({threshold:1e3});var t=e("html").hasClass("page-interactive-embedded");if(t){var n=e(window).width();require(["shared/interactive/instances/app-communicator","foundation/views/page-manager"],function(t,r){t.triggerResize(),r.on("nyt:page-resize",function(){var r=e(window).width();n!=r&&(n=r,setTimeout(function(){t.triggerResize()},500))})})}})}),define("script",function(){});