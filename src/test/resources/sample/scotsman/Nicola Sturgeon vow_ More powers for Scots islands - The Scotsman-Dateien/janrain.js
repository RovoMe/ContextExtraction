if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){"use strict";var b=a.fn.jquery.split(" ")[0].split(".");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.5",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in"),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+e).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),function(a,b){"use strict";b.Janrain=b.Janrain||{};var c=(b.Janrain,b.janrain||{});b.PluckService=c.PluckService={createPluckCookie:function(b){var d=(LoginRegister.getAccessToken(),c.capture.ui.getReturnExperienceData("displayName")),e=c.capture.ui.getReturnExperienceData("email"),f=c.capture.ui.getReturnExperienceData("pluckUserID");(null==f||"null"==f)&&(f=""),a.ajax({type:"GET",url:"/ajax",data:{action:"getPluckCookieValue",userId:f,displayName:d,email:e,noEOL:"true"},dataType:"text"}).done(function(a){CookieService.setCookie("at",a,0),PluckService.savePluckUserId()}).always(function(){b()})},expirePluckCookie:function(){CookieService.removeCookie("at")},savePluckUserId:function(){var a=c.capture.ui.getReturnExperienceData("email"),b=LoginRegister.getAccessToken(),d=c.capture.ui.getReturnExperienceData("pluckUserID");if(!d&&(d=PluckService.extractPluckIDFromCookie())){var e=function(){var a=localStorage.getItem("janrainCaptureReturnExperienceData");a&&(a=JSON.parse(a),a.pluckUserID=d,localStorage.setItem("janrainCaptureReturnExperienceData",JSON.stringify(a)))};JanrainUtil.savePluckUserId(a,b,d,e)}},extractPluckIDFromCookie:function(){for(var a=CookieService.getCookie("at"),b=a.split("&"),c=0;c<b.length;c++)if("u="==b[c].substring(0,2))return b[c].substring(2)}}}(jQuery,window),function(a,b){"use strict";function c(){var a,c=b.getElementsByTagName("script")[0],d="https:"===b.location.protocol;a=b.createElement("script"),a.type="text/javascript",a.id="janrainAuthWidget",a.src=d?janrain.cms.httpsLoadUrl:janrain.cms.httpLoadUrl,c.parentNode.insertBefore(a,c),"object"==typeof janrain.settings.share&&(a=b.createElement("script"),a.type="text/javascript",a.id="janrainWidgets",a.src=d?janrain.cms.httpsShareLoadUrl:janrain.cms.httpShareLoadUrl,c.parentNode.insertBefore(a,c))}function d(){i.on("click",".newsletter-trigger, .newsletter-trigger + button",function(){JanrainUtil.isSignedIn()?window.location.href="/profile":JanrainCaptureHelper.start()})}function e(b){b.css({"padding-top":function(){var b=(a(window).height()-a(this).find(".modal-content").height())/2;return b>=0?b:0}})}function f(){a(b).on("click","#capture_editProfile_upload_photo_link, #capture_editProfile_photoManager_profile_pic",function(){var b=a("#profilePhotoManager"),c=a("#capture_editProfile_photo_chooser"),d="No file chosen";a("#capture_editProfile_photo_chooser_errors, #capture_editProfile_photoManager_profile_pic_upload, #capture_editProfile_photoManager_profile_pic_uploadform_container").detach().appendTo("#profilePicture"),a("#capture_editProfile_photo_chooser_label").length||c.after('<label for="capture_editProfile_photo_chooser" id="capture_editProfile_photo_chooser_label" class="capture_photo_chooser_label"><b>Choose photo</b><span>'+d+"</span></label>"),c.change(function(){a(this).val().length>0?(d=a(this).val(),d=d.match(/[^\\]+(\.+)?$/gim)):d="No file chosen",a("#capture_editProfile_photo_chooser_label span").html(d)}),b.modal("show"),"false"==Coremetrics.isCoremetricsDisabled&&LoginRegister.getViewRef().applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Profile Photo"),e(b),JanrainUtil.hideScreen("capture_editProfile_photoManager_uploadphotoscreen",!0)})}function g(){(Modernizr.android||Modernizr.ios)&&Modernizr.tablet&&a(window).scroll(function(){window.stopMobileScroll&&(a(window).scrollTop(window.stopMobileScrollPosition),window.stopMobileScroll=!1)})}function h(){var b=this;b.applyCoremetricsPageViewTag=function(a){"false"==Coremetrics.isCoremetricsDisabled&&("Mobile"===window.jpdna.wurfl.getPlatform()?cmCreatePageviewTag(a,"MOB"):cmCreatePageviewTag(a,"DESK"))},b.setLoggedInStateOn=function(){a("#user-account").parents(".slab__inner").first().addClass("is-signed-in")},b.setLoggedInStateOff=function(){a("#user-account").parents(".slab__inner").first().removeClass("is-signed-in")};var c=function(){var b=a("#traditionalWelcomeName"),c=JanrainCaptureHelper.getData("displayName");b&&c&&b.html("Welcome back, "+c+"!")};b.onReturnTraditional=function(){c(),a("#capture_returnTraditional_traditionalSignIn_createButton").text("Not a member? Register now")},b.onTraditionalRegistration=function(){a("#capture_traditionalRegistration_createAccountButton").attr("value","CREATE MY ACCOUNT")},b.onSocialRegistration=function(){a("#capture_socialRegistration_createAccountButton").attr("value","CREATE MY ACCOUNT")},b.onForgotPassword=function(){},b.onSignIn=function(){a("#capture_traditionalSignIn_createButton").html("Not a member? Register now"),a("#capture_signIn_traditionalSignIn_signInButton").html("Sign IN");a(this).attr("rel")},b.onReturnSocial=function(){a("#capture_returnSocial_traditionalSignIn_createButton").html("Not a member? Register now")},b.onEditProfile=function(){g(),a("#capture_editProfile_email").attr("readonly",!0),b.displayProvidersHeading(),a("#editProfile:visible").length&&a("#janrainCaptureWidget").hide()},b.showLoginControls=function(){a("#loginRegisterPanel").removeClass("hidden"),a(".register").removeClass("hidden"),a("#profileLogoutPanel").addClass("hidden"),b.setLoggedInStateOff(),a("#subscribeNLWidgetLoggedIn").addClass("hidden"),a("#subscribeNLWidgetLoggedOut").removeClass("hidden")},b.hideLogoutControls=function(){a("#profileLogoutPanel").addClass("hidden"),a("#loginRegisterPanel").removeClass("hidden"),a(".register").removeClass("hidden"),b.setLoggedInStateOff(),a("#subscribeNLWidgetLoggedOut").removeClass("hidden"),a("#subscribeNLWidgetLoggedIn").addClass("hidden")},b.showLogoutControls=function(){a("#profileLogoutPanel").removeClass("hidden").show(),a("#loginRegisterPanel").addClass("hidden"),a(".register").addClass("hidden"),b.setLoggedInStateOn(),b.setLoginName(JanrainCaptureHelper.getData("displayName")),a("#subscribeNLWidgetLoggedOut").addClass("hidden"),a("#subscribeNLWidgetLoggedIn").removeClass("hidden")},b.setLoginName=function(b){a("#username").text(b)},b.displayProvidersHeading=function(){var b=a("#linkedAccountsHeading");0!==a(".capture_provider_linked","#capture_editProfile_linkedAccounts_linkedproviderlist").length?b.show():b.hide()},b.notifyAboutLoginStatus=function(){i.trigger("loginEvent")},b.populateRegisterPreferencesScreen=function(b){var c=b.newsletters.dailyNewsletters,d=c.newsletterOptions,e=d.length;if(0!=e){var f=c.description;a("#preferencesScreen #dailyDescription").text(f);for(var g="",h=0;h<d.length;h++){var i=d[h],j=i.encodingName;g+='<li class="capture_checkbox--janrain-newsletter janrain-newsletter__list-item"><label><input class="capture_input_checkbox newsletter_checkbox" type="checkbox" name="'+j+'" value="'+j+'"',i.selectedByDefault===!0&&(g+=" checked "),g+='><span class="custom-checkbox"></span>'+i.name+"</label></li>"}a("#dailyNewslettersContainer").attr("style",""),a("#register_dailyNewsletters").append(g)}var k=b.newsletters.additionalNewsletters,l=k.newsletterOptions,m=l.length;if(0!=m){var n=k.description;a("#preferencesScreen #additionalDescription").text(n);for(var o="",h=0;m>h;h++){var p=l[h],j=p.encodingName;o+='<li class="capture_checkbox--janrain-newsletter janrain-newsletter__list-item"><label><input class="capture_input_checkbox newsletter_checkbox" type="checkbox" name="'+j+'" value="'+j+'"',p.selectedByDefault===!0&&(o+=" checked "),o+='><span class="custom-checkbox"></span>'+p.name+"</label></li>"}a("#additionalNewslettersContainer").attr("style",""),a("#register_additionalOptions").append(o)}},b.populatePreferencesScreen=function(b){var c,d=0,e=a("#profileNewsletterPreferences"),f=function(b,c){var d=b+"-"+c.code,e=a("<label></label>").attr("for",d).text(c.name),f=a('<input type="checkbox" />').addClass("capture_input_checkbox newsletter_checkbox").attr({id:d,name:"sites",value:c.code}),g=a('<span class="custom-checkbox"></span>');return e.prepend(g).prepend(f),a("<li></li>").addClass("capture_checkbox capture_checkbox--janrain-newsletter janrain-newsletter__list-item").append(e)},g=b.length;if(g>0)for(d=0;g>d;d++)c=f("newsletter",b[d]),e.append(c)},b.getCheckedPreferences=function(b){var c=[],d=0;a("#"+b+"_dailyNewsletters input[type=checkbox]").each(function(){a(this).is(":checked")&&(c[d]={code:a(this).attr("name")},d++)});var e=[],d=0;a("#"+b+"_additionalOptions input[type=checkbox]").each(function(){if(a(this).is(":checked")){var b=a(this).attr("name");e[d]={name:b,preferences:[{code:b}]},d++}});var f;return f=0===c.length?e:e.concat({name:"daily",preferences:c}),[{code:siteKey,newsletters:f}]},b.onRegistrationNewVerification=function(b,c,d,e){var f=a("#confirmation");a("#registeredUsername").text(b),d||MultiSiteService.isThisYou?f.show():"ok"===e?(a("#emailSentSuccess").show(),a("#registeredEmail").text(c)):"ok"!==e&&a("#emailSentFailed").show()},b.displayAlreadyRegisteredScreen=function(a,c){JanrainCaptureHelper.openModal("traditionalAuthenticateMerge"),b.updateWithAlreadyRegisteredMessage(a,c)},b.updateWithAlreadyRegisteredMessage=function(c,d){a(".janrain-header__text","#traditionalAuthenticateMerge").text("Is this you?"),a("#usedEmail").text(c),a("#capture_traditionalAuthenticateMerge_traditionalSignIn_emailAddress").val(c),a("#alreadyRegisteredSite").text(d),a(".janrain-content","#capture_traditionalAuthenticateMerge_tradAuthenticateMergeForm").addClass("janrain-content--bottom"),a("#traditionalMergeContent").show(),b.updateWithCurrentSiteName(MultiSiteService.attachedSiteName),MultiSiteService.isThisYou=!0},b.updateWithCurrentSiteName=function(b){b&&a("#currentSite").text(b)},b.onResetPassword=function(){a("label","#capture_resetPassword_form_item_newpassword").text("").hide(),a(".capture_tip","#capture_resetPassword_form_item_newpassword").text("").hide(),a("label","#capture_resetPassword_form_item_newpasswordConfirm").text("").hide(),a(".capture_tip","#capture_resetPassword_form_item_newpasswordConfirm ").text("").hide(),a("#capture_resetPassword_newpassword").attr("placeholder","Password (6 characters min)"),a("#capture_resetPassword_newpasswordConfirm").attr("placeholder","Confirm Password"),a("#capture_resetPassword_capture_submit").click(function(b){a("#capture_resetPassword_newpasswordConfirm").val()!==a("#capture_resetPassword_newpassword").val()&&(b.preventDefault(),a("#capture_resetPassword_form_item_newpasswordConfirm").addClass("capture_error"),a(".capture_tip_error","#capture_resetPassword_form_item_newpasswordConfirm ").text("Oops, looks like you entered something incorrectly. Please try again."))})},b.logoutUser=function(){JanrainCaptureHelper.endSession()}}var i=a(b);i.ready(function(){c(),janrain.ready=!0,d(),f()}),window.LoginRegisterView=h}(jQuery,document),function(a,b,c){"use strict";var d=a(b);c.janrainWidgetLoaded=!1,c.janrainCaptureWidgetLoaded=!1,c.janrainWidgetOnload=function(){c.janrainWidgetLoaded=!0,a.event.trigger({type:"janrainWidgetOnload",message:"janrainWidgetOnload",time:new Date})},c.janrainCaptureWidgetOnLoad=function(){c.janrainCaptureWidgetLoaded=!0,a.event.trigger({type:"janrainCaptureWidgetOnLoad",message:"janrainCaptureWidgetOnLoad",time:new Date})},d.ready(function(){a(".capture_remove").on("click",function(){setTimeout(function(){var b=a("#captureDialogBuiltIn");b.length>=0&&b.next(".janrain_modal_closebutton").css("margin-top","-8px")},100),a(".janrain_modal_closebutton").on("click",function(){var b=a(this);setTimeout(function(){b.css("margin-top","0")},100)})})})}(jQuery,document,window),function(a,b,c){"use strict";function d(b){b.css({"padding-top":function(){var b=(a(c).height()-a(this).find(".modal-content").height())/2;return b>=0?b:0}})}function e(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}var f=a(c),g=a(b),h=c.innerWidth-a(c).width();h=0,c.LoginRegister=function(){function i(a){z!=a&&(z=a,"returnTraditional"==z?"undefined"==typeof MultiSiteService.isThisYou&&r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Sign In"):"traditionalRegistration"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Registration"):"socialRegistration"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Almost Done!"):"forgotPassword"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Forgotten Your Password?"):"signIn"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Sign In"):"returnSocial"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Sign In"):"preferencesScreen"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Newsletter Preferences"):"newsletterPreferencesScreen"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Newsletter Preferences"):"registrationNewVerification"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Thank You For Registering"):"forgotPasswordSuccess"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Create A New Password"):"changePassword"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Change Password"):"publicProfileModal"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | My Profile"):"mergeAccounts"==z?r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Is This You?"):"traditionalAuthenticateMerge"==z&&r.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Is This You?"))}function j(a,b,c){var d={alpha:/^[a-z]+$/i,numeric:/^(\d+)$/,numericReal:/^(\d+\.?\d*|\.\d+|\-\d+\.?\d*|\-\.\d+)$/,alphaExtended:/^[a-zA-Z\-']+$/,alphaExtendedSpaces:/^[a-zA-Z\-'\s]+$/,alphaNumeric:/^[a-z0-9]+$/i,alphaNumericExtended:/^[a-z][-a-z0-9\s_.]*[a-z0-9]$/i,email:/^([a-zA-Z0-9_.-])+@(([a-zA-Z])|([a-zA-Z][a-zA-Z])|([a-zA-Z][0-9])|([0-9][a-zA-Z])|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3})$/,noWhitespace:/^\S*$/,zipCode:/^\d{5}$/,"zipCode+4":/^\d{5}(\-\d{4})?$/,phone:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,phoneInternational:/^(\d{1,4}[-. ]?)?\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,i18nAlphaNumeric:/^[^-\s^`~!@#$%&*()_=+\[{\]}\|;:\u2018\u201c,<.>\/?]+$/};return b&&c.format?(b=c.format,"string"==typeof b&&d[b]?(b=d[b],(a=b.test(a.value))||c.actions&&c.actions.format&&d.push(c.actions.format),a):!1):!0}function k(){v=""}function l(){0!==s.indexOf("/profile")&&(c.location.href="/profile")}function m(){s.indexOf("/profile")>-1&&c.location.reload()}function n(){s.indexOf("/profile")>-1&&c.location.replace("/")}function o(){r.logoutUser()}function p(){""!==u&&"resetPasswordRequestCode"!==u&&("verifyEmailError"===u&&(u="verifyEmailSuccess"),setTimeout(function(){JanrainCaptureHelper.openModal(u)},1e3))}function q(){N(),JanrainCaptureHelper.openModal("preferencesScreen"),MultiSiteService.attachCurrentSiteToUser(),MultiSiteService.clearInformation("currentFlow"),MultiSiteService.clearInformation("alreadyRegisteredSiteName"),MultiSiteService.clearInformation("loginFailedMessage"),MultiSiteService.wasUserPartiallyLoggedIn()&&CookieService.removeCookie("partiallyLoggedIn")}var r=null,s="",t="",u="",v="",w="",x="",y=1,z="",A="",B=!1,C="pending",D=!1,E=!1,F=!1,G="";c.stopMobileScroll=!1,c.stopMobileScrollPosition=0;var H={},I={};H.onCaptureScreenShow=function(b){"traditionalRegistration"===b.screen?(MultiSiteService.wasUserPartiallyLoggedIn()&&(CookieService.removeCookie("partiallyLoggedIn"),r.logoutUser()),MultiSiteService.clearInformation("currentFlow"),MultiSiteService.clearUnnecessaryInformation()):"returnTraditional"===b.screen&&MultiSiteService.hasErrorMessages()&&(a("#capture_returnTraditional_userInformationForm_errorMessages").hide(),MultiSiteService.clearInformation("loginFailedMessage")),"false"==Coremetrics.isCoremetricsDisabled&&i(b.screen),a(".capture_input_checkbox").each(function(){var b=a(this),c=a('<span class="custom-checkbox"></span>');0===b.siblings(".custom-checkbox").length&&b.after(c)}),a("#janrainModal").css({left:15,right:15,width:"auto"}),a("#janrainModalOverlay").css({bottom:0,right:0,height:"auto"})},H.onCaptureProfileLink=function(){JanrainUtil.forceUpdate(v)},H.onCaptureProfileUnlink=function(){JanrainUtil.forceUpdate(v),r.displayProvidersHeading(),a("#capture_editProfile_confirm_remove_photo_link").trigger("click")},H.onCaptureLoginSuccess=function(c){if(JanrainUtil.debug("onCaptureLoginSuccess","info"),v=c.accessToken,w=c.userData.uuid,x=c.userData.email,a(b).trigger("jr:registration-tag",[w,x]),U(function(b){var c=!1;if(a.each(b,function(a,b){return"original"==b.type?(c=b.value,!1):void 0}),c){var d=a('<img alt="User profile photo" id="user-bar__photo" />').attr("src",c),e=a('<img alt="User profile photo" id="mobile-user_bar__photo" />').attr("src",c);a(".header__menu .header__info--user-image").append(d),a(".mobile__userbar .header__info--user-image").append(e)}}),"false"!=Coremetrics.isCoremetricsDisabled||MultiSiteService.wasUserPartiallyLoggedIn()||cmCreateRegistrationTag("JP"+w,x),"accountsMerged"===c.statusMessage&&JanrainUtil.forceUpdate(v),"traditionalSignin"===c.action)if(MultiSiteService.isAfterFirstLogin())if("register"===MultiSiteService.currentFlow)q();else{MultiSiteService.currentFlow="login";var d=JanrainCaptureHelper.getData("email"),e=JanrainCaptureHelper.getData("sites");MultiSiteService.doAlreadyRegisteredLogicForSites(d,e)}else q();else"socialSignin"===c.action&&(JanrainCaptureHelper.closeModal(),N())},H.onCaptureSessionFound=function(a){JanrainUtil.debug(["Session found",a],"info"),v=a.accessToken,JanrainCaptureHelper.closeModal(),r.showLogoutControls(),PluckService.createPluckCookie(r.notifyAboutLoginStatus),r.notifyAboutLoginStatus(),p()},H.onCaptureSessionNotFound=function(){JanrainUtil.debug("Session not found","warn"),r.showLoginControls(),k(),PluckService.expirePluckCookie(),r.notifyAboutLoginStatus(),p()},H.onCaptureRegistrationSuccess=function(c){if(JanrainUtil.debug("Registration succeeded","info"),w=c.userData.uuid,x=c.userData.email,v=c.accessToken,"false"==Coremetrics.isCoremetricsDisabled&&cmCreateRegistrationTag("JP"+w,x),a(b).trigger("jr:registration-tag",[w,x]),MultiSiteService.attachCurrentSiteToUser(),PluckService.createPluckCookie(r.notifyAboutLoginStatus),JanrainCaptureHelper.closeModal(),r.showLogoutControls(),"traditionalRegister"===c.action){B=!1;var d=JanrainCaptureHelper.getData("email");O(A,d,w)}else"socialRegister"===c.action&&(B=!0,U(function(b){var c=!1;a.each(b,function(a,b){return"original"==b.type?(c=b.value,!1):void 0}),c&&a("#regVerificationPhoto").attr("src",c)}))},H.onCaptureSessionEnded=function(){r.showLoginControls(),PluckService.expirePluckCookie(),k(),n(),r.notifyAboutLoginStatus(),a(".header__info--user-image").html("")},H.onCaptureRenderStart=function(a){if(E!==!0&&"undefined"!=typeof a&&"undefined"!=typeof a.fields){var b=a.fields;"undefined"!=typeof b.traditionalSignIn&&"undefined"!=typeof b.traditionalSignIn_emailAddress.value&&(b.traditionalSignIn_emailAddress.value=""),"undefined"==typeof b.traditionalRegistration_jpCommsOptIn||b.traditionalRegistration_jpCommsOptIn.checked||(b.traditionalRegistration_jpCommsOptIn.checked=!0),"undefined"!=typeof b.traditionalRegistration_firstName&&b.traditionalRegistration_firstName.value.length>0&&(b.traditionalRegistration_firstName.value=""),"undefined"!=typeof b.traditionalRegistration_lastName&&b.traditionalRegistration_lastName.value.length>0&&(b.traditionalRegistration_lastName.value=""),"undefined"!=typeof b.traditionalRegistration_emailAddress&&b.traditionalRegistration_emailAddress.value&&b.traditionalRegistration_emailAddress.value.length>0&&(b.traditionalRegistration_emailAddress.value=""),"undefined"!=typeof b.traditionalRegistration_displayName&&b.traditionalRegistration_displayName.value&&b.traditionalRegistration_displayName.value.length>0&&(b.traditionalRegistration_displayName.value="")}},H.onCaptureRenderComplete=function(b){var c=b.screen||"signIn",d="janrain:onShow_"+c,e=a("#janrainModal");E=!1,G=b.screen,e.closest(".janrain-modal__wrapper").length||(e.wrap('<div class="janrain-modal__wrapper"></div>'),a(".janrain-modal__wrapper").on("click",function(a){a.target==this&&(a.stopPropagation(),JanrainCaptureHelper.closeModal())})),g.trigger(d,b),R()},H.onCaptureSaveFailed=function(a){"error"===a.status&&("invalidCredentials"===a.statusMessage?D=!0:"invalidAccessToken"===a.statusMessage?JanrainCaptureHelper.endSession():"traditionalRegistration"===a.screen&&"validationErrors"===a.statusMessage?E=!0:("invalidIdentifier"===a.statusMessage||"invalidInput"===a.statusMessage||"invalidAccountIdentifier"===a.statusMessage)&&(E=!0))},H.onCaptureError=function(b){if("error"===b.stat){var c=b.result;return"invalidAccessToken"===c.error?void JanrainCaptureHelper.endSession():void("linkError"===c.error&&(JanrainCaptureHelper.closeModal(),a("#janrainErrorDescription").html(c.errorDescription),a("#janrainError").modal("show"),d(a("#janrainError")),a(".capture_errortype_linkerror").remove()))}},H.onCaptureFormError=function(a){D===!1&&(a.invalidCredentials=""),E!==!0&&(a.invalidIdentifier="")},H.onModalOpen=function(){var b=a("#janrainModal");if((Modernizr.android||Modernizr.ios)&&(c.stopMobileScroll=!0,c.stopMobileScrollPosition=a(c).scrollTop(),a("body").attr("style",""),a(c).scrollTop(c.stopMobileScrollPosition)),a.browser.mobile?a(".capture_col_4 a, #subscribeSubmitButton").click(function(){b.hide(),a("html, body").animate({scrollTop:0},"slow"),setTimeout(function(){a("#janrainModal").lightbox_me({centered:!1,modalCSS:{top:"100px",display:"inline-block"}})},500)}):f.width()<=1024&&setTimeout(function(){var a=b.offset().left-100,d=b.offset().top-100;c.scrollTo(a,d)},300),Modernizr.android){var d=function(b){var d=a(b.target).position().top;a("#janrainModal").scrollTop(d),c.stopMobileScroll=!0,c.stopMobileScrollPosition=a(c).scrollTop(),a(c).scrollTop(c.stopMobileScrollPosition)};a("input").on("click",d)}P(),R()},H.onModalClose=function(){(Modernizr.android||Modernizr.ios)&&(c.stopMobileScroll=!1),"preferencesScreen"===G?MultiSiteService.clearInformation("attachedSiteName"):MultiSiteService.flowIsActive()&&(MultiSiteService.wasUserPartiallyLoggedIn()&&(CookieService.removeCookie("partiallyLoggedIn"),o()),MultiSiteService.clearInformation("currentFlow"),MultiSiteService.clearUnnecessaryInformation()),MultiSiteService.clearInformation("loginFailNotification"),MultiSiteService.clearInformation("loginFailedMessage"),G="",z="",D=!1,Q()},H.onCaptureControlSuccess=function(a){"undefined"!=typeof a&&"undefined"!=typeof a.controlName&&"resendVerificationEmail"===a.controlName&&(F=!0)},H.onCaptureContentChange=function(){var b=0===a("#janrainEngageEmbed").has("#janrainAuthReturnExperience").length;b||""===G||(a(".switchLink","#"+G).show(),"signIn"===G&&a(".janrainSwitchAccountLink").trigger("click"))},H.onCaptureProfileSaveSuccess=function(a){"undefined"!=typeof a&&"undefined"!=typeof a.userData&&"undefined"!=typeof a.userData.givenName&&(ProfileManagementLogic.firstName=a.userData.givenName,r.setLoginName(JanrainCaptureHelper.getData("displayName")),PluckService.createPluckCookie(r.notifyAboutLoginStatus))},H.onCaptureValidationFailed=function(b){if("returnTraditional"===G&&a(b.field).parent().find(".capture_tip_error").text(b.message).show(),"Email address is already being used."===b.message){MultiSiteService.currentFlow="register";var c=a("#capture_traditionalRegistration_traditionalRegistration_emailAddress").val();MultiSiteService.registrationEmail=c,MultiSiteService.getUserAssociatedSites(c,MultiSiteService.alreadyRegisteredLogic)}},H.onCaptureValidationSuccess=function(b){a(".janrain-capture-ui .capture_form_error").parent().empty(),"traditionalRegistration_firstName"===b.field.name&&(A=b.field.value)},H.onAuthWidgetContentPlaced=function(){a(".providers li").removeAttr("style")},H.onCaptureLoginFailed=function(){MultiSiteService.loginFailNotification=!0},H.onProviderLoginToken=function(){a(".janrainContent>div:not(#janrainView)","#capture_signIn_login_widget").css({width:"112px",padding:"40px 0px"})},H.onCaptureSaveSuccess=function(b){"traditionalAuthenticateMerge"===b.screen&&b.mergedInAuthProvider&&(B=!0),a("#changePassword").length&&Q(),a("#profilePhotoManager").length&&(a("#profilePhotoManager").modal("hide"),a("#profilePicture").html(""))},I.signIn=function(){r.onSignIn()},I.forgotPassword=function(){r.onForgotPassword(),a("#capture_forgotPassword_forgotPassword_sendButton").attr("value","Reset My Password")},I.socialRegistration=function(){r.onSocialRegistration(),a(".jrLeft label","#socialRegistration").hide()},I.returnSocial=function(){r.onReturnSocial()},I.editProfile=function(b){var c=JanrainCaptureHelper.getData("email");ProfileManagementLogic.displayEmailVerificationLink(c,v);var d=a("#capture_editProfile_name_firstname");0!==d.length&&(ProfileManagementLogic.firstName=d.val()),b.renderingBuiltInScreen===!1&&(setTimeout(function(){ProfileManagementLogic.init()},300),a("#profileContentWhenLoggedOut").hide()),r.onEditProfile()},I.returnTraditional=function(){if(a(".capture_right .capture_btn").on("click",function(){setTimeout(function(){a(".capture_form_item").each(function(){var b=a(this);"none"!==a(".capture_tip_error").css("display")&&b.addClass("capture_error")})},1500)}),!MultiSiteService.loginFailed())return void r.onReturnTraditional();var b=JanrainCaptureHelper.getData("email");MultiSiteService.loginFailedMessage=!0,MultiSiteService.clearInformation("loginFailNotification"),MultiSiteService.currentFlow&&"register"===MultiSiteService.currentFlow&&(b=MultiSiteService.registrationEmail),r.updateWithAlreadyRegisteredMessage(b,MultiSiteService.alreadyRegisteredSiteName)},I.traditionalRegistration=function(){r.onTraditionalRegistration(),JanrainCaptureHelper.setValidator("isValidFormat",j),a(".capture_tip").css("display","none"),a("#capture_traditionalRegistration_traditionalRegistration_emailAddress").attr("placeholder","Email address"),
a("#capture_traditionalRegistration_traditionalRegistration_passwordConfirm").attr("placeholder","Confirm password"),a("<p>A name to use on this site</p>").insertAfter("#capture_traditionalRegistration_traditionalRegistration_displayName")},I.newsletterPreferencesScreen=function(){ProfileManagementLogic.init(),UserPreferencesLogic.getNewsletterPreferences(v,r.populatePreferencesScreen),UserPreferencesLogic.getCheckedNewsletterPreferences(v).done(function(a){return"ok"===a.stat?void UserPreferencesLogic.populateProfilePreferencesScreen(a.result.sites):(JanrainUtil.debug("Failed to retrieve preferences from Janrain.","error"),void("unknown access token"===a.error_description&&JanrainCaptureHelper.endSession()))})},I.registrationNewVerification=function(b){var c=JanrainCaptureHelper.getData("email"),d=JanrainCaptureHelper.getData("displayName");r.onRegistrationNewVerification(d,c,B,C),setTimeout(function(){U(function(b){var c=!1;if(a.each(b,function(a,b){return"original"==b.type?(c=b.value,!1):void 0}),c){var d=a('<img alt="User profile photo" id="user-bar__photo" />').attr("src",c),e=a('<img alt="User profile photo" id="mobile-user_bar__photo" />').attr("src",c);a(".header__menu .header__info--user-image").append(d),a(".mobile__userbar .header__info--user-image").append(e)}})},300)},I.resetPassword=function(){LoginRegister.getViewRef().onResetPassword()},I.verifyEmailSuccess=function(){var b=a(".janrain-content--signed-out"),c=a(".janrain-content--signed-in");a(".janrain-content__verify-message").hide(),"verifyEmailError"===e("screenName")?(a(".janrain-header__text",".janrain-modal--verifi-email-success").text("Nearly there"),a(".janrain-content__verify-message--error").show()):(a(".janrain-header__text",".janrain-modal--verifi-email-success").text("Welcome to "+siteName),a(".janrain-content__verify-message--success").show()),b.hide(),c.hide(),JanrainCaptureHelper.hasActiveSession()?c.show():b.show(),a(".capture_closeButton").on("click",function(){return l(),!1}),a(".capture_signInButton").on("click",function(){return JanrainCaptureHelper.openModal("signIn"),!1})},I.publicProfileModal=function(){a("label[for=capture_publicProfileModal_memberSince]").text("Member since:"),a("#profile_pic:has(img)").removeClass("capture_default")},I.preferencesScreen=function(){var b=a("#pref_postcode"),c=a(".capture_tip_error","#preferencesScreen"),d=a("#subscribeSubmitButton"),e=LoginRegister.getAccessToken();UserPreferencesLogic.getNewsletterPreferences(e,r.populateRegisterPreferencesScreen),b.on("blur",function(){var a=b.val(),f=JanrainCaptureHelper.getData("email");if(b.parent().removeClass("capture_error"),c.hide(),d.removeAttr("disabled"),a){if(!JanrainUtil.regexPostcodeUK.test(a))return c.show(),b.parent().addClass("capture_error"),d.attr("disabled","disabled"),void JanrainUtil.debug("Failed to validate postcode.","error");JanrainUtil.savePrimaryAddress(f,e,a)}})},I.janrainDialog=function(){var b=a("#removeLinkedAccount");b.modal("show"),d(b),JanrainUtil.hideScreen("captureDialogBuiltIn",!0);var c=function(){a("#removeLinkedAccount").modal("hide"),a(".capture_btn--cancel","#removeLinkedAccount").off("click",e),a(".capture_btn--yes","#removeLinkedAccount").off("click",f)},e=function(){a(".capture_footer .capture_secondary","#captureDialogBuiltIn").click(),c()},f=function(){a(".capture_footer .capture_primary","#captureDialogBuiltIn").click(),c()};a(".capture_btn--cancel","#removeLinkedAccount").on("click",e),a(".capture_btn--yes","#removeLinkedAccount").on("click",f)},I.capture_editProfile_photoManager_uploadphotoscreen=function(){},I.mergeAccounts=function(){setTimeout(function(){var b=a('.capture_mergeProvider[class~="janrain-provider-icon-yahoo!"]');0!==b.length&&b.removeClass("janrain-provider-icon-yahoo!").addClass("janrain-provider-icon-yahoo"),0===a(".janrain-provider__photo .capture_icon_col").length?a("#mergeAccountsPhoto").show():a("#mergeAccountsPhoto").hide()},300)},I.traditionalAuthenticateMerge=function(){var a=MultiSiteService.isThisYou,b=JanrainCaptureHelper.getData("email"),c=MultiSiteService.alreadyRegisteredSiteName;a&&b&&c&&LoginRegister.getViewRef().updateWithAlreadyRegisteredMessage(b,c)};var J=function(a,b,c,d,e){r=a,s=b,t=c,u=d,y=e},K=function(){return v},L=function(){return r},M=function(){return w},N=function(){setTimeout(function(){r.showLogoutControls(),PluckService.createPluckCookie(r.notifyAboutLoginStatus),m()},0)},O=function(b,c,e,f){var g=1e3*(janrain.cms.janrainTimeoutInSeconds+1);v&&a.ajax({type:"POST",url:"/ajax",data:{action:"sendWelcomeEmail",siteKey:siteKey,firstName:b,emailAddress:c,userId:e,siteStyle:y,token:v},dataType:"json",timeout:g}).done(function(b){C=b?"ok":"failed",b?f&&(a("#confirmationTo").html(c),a("#profileEmailSentConfirmation").show(),a("#profileEmailSentFailed").hide(),a("#profileEmailSent").modal("show"),d(a("#profileEmailSent"))):f&&(a("#profileEmailSentConfirmation").hide(),a("#profileEmailSentFailed").show(),a("#profileEmailSent").modal("show"),d(a("#profileEmailSent")))}).error(function(){a("#profileEmailSentConfirmation").hide(),a("#profileEmailSentFailed").show()})},P=function(){var b=a("#janrainModal");b.closest(".janrain-modal__wrapper").length||(b.wrap('<div class="janrain-modal__wrapper"></div>'),a(".janrain-modal__wrapper").on("click",function(a){a.target==this&&(a.stopPropagation(),JanrainCaptureHelper.closeModal())})),a("body,header.header").css("padding-right",h),a("body").addClass("janrain-modal__page--displayed")},Q=function(){a("body,header.header").css("padding-right",""),a("body").removeClass("janrain-modal__page--displayed").css("padding","").css("margin","")},R=function(){var b=a("#janrainModal");b.height()<c.innerHeight?b.css("margin-top",(c.innerHeight-b.height())/2):b.css("margin-top","15px")},S="onorientationchange"in c,T=S?"orientationchange":"resize";c.addEventListener(T,function(){setTimeout(function(){R()},200)},!1);var U=function(a){return!1},V=function(){for(var c=Object.keys(janrain.events),d=0,e=c.length;e>d;d++){var f=c[d];"function"==typeof janrain.events[f].addHandler&&janrain.events[f].addHandler(function(c){return function(d){a(b).trigger("jr:"+c,d),JanrainUtil.debug([c,d],"info")}}(f)),H.hasOwnProperty(f)&&janrain.events[f].addHandler(H[f])}for(var h=Object.keys(I),i=0,j=h.length;j>i;i++){var k=h[i],l="janrain:onShow_"+k;g.on(l,function(a){return function(b,c){JanrainUtil.debug(["Show screen: "+a,b,c],"info"),I[a](c)}}(k))}};return{initVariables:J,getAccessToken:K,getViewRef:L,getUserId:M,postLoginAction:N,sendWelcomeEmail:O,initJanrainEventHandlers:V}}()}(jQuery,document,window),function(a,b,c,d){"use strict";var e=!0,f="log",g=b.innerWidth-a(b).width();b.JanrainUtil={regexPostcodeUK:/^[A-Z]{1,2}[0-9]{1,2}[A-Z]* ?[0-9][A-Z]{2}$/i,showScreen:function(b){var c=a("#"+b);a("#janrainModal").html("").append(c).show(),c.show(),a("#janrainModalOverlay").show(),a("body, header.header").css("padding-right",g),a("body").addClass("janrain-modal__page--displayed")},hideScreen:function(b,c){a("#"+b).hide(),c===!0?a("#janrainModal").hide():a("#janrainModal").html("").hide(),a("#janrainModalOverlay").hide(),a("body,header.header").css("padding-right",""),a("body").removeClass("janrain-modal__page--displayed").css("padding","").css("margin","")},saveNewsletterOptions:function(b,e){var f={};"undefined"!=typeof ProfileManagementLogic.allSitesPref&&(f=ProfileManagementLogic.allSitesPref),f=f.concat(e),f=c.stringify(f);var g=janrain.capture.ui.getReturnExperienceData("email"),h=c.parse(d.getItem("janrainCaptureProfileData")).uuid;a.ajax({type:"POST",url:"/ajax",data:{action:"saveNewsletterOptions",uuid:h,email:g,token:b,sites:f,noEOL:"true"},dataType:"json"}).done(function(a){"ok"===a.stat?JanrainUtil.forceUpdate(b):(JanrainUtil.debug("Failed to save newsletter preferences","error"),"unknown access token"===a.error_description&&JanrainCaptureHelper.endSession())}).fail(function(a,b){JanrainUtil.debug("Failed to save newsletter preferences.\nReason: "+b,"error")})},savePluckUserId:function(b,e,f,g){var h=c.parse(d.getItem("janrainCaptureProfileData")).uuid;a.ajax({type:"POST",url:"/ajax",data:{action:"savePluckUserId",uuid:h,email:b,token:e,pluckUserID:f,noEOL:"true"},dataType:"json"}).done(function(a){"ok"===a.stat&&g&&g()}).fail(function(a,b,c){})},savePrimaryAddress:function(b,c,d){JanrainProfileHelper.getData("uuid");a.ajax({type:"POST",url:"/ajax",data:{action:"savePrimaryAddress",email:b,token:c,uuid:JanrainProfileHelper.getData("uuid"),postcode:d,noEOL:"true"},dataType:"json"}).done(function(a){"ok"===a.stat?JanrainUtil.forceUpdate(c):JanrainUtil.debug(["Failed to save post code.",a],"error")}).fail(function(a,b){JanrainUtil.debug("Failed to save post code.\nReason: "+b,"error")})},forceUpdate:function(b){a.ajax({type:"POST",url:"/ajax",data:{action:"forceUpdateUser",uuid:JanrainProfileHelper.getData("uuid"),email:JanrainCaptureHelper.getData("email"),token:b,noEOL:"true"},dataType:"json"}).done(function(a){"ok"!==a.stat&&JanrainUtil.debug(["Failed to force update.",a],"error")}).fail(function(a,b){JanrainUtil.debug("Failed to force update.\nReason: "+b,"error")})},removeIdFromNewsletterPref:function(a){for(var b=0;b<a.length;b++){delete a[b].id;for(var c=0;c<a[b].newsletters.length;c++){delete a[b].newsletters[c].id;for(var d=0;d<a[b].newsletters[c].preferences.length;d++)delete a[b].newsletters[c].preferences[d].id}}return a},isSignedIn:function(){var a=d.getItem("janrainCaptureToken"),b=d.getItem("janrainCaptureToken_Expires");return a&&b&&new Date(b)-new Date>0},debug:function(a,b){if(e){b=b||"log";var c=["log","info","warn","error"];c.indexOf(b),c.indexOf(f)}}},b.JanrainCaptureHelper={start:function(){janrain.capture.ui.start(),a("#janrainModal").wrap('<div class="janrain-modal__wrapper"></div>'),a(".janrain-modal__wrapper").on("click",function(a){a.target==this&&JanrainCaptureHelper.closeModal()})},getData:function(a){return janrain.capture.ui.getReturnExperienceData(a)},endSession:function(){janrain.capture.ui.endCaptureSession()},openModal:function(b){janrain.capture.ui.renderScreen(b),a("body, header.header").css("padding-right",g),a("body").addClass("janrain-modal__page--displayed")},closeModal:function(){janrain.capture.ui.modal.close(),a("body,header.header").css("padding-right",""),a("body").removeClass("janrain-modal__page--displayed").css("padding","").css("margin","")},hasActiveSession:function(){return janrain.capture.ui.hasActiveSession()},setValidator:function(a,b){janrain.capture.ui.setValidator(a,b)}},b.JanrainProfileHelper={getData:function(a){try{var b=d.getItem("janrainCaptureProfileData"),e=c.parse(b);return e[a]}catch(f){JanrainUtil.debug(f,"error")}return void 0}}}(jQuery,window,JSON,localStorage),function(a,b){"use strict";b.CookieService={setCookie:function(c,d,e){var f="."+b.location.host.replace("www.","");a.cookie(c,d,{expires:e,path:"/",domain:f})},getCookie:function(b){return a.cookie(b)},removeCookie:function(a){null!=this.getCookie(a)&&this.setCookie(a,null,-5)}}}(jQuery,window),function(a,b){"use strict";b.MultiSiteService={isAfterFirstLogin:function(){return!CookieService.getCookie("partiallyLoggedIn")},wasUserPartiallyLoggedIn:function(){return!!CookieService.getCookie("partiallyLoggedIn")},attachCurrentSiteToUser:function(){var b=LoginRegister.getAccessToken(),c=JanrainCaptureHelper.getData("sites"),d=JanrainUtil.removeIdFromNewsletterPref(c),e={code:janrain.cms.siteKey},f=d.concat(e);f=JSON.stringify(f);var g=janrain.capture.ui.getReturnExperienceData("email"),h=JSON.parse(localStorage.getItem("janrainCaptureProfileData")).uuid;a.ajax({type:"POST",url:"/ajax",data:{action:"saveNewsletterOptions",uuid:h,email:g,token:b,sites:f},dataType:"json"}).done(function(a){a=a||{stat:"",error_description:""},"ok"===a.stat?JanrainUtil.forceUpdate(b):JanrainUtil.debug(["Failed to attach current site to the user.",a],"error")}).fail(function(a,b){JanrainUtil.debug("Failed to attach current site to the user.\nReason: "+b,"error")})},getUserAssociatedSites:function(b){var c=1e3*(janrain.cms.janrainTimeoutInSeconds+1);a.ajax({type:"get",url:"/ajax",data:{action:"getAssociatedSites",email:b},async:!0,dataType:"json",timout:c,success:function(a){null===a?(JanrainUtil.debug("Failed to retrieve the user associated sites.","error"),"register"!==MultiSiteService.currentFlow&&JanrainCaptureHelper.closeModal()):"ok"===a.stat?MultiSiteService.doAlreadyRegisteredLogicForSites(b,a.results[0].sites):JanrainCaptureHelper.closeModal()},error:function(a,b){JanrainUtil.debug("Failed to retrieve the user associated sites.\nReason: "+b,"error")}})},doAlreadyRegisteredLogicForSites:function(a,b){for(var c=[],d=0;d<b.length;d++)c.push(b[d].code);MultiSiteService.alreadyRegisteredLogic(a,c)},alreadyRegisteredLogic:function(b,c){if(c.length>0){var d=a.map(c,function(a){return a.toLowerCase()}),e=janrain.cms.siteKey.toLowerCase(),f=a.inArray(e,d)>-1;f?("login"===MultiSiteService.currentFlow&&(JanrainCaptureHelper.closeModal(),LoginRegister.postLoginAction()),MultiSiteService.clearInformation("currentFlow")):MultiSiteService.displayAlreadyRegisteredScreen(b,c)}else"login"===MultiSiteService.currentFlow&&(MultiSiteService.attachCurrentSiteToUser(),LoginRegister.postLoginAction(),JanrainCaptureHelper.closeModal()),MultiSiteService.clearInformation("currentFlow")},displayAlreadyRegisteredScreen:function(b,c){var d=c[c.length-1],e=[janrain.cms.siteKey,d];MultiSiteService.getSiteNames(e).done(function(c){var e=c[janrain.cms.siteKey],f=c[d];MultiSiteService.attachedSiteName=e,MultiSiteService.alreadyRegisteredSiteName=f,MultiSiteService.isThisYou=!0,LoginRegister.getViewRef().displayAlreadyRegisteredScreen(b,f),a(document).trigger("janrain:onShow_isThisYou",{screen:"isThisYou"}),MultiSiteService.clearInformation("loginFailNotification"),"login"===MultiSiteService.currentFlow?CookieService.setCookie("partiallyLoggedIn","yes",1):"register"===MultiSiteService.currentFlow&&a("#capture_returnTraditional_userInformationForm_errorMessages").empty()}).fail(function(a,b){JanrainUtil.debug("Failed to retrieve the site names.\nReason: "+b,"error"),"register"!==MultiSiteService.currentFlow&&(JanrainCaptureHelper.closeModal(),LoginRegister.postLoginAction())})},getSiteNames:function(b){var c=1e3*(janrain.cms.janrainTimeoutInSeconds+1);return a.ajax({type:"get",url:"/ajax",data:{action:"getSiteNames",siteCodes:b.toString()},dataType:"json",timeout:c})},displayThankYouForRegisteringScreen:function(){JanrainCaptureHelper.openModal("registrationNewVerification"),MultiSiteService.siteWasAttachedToUser()&&MultiSiteService.clearInformation("attachedSiteName")},clearUnnecessaryInformation:function(){MultiSiteService.clearInformation("attachedSiteName"),MultiSiteService.clearInformation("alreadyRegisteredSiteName")},loginFailedFromRegisterFlow:function(){return MultiSiteService.loginFailNotification&&MultiSiteService.siteWasAttachedToUser()},loginFailed:function(){return MultiSiteService.wasUserPartiallyLoggedIn()||MultiSiteService.loginFailedFromRegisterFlow()},hasErrorMessages:function(){return MultiSiteService.loginFailedMessage&&"undefined"==typeof MultiSiteService.currentFlow},siteWasAttachedToUser:function(){return"undefined"!=typeof MultiSiteService.attachedSiteName},clearInformation:function(a){delete MultiSiteService[a]},flowIsActive:function(){return"undefined"!=typeof MultiSiteService.currentFlow},showProperties:function(){var a={currentFlow:MultiSiteService.currentFlow,attachedSiteName:MultiSiteService.attachedSiteName,alreadyRegisteredSiteName:MultiSiteService.alreadyRegisteredSiteName,loginFailedMessage:MultiSiteService.loginFailedMessage,loginFailNotification:MultiSiteService.loginFailNotification};JanrainUtil.debug(["MultisiteService",a],"info")}}}(jQuery,window),function(a,b){"use strict";b.UserPreferencesLogic={getNewsletterPreferences:function(b,c){UserPreferencesLogic.addPreferencesLiveValidation(),a.ajax({type:"get",url:"/ajax",data:{action:"getNewsletterPref",siteKey:siteKey},async:!1,dataType:"json",success:function(a){a&&c(a)}})},addPreferencesLiveValidation:function(){a("#pref_postcode").on("change",function(){var b=a(this);JanrainUtil.regexPostcodeUK.test(b.val())||""===b.val()?(""!==b.val()?b.parent().addClass("capture_validated"):b.parent().removeClass("capture_validated"),b.parent().removeClass("capture_error"),b.next(".capture_tip_error").hide()):(b.parent().addClass("capture_error").removeClass("capture_validated"),b.next(".capture_tip_error").show())})},updatePreferences:function(){var a=LoginRegister.getAccessToken();UserPreferencesLogic.getCheckedNewsletterPreferences(a).done(function(b){if("ok"===b.stat){for(var c=[],d=b.result.sites,e=0;e<d.length;e++)if(d[e].code.toLowerCase()===janrain.cms.siteKey.toLowerCase()){c=d[e].newsletters,d.splice(e,1);break}ProfileManagementLogic.allSitesPref=JanrainUtil.removeIdFromNewsletterPref(d);var f=LoginRegister.getViewRef().getCheckedPreferences("register");f&&f[0]&&JanrainUtil.saveNewsletterOptions(a,f),JanrainCaptureHelper.closeModal("preferencesScreen"),MultiSiteService.displayThankYouForRegisteringScreen()}}).fail(function(a,b){JanrainUtil.debug("Failed to retrieve preferences from Janrain.\nReason: "+b,"error")})},getCheckedNewsletterPreferences:function(b){var c=1e3*janrain.cms.janrainTimeoutInSeconds;return a.ajax({type:"POST",url:janrain.settings.capture.captureServer+"/entity?jsonp=?&type_name=user",data:{access_token:b,attributes:'["sites"]'},dataType:"json",timeout:c})},populateProfilePreferencesScreen:function(b){var c,d=[];for(c=0;c<b.length;c++)b[c].code.toLowerCase()===janrain.cms.siteKey.toLowerCase()&&(d=b[c].newsletters,b.splice(c,1));if(ProfileManagementLogic.allSitesPref=JanrainUtil.removeIdFromNewsletterPref(b),0!=d.length)for(c=0;c<d.length;c++){var e=d[c];if("undefined"!=typeof e.name&&"daily"==e.name){var f=e.preferences;for(c=0;c<f.length;c++)a("input[type=checkbox][id='checkbox_"+f[c].code+"']","#profile_dailyNewsletters").attr("checked","checked")}else a("input[type=checkbox][id='checkbox_"+e.name+"']","#profile_additionalOptions").attr("checked","checked")}}}}(jQuery,window),function(a,b){"use strict";b.ProfileManagementLogic={init:function(){var b=a("#capture_editProfile_addressCountry"),c=a("#capture_editProfile_editProfileForm");a(".capture_form_item").on("click",function(){a(".capture_save_success").css("display","none")});var d=function(){0!==a(".capture_error",".janrain-profile__form").length?a("#capture_editProfile_saveButton").addClass("janrain-profile__button--disabled"):a("#capture_editProfile_saveButton").removeClass("janrain-profile__button--disabled")};if(a(".capture_select, .capture_text_input, .capture_textarea").on("blur",d),a("#saveNewsletterOptions").once("click",function(a){if(a.handled!==!0){var b=LoginRegister.getViewRef().getCheckedPreferences("profile"),c=LoginRegister.getAccessToken();JanrainUtil.saveNewsletterOptions(c,b),JanrainCaptureHelper.closeModal(),a.handled=!0}return!1}),a("#editProfile").once("click",function(){var a=localStorage.getItem("janrainCaptureToken");(""===a||null===a)&&JanrainCaptureHelper.endSession()}),a("#logoutBtn").once("click",function(){a("#capture_editProfile_saveButton").addClass("janrain-profile__button--disabled")}),"United Kingdom"===b.val()&&(ProfileManagementLogic.validatePostalcode(!0),a("#capture_editProfile_addressPostalCode").once("blur",ProfileManagementLogic.validatePostalcode)),b.once("change",function(){"United Kingdom"===a("#capture_editProfile_addressCountry").val()?(ProfileManagementLogic.validatePostalcode(!0),a("#capture_editProfile_addressPostalCode").on("blur",ProfileManagementLogic.validatePostalcode),f.removeClass("janrain-profile__button--disabled")):(ProfileManagementLogic.validatePostalcode(!1),a("#capture_editProfile_addressPostalCode").off("blur",ProfileManagementLogic.validatePostalcode))}),"United Kingdom"===b.val()){var e=a("#capture_editProfile_addressPostalCode"),f=a("#capture_editProfile_saveButton");e.once("keyup",function(){f.removeClass("janrain-profile__button--disabled")}),e.once("focus",function(){f.removeClass("janrain-profile__button--disabled")})}a("#capture_editProfile_resendLink").once("click",function(){var a=JanrainCaptureHelper.getData("email"),b=JanrainProfileHelper.getData("uuid");return LoginRegister.sendWelcomeEmail(ProfileManagementLogic.firstName,a,b,!0),!1}),a("input","#capture_editProfile_editProfileForm").focus(function(){var b=a("#capture_editProfile_saveButton");c.find(".capture_error").length<1&&b.removeClass("janrain-profile__button--disabled")}),a("#capture_editProfile_saveButton").on("click",function(){c.find(".capture_error").length>0&&a(".capture_save_success").hide()}).once("click",ProfileManagementLogic.onFormSubmission)},validatePostalcode:function(b){var c=a("#capture_editProfile_addressPostalCode"),d=c.parent();""!==c.val()&&("United Kingdom"!==a("#capture_editProfile_addressCountry").val()||JanrainUtil.regexPostcodeUK.test(c.val())?(b&&d.addClass("capture_validated"),d.removeClass("capture_error"),d.find(".capture_tip_error").hide().text("")):(b&&d.addClass("capture_error"),d.removeClass("capture_validated"),d.find(".capture_tip_error").text("Please provide a valid UK postcode.").show()),ProfileManagementLogic.updateFormSubmission())},updateFormSubmission:function(){var b=a("#capture_editProfile_saveButton");return a(".capture_error","#capture_editProfile_editProfileForm").length>0?b.addClass("janrain-profile__button--disabled"):b.removeClass("janrain-profile__button--disabled"),!1},onFormSubmission:function(b){if(a(".capture_save_success","#capture_editProfile_editProfileForm").hide(),ProfileManagementLogic.validatePostalcode(!0),a(".capture_error","#capture_editProfile_editProfileForm").length>0){var c=a(".capture_error").offset().top-96;return a("#capture_editProfile_saveButton").addClass("janrain-profile__button--disabled"),a("html, body").animate({scrollTop:c},"slow"),b.preventDefault(),b.stopImmediatePropagation(),!1}return!0},getActivationStatus:function(b,c){var d=new Date-0;return a.ajax({type:"get",url:"/ajax",data:{action:"getActivationStatus",email:b,token:c,_:d},dataType:"json",timeout:1e3*janrain.cms.janrainTimeoutInSeconds})},displayEmailVerificationLink:function(b,c){ProfileManagementLogic.getActivationStatus(b,c).done(function(b){null===b?(JanrainUtil.debug("Could not get the activation status.","error"),a("#capture_editProfile_resendLink").hide()):b===!1?a("#capture_editProfile_resendLink").show():b===!0&&a("#capture_editProfile_resendLink").hide()}).fail(function(a,b){JanrainUtil.debug("Failed to retrieve the activation status.\nReason: "+b,"error")})}}}(jQuery,window);