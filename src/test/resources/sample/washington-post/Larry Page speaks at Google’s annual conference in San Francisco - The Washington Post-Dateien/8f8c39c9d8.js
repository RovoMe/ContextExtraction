var wapoSites=new Array;var $wpjQ=typeof $wpjQ&&$wpjQ||jQuery;eval($wpjQ('script[src$\x3d"wapolabs.nojq.full.js"]').html());var wapoUtilities,WapoUtil=function(){};
WapoUtil.prototype.Get_Cookie=function(check_name){var a_all_cookies,a_temp_cookie,cookie_name,cookie_value,b_cookie_found,cookie_regex,i;a_all_cookies=document.cookie.split(";");b_cookie_found=false;cookie_regex=/^(.*?)(=)(.*?)$/;i=a_all_cookies.length;while(i--){a_temp_cookie=a_all_cookies[i].match(cookie_regex);if(typeof a_temp_cookie!=="undefined"&&a_temp_cookie!==null){cookie_name=a_temp_cookie[1].replace(/^\s+|\s+$/g,"");if(cookie_name===check_name){b_cookie_found=true;if(a_temp_cookie[2]===
"\x3d")cookie_value=unescape(a_temp_cookie[3].replace(/^\s+|\s+$/g,""));return cookie_value}}a_temp_cookie=null;cookie_name=""}if(!b_cookie_found)return null};WapoUtil.prototype.Delete_Cookie=function(name,path,domain){if(this.Get_Cookie(name))document.cookie=name+"\x3d"+(path?";path\x3d"+path:"")+(domain?";domain\x3d"+domain:"")+";expires\x3dThu, 01-Jan-1970 00:00:01 GMT"};
WapoUtil.prototype.Set_Cookie=function(name,value,expires,path,domain,secure){var today,expires_date;today=new Date;today.setTime(today.getTime());if(expires)expires=expires*1E3*60*60*24;expires_date=new Date(today.getTime()+expires);document.cookie=name+"\x3d"+escape(value)+(expires?";expires\x3d"+expires_date.toGMTString():"")+(path?";path\x3d"+path:"")+(domain?";domain\x3d"+domain:"")+(secure?";secure":"")};
WapoUtil.prototype.Get_Request_Parameter=function(queryString,parameterName){var begin,end;parameterName=parameterName+"\x3d";if(queryString.length>0){begin=queryString.indexOf(parameterName);if(begin!==-1){begin+=parameterName.length;end=queryString.indexOf("\x26",begin);if(end===-1)end=queryString.length;return unescape(queryString.substring(begin,end))}return"null"}};
WapoUtil.prototype.getParameter=function(parameterName){var queryString,begin,end;queryString=window.top.location.search.substring(1);parameterName=parameterName+"\x3d";if(queryString.length>0){begin=queryString.indexOf(parameterName);if(begin!==-1){begin+=parameterName.length;end=queryString.indexOf("\x26",begin);if(end===-1)end=queryString.length;return unescape(queryString.substring(begin,end))}return"null"}};
WapoUtil.prototype.getBaseDomainName=function(hostName){var baseDomainName,lastDotIdx,secondDotIdx;baseDomainName=hostName;lastDotIdx=hostName.lastIndexOf(".");if(lastDotIdx>-1){secondDotIdx=hostName.lastIndexOf(".",lastDotIdx-1);if(secondDotIdx>-1)baseDomainName=hostName.substring(secondDotIdx+1)}return baseDomainName};
WapoUtil.prototype.checkVisitorId=function(domain){var cookieExists,wapoIFrame;cookieExists=wapoUtilities.Get_Cookie("s_vi");if(cookieExists===null){wapoIFrame=document.createElement("iframe");wapoIFrame.height=1;wapoIFrame.width=1;wapoIFrame.style.display="none";wapoIFrame.src="http://www.washingtonpost.com/wp-srv/wapolabs/dw/readomniturecookie.html?"+domain;document.getElementById("wapo_338542").appendChild(wapoIFrame)}};wapoUtilities=new WapoUtil;var JSON;if(!JSON)JSON={};
(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,
length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function")value=value.toJSON(key);if(typeof rep==="function")value=rep.call(holder,key,value);switch(typeof value){case "string":return quote(value);case "number":return isFinite(value)?String(value):"null";case "boolean":case "null":return String(value);case "object":if(!value)return"null";gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=
0;i<length;i+=1)partial[i]=str(i,value)||"null";v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1)if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}}else for(k in value)if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}v=partial.length===0?"{}":gap?"{\n"+
gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function")JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number")for(i=0;i<space;i+=1)indent+=" ";else if(typeof space==="string")indent=space;rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number"))throw new Error("JSON.stringify");return str("",{"":value})};if(typeof JSON.parse!==
"function")JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object")for(k in value)if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined)value[k]=v;else delete value[k]}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse");}})();var wapoEvent;WapoEvent=function(){var parts=document.domain.split(".");if(parts.length>=2)this.eventHost="event."+parts[parts.length-2]+"."+parts[parts.length-1];else this.eventHost="event."+document.domain};
WapoEvent.prototype.logEvent=function(event_name,application,event_data){var payload={};payload.event=event_name;payload.app=application;payload.referer=document.referer;payload.url=window.location.href;this.addValue(payload,"appdata",event_data);var ajaxOptions={type:"GET",dataType:"jsonp",url:"http://"+wapoEvent.eventHost+"/log.php",cache:false,data:payload};return $wpjQ.ajax(ajaxOptions)};
WapoEvent.prototype.addValue=function(map,key,value){if(typeof value!=="undefined"&&value!==null)map[key]=value};wapoEvent=new WapoEvent;function WapoSite(name,url,visId){this.name=name;this.url=url;this.visId=visId}
function WapoEnv(){this.fb_key="41245586762";this.publicationName="Washington Post";this.site_base_domain="washingtonpost.com";this.site_path="/";this.jskit_div="js-kit-comments";this.jskit_class="js-kit-comments";this.jskit_consumer_key="prod.washpost.com";this.wapo_secure_protocol="https:";this.wapo_site_url="//id.washingtonpost.com/identity/";this.site_url="//www.washingtonpost.com/";this.wapo_public_protocol="http:";this.visitor_session_length="30";this.customLoginTrigger=false;this.init_xfbml=
false;this.jskit_commenting_group="commenting";this.wapo_reg_url="https://ssl.washingtonpost.com/actmgmt/registration/login/commenting?destination\x3d";this.commenting_edit_profile_url="https://ssl.washingtonpost.com/actmgmt/registration/group/commenting?destination\x3d";this.param_name_jsonp_callback="jsonp_callback";this.param_name_nonce="wp_id_n";this.param_name_email_nonce="wp_em_n";this.meta_tag_groups="wapoGroups";this.meta_tag_optional_groups="wapoOptionalGroups";this.param_name_redirect="next_url";
this.param_name_previous_url="previous_url";this.param_name_no_cancel="wp_no_cancel";this.param_name_regis_group_name="reg_group";this.param_name_login_id="loginId";this.param_name_show_registration="show_registration";this.param_name_registration_redirect="wp_regis_redirect";this.param_name_login_redirect="wp_login_redirect";this.place_holder="ph";this.cookie_display="wapo_display";this.cookie_avatar="washingtonpost_avatar";this.cookie_groups="wapo_groups";this.cookie_vis_id="wapo_vis_id";this.cookie_login_id=
"wapo_login_id";this.cookie_previous_ip="wapo_saved_ip";this.cookie_last_ip="wapo_last_ip";this.cookie_omniture="s_vi";this.cookie_previous_omniture="wapo_saved_omnitureid";this.cookie_previous_ip="wapo_saved_ip";this.cookie_session_id="wapo_sess_id";this.cookie_wpni_id="wpniuser";this.event_name_login="wapoLogin";this.event_name_new_registration="wapoRegister";this.event_name_logout="wapoLogout";this.event_name_fb_async_init="wapoFbAsyncInit"}
WapoEnv.prototype.Set_Unescaped_Cookie=function(name,value,expires,path,domain,secure){var today,expires_date;today=new Date;today.setTime(today.getTime());if(expires)expires=expires*1E3*60*60*24;expires_date=new Date(today.getTime()+expires);document.cookie=name+"\x3d"+value+(expires?";expires\x3d"+expires_date.toGMTString():"")+(path?";path\x3d"+path:"")+(domain?";domain\x3d"+domain:"")+(secure?";secure":"")};var wapoEnv=new WapoEnv;
window.$wpjQ=typeof window.$wpjQ!=="undefined"&&window.$wpjQ||jQuery;$wpjQ(document).trigger("wapo_env_init");if(typeof wapoEvent!=="undefined"&&typeof wapoEvent.eventHost!=="undefined")wapoEvent.eventHost="event.washingtonpost.com";var wapoVisitor;function WapoVisitor(){this.initProperties();for(var i=0;i<wapoSites.length;i++){var site=wapoSites[i];if(site.name==wapoEnv.publicationName)site.visId="-1"}}
WapoVisitor.prototype.initProperties=function(){this.wapoVisId="";this.wapoLoginId="";this.tbInit=false;this.baseDomainName=null;this.displayName="";this.picUrl=null;this.completedGroups=null;this.unconfirmedGroups=null;this.windowLocation=window.location.href;this.providerUrl=null};WapoVisitor.prototype.updateVisitorLogin=function(){var url=wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/login/visitor.json?";$wpjQ.ajax({dataType:"jsonp",jsonp:"jsonp_callback",url:url,success:function(html){}})};
WapoVisitor.prototype.checkNonce=function(){var parms,parmPairs,url;parms=window.location.search;parms=parms.substring(1);parmPairs=parms.split("\x26");url="";for(var i=0;i<parmPairs.length;i++){var pieces=parmPairs[i].split("\x3d");if(pieces[0]==wapoEnv.param_name_nonce){if(pieces.length>1)url=wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"siteRegistration/resetPassword?"+wapoEnv.param_name_nonce+"\x3d"+pieces[1]+"\x26"+wapoEnv.param_name_redirect+"\x3d"+escape(window.location.href)+"\x26"+
wapoEnv.param_name_previous_url+"\x3d"+escape(window.location.href)}else if(pieces[0]==wapoEnv.param_name_email_nonce){if(pieces.length>1)url=wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"siteRegistration/confirmEmail?"+wapoEnv.param_name_email_nonce+"\x3d"+pieces[1]+"\x26"+wapoEnv.param_name_redirect+"\x3d"+escape(window.location.href)+"\x26"+wapoEnv.param_name_previous_url+"\x3d"+escape(window.location.href)}else if(pieces[0]==wapoEnv.param_name_login_redirect)this.updateVisitorLogin()}return url};
WapoVisitor.prototype.checkRegistration=function(){var url,metaElement,requiredGroups,parts,allFound;url="";metaElements=document.getElementsByName(wapoEnv.meta_tag_groups);if(metaElements&&metaElements.length>0)if(this.wapoLoginId===null||this.wapoLoginId==="")url=wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/login/options?"+wapoEnv.param_name_redirect+"\x3d"+escape(window.location.href)+"\x26"+wapoEnv.param_name_previous_url+"\x3d"+escape(window.location.href)+"\x26"+wapoEnv.param_name_no_cancel+
"\x3dtrue";else{requiredGroups=metaElements[0].content;parts=requiredGroups.split("-");allFound=true;for(i=0;i<parts.length;i++)if(!this.completedGroups||this.completedGroups===null||this.completedGroups.indexOf(parts[i])===-1)allFound=false;if(!allFound)url=wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"siteRegistration/editProfile?"+wapoEnv.param_name_regis_group_name+"\x3d"+requiredGroups+"\x26"+wapoEnv.param_name_no_cancel+"\x3dtrue"}return url};
WapoVisitor.prototype.checkPopUp=function(){var url="";url=this.checkNonce();if(url==="")url=this.checkRegistration();if(url!=""){$wpjQ('\x3ca id\x3d"wapoReset" href\x3d"'+url+"\x26KeepThis\x3dtrue\x26TB_iframe\x3dtrue\x26height\x3d464\x26width\x3d"+wapoEnv.lightbox_width+'\x26modal\x3dtrue" class\x3d"thickbox"\x3e'+"\x3c/a\x3e").appendTo("#wapolabs_wrapperLoginStatus");wapoVisitor.tbInit=true}};
WapoVisitor.prototype.loginFacebook=function(uid){if(wapoVisitor.wapoLoginId===null){var url=wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/login/get_for_facebook"+"?format\x3djson\x26jsonp\x3d\x26"+wapoEnv.param_name_jsonp_callback+"\x3d?\x26facebookUid\x3d"+uid;$wpjQ.getJSON(url,new Function("data","if (data !\x3d\x3d null \x26\x26 typeof(data."+wapoEnv.param_name_login_id+") !\x3d\x3d 'undefined' \x26\x26 data."+wapoEnv.param_name_login_id+" !\x3d\x3d null \x26\x26 typeof(data."+wapoEnv.param_name_show_registration+
") !\x3d\x3d 'undefined' \x26\x26 data."+wapoEnv.param_name_show_registration+" !\x3d\x3d null) {"+"wapoVisitor.wapoLoginId \x3d data."+wapoEnv.param_name_login_id+";"+"wapoVisitor.updateWaPoLogin(data."+wapoEnv.param_name_show_registration+", data."+wapoEnv.param_name_login_id+", 'false', 'false');"+"}"))}};
WapoVisitor.prototype.getDependentLoginValues=function(){var regGroups,displayInfo,parts,tempUrl;if(this.wapoLoginId!=null){displayInfo=wapoUtilities.Get_Cookie(wapoEnv.cookie_display);if(displayInfo&&displayInfo!=null){parts=displayInfo.split("|");if(parts.length>0){this.displayName=decodeURIComponent(parts[0]);if(this.displayName.substr(0,1)==='"')this.displayName=this.displayName.substring(1);this.displayName=this.displayName}if(parts.length>1){tempUrl=parts[1];if(tempUrl.substr(tempUrl.length-
1,1)==='"')tempUrl=tempUrl.substring(0,tempUrl.length-1);if(tempUrl!=wapoEnv.place_holder)this.picUrl=decodeURIComponent(tempUrl)}if(parts.length>2){tempUrl=parts[2];if(tempUrl.substr(tempUrl.length-1,1)==='"')tempUrl=tempUrl.substring(0,tempUrl.length-1);this.providerUrl=decodeURIComponent(tempUrl)}}regGroups=wapoUtilities.Get_Cookie(wapoEnv.cookie_groups);if(regGroups&&regGroups!=null){parts=regGroups.split("|");if(parts.length>0)this.completedGroups=parts[0];if(parts.length>1)this.unconfirmedGroups=
parts[1]}}};
WapoVisitor.prototype.init=function(){this.wapoLoginId=wapoUtilities.Get_Cookie(wapoEnv.cookie_login_id);if(this.wapoLoginId!==null&&this.wapoLoginId.length>0)this.getDependentLoginValues();this.baseDomainName=wapoEnv.site_base_domain;this.wapoVisId=wapoUtilities.Get_Cookie(wapoEnv.cookie_vis_id);if(this.wapoVisId!==null){this.reconcileVisId();this.updateWaPoVisId(this.wapoVisId)}else this.initVisId();this.wapoLoginId=wapoUtilities.Get_Cookie(wapoEnv.cookie_login_id);if(this.wapoLoginId!==null&&this.wapoLoginId.length>
0)this.getDependentLoginValues();document.domain=this.baseDomainName;$wpjQ(document).trigger("wapoInit");this.checkPopUp();this.resetThickbox()};WapoVisitor.prototype.resetThickbox=function(){var tbInitCallback=function(){var wapoReset=$wpjQ("#wapoReset");if(wapoReset.length)wapoReset.trigger("click")};if(this.tbInit===true)this.tbInit=false};
WapoVisitor.prototype.setWapoVisId=function(){var foundVisId="-1";var noNullsFound=true;for(var i=0;i<wapoSites.length;i++){var site=wapoSites[i];if(site.visId==null)noNullsFound=false;else if(site.visId!=="-1")if(foundVisId==null||foundVisId<site.visId)foundVisId=site.visId}if(noNullsFound)if(foundVisId!=="-1"){this.wapoVisId=foundVisId;wapoUtilities.Set_Cookie(wapoEnv.cookie_vis_id,wapoVisitor.wapoVisId,50*365,wapoEnv.site_path,this.baseDomainName,false);$wpjQ(document).trigger("wapo_visitor_create");
this.updateWaPoVisId(this.wapoVisId)}else var url=wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/visitor/create?format\x3djson\x26jsonp\x3d\x26"+wapoEnv.param_name_jsonp_callback+"\x3d?"};
WapoVisitor.prototype.updateWaPoVisId=function(visId){return false;var url,omnitureId,data,currentIp,previousIp;this.wapoVisId=visId;currentIp=wapoUtilities.Get_Cookie(wapoEnv.cookie_last_ip);previousIp=wapoUtilities.Get_Cookie(wapoEnv.cookie_previous_ip);if(currentIp===null||previousIp===null||currentIp!==previousIp){url=wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/visitor/ip_address.json";data={};data[wapoEnv.cookie_previous_ip]=wapoUtilities.Get_Cookie(wapoEnv.cookie_previous_ip);
$wpjQ.ajax({dataType:"jsonp",jsonp:wapoEnv.param_name_jsonp_callback,url:url,data:data,success:function(msg){wapoUtilities.Set_Cookie(wapoEnv.cookie_previous_ip,msg.retVal,50*365,wapoEnv.site_path,wapoEnv.site_base_domain,false)}})}omnitureId=wapoUtilities.Get_Cookie(wapoEnv.cookie_omniture);previousOmnitureId=wapoUtilities.Get_Cookie(wapoEnv.cookie_previous_omniture);if(omnitureId!==null&&omnitureId.length>0&&(previousOmnitureId==null||previousOmnitureId!=omnitureId)){url=wapoEnv.wapo_public_protocol+
wapoEnv.wapo_site_url+"public/visitor/instance_datum.json?attributeName\x3domniture_vis_id\x26attributeValue\x3d"+escape(omnitureId);$wpjQ.ajax({dataType:"jsonp",jsonp:wapoEnv.param_name_jsonp_callback,url:url,success:function(msg){wapoUtilities.Set_Cookie(wapoEnv.cookie_previous_omniture,msg.retVal,50*365,wapoEnv.site_path,wapoEnv.site_base_domain,false)}})}this.updateSessionId()};
WapoVisitor.prototype.reconcileVisId=function(){currentVisId=wapoUtilities.Get_Cookie(wapoEnv.cookie_vis_id);if(currentVisId&&wapoSites.length>1)for(var i=0;i<wapoSites.length;i++){var site=wapoSites[i];if(site.name!==wapoEnv.publicationName)$wpjQ.ajax({url:site.url+"public/visitor.json",data:{"lang":"en-us","tags":"sunset"},dataType:"jsonp",callbackParameter:wapoEnv.param_name_jsonp_callback,jsonp:wapoEnv.param_name_jsonp_callback,timeout:5*1E3,success:new Function("data","status","if(data !\x3d null \x26\x26 data.visitors !\x3d null \x26\x26 data.visitors.wapoVisitor !\x3d null \x26\x26 data.visitors.wapoVisitor.id !\x3d null)"+
"{"+"wapoSites["+i+"].visId \x3d data.visitors.wapoVisitor.id+'';"+"}"+"else"+"{"+"wapoSites["+i+"].visId \x3d '-1';"+"} "+"wapoVisitor.processReconcileVisId();"),error:new Function("XHR","textStatus","errorThrown","wapoSites["+i+"].visId \x3d '-1'; wapoVisitor.processReconcileVisId();")})}};
WapoVisitor.prototype.processReconcileVisId=function(){var foundVisId="-1";var noNullsFound=true;for(var i=0;i<wapoSites.length;i++){var site=wapoSites[i];if(site.visId==null)noNullsFound=false;else if(site.visId!=="-1")if(foundVisId==null||foundVisId<site.visId)foundVisId=site.visId}if(noNullsFound)if(foundVisId!=="-1"){this.wapoVisId=foundVisId;currentVisIdCookieVal=wapoUtilities.Get_Cookie(wapoEnv.cookie_vis_id);if(currentVisIdCookieVal!==null&&currentVisIdCookieVal!==foundVisId){wapoUtilities.Set_Cookie(wapoEnv.cookie_vis_id,
wapoVisitor.wapoVisId,50*365,wapoEnv.site_path,this.baseDomainName,false);$wpjQ(document).trigger("wapo_visitor_create")}}else var url=wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/visitor/create?format\x3djson\x26jsonp\x3d\x26"+wapoEnv.param_name_jsonp_callback+"\x3d?"};
WapoVisitor.prototype.updateSessionId=function(){var currentSessionId;currentSessionId=wapoUtilities.Get_Cookie(wapoEnv.cookie_session_id);if(typeof currentSessionId==="undefined"||currentSessionId===null)currentSessionId=this.createUUID();wapoUtilities.Set_Cookie(wapoEnv.cookie_session_id,currentSessionId,wapoEnv.visitor_session_length/(60*24),wapoEnv.site_path,wapoEnv.site_base_domain,false)};
WapoVisitor.prototype.createUUID=function(){var s=[];var hexDigits="0123456789ABCDEF";for(var i=0;i<32;i++)s[i]=hexDigits.substr(Math.floor(Math.random()*16),1);s[12]="4";s[16]=hexDigits.substr(s[16]&3|8,1);var uuid=s.join("");return uuid};
WapoVisitor.prototype.initVisId=function(){if(wapoSites.length>1)for(var i=0;i<wapoSites.length;i++){var site=wapoSites[i];if(site.name!==wapoEnv.publicationName)$wpjQ.ajax({url:site.url+"public/visitor.json",data:{"lang":"en-us","tags":"sunset"},dataType:"jsonp",callbackParameter:wapoEnv.param_name_jsonp_callback,jsonp:wapoEnv.param_name_jsonp_callback,timeout:5*1E3,success:new Function("data","status","if(data !\x3d null \x26\x26 data.visitors !\x3d null \x26\x26 data.visitors.wapoVisitor !\x3d null \x26\x26 data.visitors.wapoVisitor.id !\x3d null)"+
"{"+"wapoSites["+i+"].visId \x3d data.visitors.wapoVisitor.id+'';"+"}"+"else"+"{"+"wapoSites["+i+"].visId \x3d '-1';"+"} "+"wapoVisitor.setWapoVisId();"),error:new Function("XHR","textStatus","errorThrown","wapoSites["+i+"].visId \x3d '-1'; wapoVisitor.setWapoVisId();")})}else this.setWapoVisId()};
WapoVisitor.prototype.incrementalRegistration=function(registrationGroup,link){var newUrl;if(this.completedGroups!=null&&this.completedGroups.indexOf(registrationGroup)===-1){newUrl=wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"siteRegistration/editProfile?"+"reg_group\x3d"+registrationGroup+"\x26"+wapoEnv.param_name_previous_url+"\x3d"+escape(window.location.href)+"\x26"+wapoEnv.param_name_redirect+"\x3d"+escape(link.href);link.href=newUrl}};
WapoVisitor.prototype.identityUser=function(){return{urls:{login:wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/login/options?"+wapoEnv.param_name_redirect+"\x3d"+this.windowLocation+"\x26"+wapoEnv.param_name_previous_url+"\x3d"+this.windowLocation,logout:wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"public/login/logout?redirect\x3d"+wapoVisitor.windowLocation,profilePic:wapoVisitor.picUrl||"",editProfile:wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"siteRegistration/editProfile?"+
wapoEnv.param_name_redirect+"\x3d"+this.windowLocation+"\x26"+wapoEnv.param_name_previous_url+"\x3d"+this.windowLocation},user:{loggedin:!(this.wapoLoginId===null||this.wapoLoginId==="")}}};
WapoVisitor.prototype.includeSignInRegistration=function(){var url;var registrationGroups=getOptionalRegistrationGroups();if(this.wapoLoginId===null||this.wapoLoginId===""){$wpjQ("#wapoLogout").remove();$wpjQ("#wapoEditProfile").remove();$wpjQ("#helloPic").remove();$wpjQ("#helloLogin").remove();$wpjQ("#wapolabs_wrapperLoginStatus").html('\x3ca id\x3d"wapoLogin" class\x3d"thickbox" href\x3d"'+wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/login/options?"+wapoEnv.param_name_redirect+"\x3d"+
this.windowLocation+"\x26"+wapoEnv.param_name_previous_url+"\x3d"+this.windowLocation+registrationGroups+"\x26KeepThis\x3dtrue\x26TB_iframe\x3dtrue\x26height\x3d464\x26width\x3d"+wapoEnv.lightbox_width+'\x26modal\x3dtrue" rel\x3d"nofollow" title\x3d"Login or Register"\x3e'+'\x3cspan class\x3d"lnk_login"\x3eLog in\x3c/span\x3e\x3cspan class\x3d"lnk_div"\x3e/\x3c/span\x3e\x3cspan class\x3d"lnk_reg"\x3eRegister\x3c/span\x3e\x3c/a\x3e')}else{if(this.displayName===null||this.displayName==="")this.getDependentLoginValues();
$wpjQ("#wapoLogout").remove();$wpjQ("#wapoEditProfile").remove();$wpjQ("#helloLogin").remove();$wpjQ("#helloPic").remove();$wpjQ("#wapoRegistration").remove();$wpjQ("#wapoLogin").remove();$wpjQ("#wapolabs_wrapperLoginStatus").html('\x3cspan id\x3d"helloLogin"\x3e\x3cspan class\x3d"txt_greeting"\x3eHello \x3c/span\x3e'+'\x3cspan class\x3d"txt_username"\x3e'+this.displayName+"\x3c/span\x3e"+"\x3c/span\x3e");if(!this.picUrl||this.picUrl==="")$wpjQ('\x3cimg id\x3d"helloPic" style\x3d"display:none;" alt\x3d"User Profile Picture" /\x3e').appendTo("#wapolabs_wrapperLoginStatus");
else $wpjQ('\x3cimg id\x3d"helloPic" width\x3d"40" height\x3d"40" src\x3d"'+wapoVisitor.picUrl+'" style\x3d"display:inline;" alt\x3d"User Profile Picture" /\x3e').appendTo("#wapolabs_wrapperLoginStatus");if(!this.providerUrl||this.providerUrl==="")$wpjQ('\x3cimg id\x3d"providerPic" style\x3d"display:none;" alt\x3d"Provider Brand" /\x3e').appendTo("#wapolabs_wrapperLoginStatus");else $wpjQ('\x3cimg id\x3d"providerPic" src\x3d"'+wapoVisitor.providerUrl+'" style\x3d"display:inline;" alt\x3d"Provider Brand" /\x3e').appendTo("#wapolabs_wrapperLoginStatus");
if(this.completedGroups!=null||this.unconfirmedGroups!=null)$wpjQ('\x3cspan class\x3d"lnk_div"\x3e | \x3c/span\x3e'+'\x3ca id\x3d"wapoEditProfile" href\x3d"'+wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"siteRegistration/editProfile?"+wapoEnv.param_name_redirect+"\x3d"+this.windowLocation+"\x26"+wapoEnv.param_name_previous_url+"\x3d"+this.windowLocation+registrationGroups+"\x26KeepThis\x3dtrue\x26TB_iframe\x3dtrue\x26height\x3d464\x26width\x3d"+wapoEnv.lightbox_width+'\x26modal\x3dtrue" class\x3d"thickbox" rel\x3d"nofollow" title\x3d"Edit Profile"\x3e'+
'\x3cspan class\x3d"lnk_edit"\x3eEdit Profile\x3c/span\x3e'+"\x3c/a\x3e").appendTo("#wapolabs_wrapperLoginStatus");$wpjQ('\x3cspan class\x3d"lnk_div"\x3e | \x3c/span\x3e'+'\x3ca id\x3d"wapoLogout" href\x3d"'+wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"public/login/logout?redirect\x3d"+wapoVisitor.windowLocation+'" rel\x3d"nofollow" title\x3d"Logout" onclick\x3d"wapoVisitor.wapoLogout(); wapoVisitor.resetThickbox(); return false;"\x3e'+'\x3cspan class\x3d"lnk_logout"\x3eLog out\x3c/span\x3e'+
"\x3c/a\x3e").appendTo("#wapolabs_wrapperLoginStatus");url=wapoEnv.wapo_public_protocol+wapoEnv.wapo_site_url+"public/login/get/"+this.wapoLoginId+"?format\x3djson\x26jsonp\x3d\x26"+wapoEnv.param_name_jsonp_callback+"\x3d?"}wapoVisitor.tbInit=true;return true};
WapoVisitor.prototype.updateWaPoLogin=function(showRegistration,loginId,noCancel,callCloseCallback,loginEvent){this.wapoLoginId=loginId;this.getDependentLoginValues();if(typeof noCancel==="undefined")noCancel="false";if(typeof callCloseCallback==="undefined")callCloseCallback="true";if(typeof loginEvent!=="undefined")$wpjq(document).trigger(loginEvent);if(showRegistration==="true"){var registrationGroups=getOptionalRegistrationGroups();document.getElementById("TB_iframeContent").src=wapoEnv.wapo_secure_protocol+
wapoEnv.wapo_site_url+"siteRegistration?"+wapoEnv.param_name_no_cancel+"\x3d"+noCancel+registrationGroups}else{$wpjQ(document).trigger("wapoRefreshDisplay");this.updateVisitorLogin();this.resetThickbox();if(typeof wapoThickBoxCloseCallback!=="undefined"&&callCloseCallback==="true")wapoThickBoxCloseCallback()}};
WapoVisitor.prototype.wapoLogout=function(){var url=wapoEnv.wapo_secure_protocol+wapoEnv.wapo_site_url+"public/login/logout"+"?format\x3djson\x26"+wapoEnv.param_name_login_id+"\x3d"+escape(this.wapoLoginId)+"\x26jsonp\x3d\x26"+wapoEnv.param_name_jsonp_callback+"\x3d?";$wpjQ.ajax({dataType:"jsonp",jsonp:wapoEnv.param_name_jsonp_callback,url:url,timeout:2*1E3,success:function(data){if(data!==null&&data.providerName!==null)if(data.providerName==="Facebook"&&typeof FB!=="undefined"){wapoVisitor.endLogout();
FB.logout()}else wapoVisitor.endLogout()},error:function(XHR,textStatus,errorThrown){wapoVisitor.endLogout()}})};
WapoVisitor.prototype.endLogout=function(){wapoUtilities.Delete_Cookie(wapoEnv.cookie_login_id,wapoEnv.site_path,wapoEnv.site_base_domain);wapoUtilities.Delete_Cookie(wapoEnv.cookie_groups,wapoEnv.site_path,wapoEnv.site_base_domain);wapoUtilities.Delete_Cookie(wapoEnv.cookie_display,wapoEnv.site_path,wapoEnv.site_base_domain);this.initProperties();$wpjQ(document).trigger(wapoEnv.event_name_logout);this.resetThickbox();if(typeof wapoLogoutCallback!=="undefined")wapoLogoutCallback()};
function wapoInit(windowLocation){wapoVisitor=new WapoVisitor;wapoVisitor.windowLocation=windowLocation;if(!wapoEnv.customLoginTrigger)$wpjQ(document).bind("wapoLogin.default",function(){});$wpjQ(document).bind("wapoInit.default",function(){$wpjQ(document).trigger("wapoRefreshDisplay")});$wpjQ(document).bind("wapoLogout.default",function(){$wpjQ(document).trigger("wapoRefreshDisplay")});$wpjQ(document).bind("wapoRegister.default",function(){});$wpjQ(document).bind("wapoRefreshDisplay.default",function(){});
wapoVisitor.init();return wapoVisitor}function getOptionalRegistrationGroups(){var metaElements=$wpjQ("[name\x3d"+wapoEnv.meta_tag_optional_groups+"]");var registrationGroups="";if(metaElements&&metaElements.length>0)registrationGroups="\x26"+wapoEnv.param_name_regis_group_name+"\x3d"+metaElements[0].content;return registrationGroups}var wapoVisitor=wapoInit(window.location.href);
WapoEnv.prototype.Get_Unescaped_Cookie=function(check_name){var a_all_cookies,a_temp_cookie,cookie_name,cookie_value,b_cookie_found,cookie_regex,i;a_all_cookies=document.cookie.split(";");b_cookie_found=false;cookie_regex=/^(.*?)(=)(.*?)$/;i=a_all_cookies.length;while(i--){a_temp_cookie=a_all_cookies[i].match(cookie_regex);if(typeof a_temp_cookie!=="undefined"&&a_temp_cookie!==null){cookie_name=a_temp_cookie[1].replace(/^\s+|\s+$/g,"");if(cookie_name===check_name){b_cookie_found=true;if(a_temp_cookie[2]===
"\x3d")cookie_value=a_temp_cookie[3].replace(/^\s+|\s+$/g,"");return cookie_value}}a_temp_cookie=null;cookie_name=""}if(!b_cookie_found)return null};