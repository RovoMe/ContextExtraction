var PluckController=Backbone.Controller.extend({pluckConfig:{},pluckApp:undefined,pluckCssId:undefined,initialize:function(b){this.pluckConfig=b;if(WURFL&&WURFL.is_mobile&&WURFL.form_factor=="Smartphone"){this.pluckApp="mobile/comments";this.pluckCssId="pluck-mobile";window.pluckLoadScript(pluckAppProxy.genericBaseUrl+"Direct/JavascriptMobileSDKProxy.js");this.view=new PluckMobileView()}else{this.pluckApp="pluck/comments";this.pluckCssId="pluck-comments";this.view=new PluckDesktopView()}pluckAppProxy.registerActivityCallback("CommentsRendered",this.view.onCommentsRendered);pluckAppProxy.registerActivityCallback("CommentCreate",this.view.onCommentCreate);pluckAppProxy.registerActivityCallback("CommentsRefresh",this.view.onCommentsRefresh);var a=this;$(document).bind("loginEvent",function(){pluckAppProxy.embedApp(a.pluckApp,a.pluckConfig,{elem:a.pluckCssId})})}});var PluckView=Backbone.View.extend({initialize:function(){},render:function(){console.log("PluckView render.");return this},handleAuth:function(a){a.preventDefault();janrain.capture.ui.modal.open("signIn")},onCommentsRendered:function(){},onCommentCreate:function(){},onCommentsRefresh:function(){}});var PluckMobileView=PluckView.extend({el:$("#pluck-mobile"),events:{"click .pmobile-auth-wrap a.pmobile-primary-button":"handleAuth",},initialize:function(){},render:function(){},onCommentsRendered:function(){console.log("Pluck mobile comments rendered.");var b=$("#pluck-mobile .pmobile-auth-wrap a.pmobile-primary-button");var c=$(b)[0];var a=$(b)[1];$(c).css("display","none");$(a).html('<span class="pmobile-primary-button-text">Sign in</span>');$(a).unbind("click").bind("click",function(){janrain.capture.ui.modal.open("signIn");$("html, body").animate({scrollTop:$("#header").offset().top},100)});$(".pmobile-comments-submit-wrap textarea, .pmobile-comments-reply-textarea").attr("placeholder","Add your comment...").val("")},onCommentCreate:function(){console.log("Pluck mobile comment create");PluckService.savePluckUserId()},onCommentsRefresh:function(){console.log("Pluck mobile comments refresh")}});var PluckDesktopView=PluckView.extend({el:$("#pluck-comments"),events:{"click .pluck-login-comment-submit-button":"handleAuth"},initialize:function(){},onCommentsRendered:function(){console.log("Pluck desktop comments rendered");$(".pluck-login-comment-submit-button .pluck-primary-button-text").text("Sign in");$(".pluck-comment-input-box").attr("placeholder","Add your comment...").val("");$(".pluck-score-volume").each(function(c,f){var d=$(f);var a=$(f).closest(".pluck-comm-single-comment-top ");var e=d.attr("downvotes")!=""?d.attr("downvotes"):0;var b=d.attr("upvotes")!=""?d.attr("upvotes"):0;a.find(".pluck-thumb-down-link").text("("+e+")");a.find(".pluck-thumb-up-link").text("("+b+")")})},onCommentCreate:function(){},onCommentsRefresh:function(){console.log("Pluck desktop comments refresh");$(".pluck-score-volume").each(function(c,f){var d=$(f);var a=$(f).closest(".pluck-comm-single-comment-top ");var e=d.attr("downvotes")!=""?d.attr("downvotes"):0;var b=d.attr("upvotes")!=""?d.attr("upvotes"):0;a.find(".pluck-thumb-down-link").text("("+e+")");a.find(".pluck-thumb-up-link").text("("+b+")")})}});