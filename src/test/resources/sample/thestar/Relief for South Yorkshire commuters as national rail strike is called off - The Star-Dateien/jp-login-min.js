(function(){janrain.settings.packages=["login","capture"];janrain.settings.language="en-US";janrain.settings.tokenUrl="http://localhost/";janrain.settings.tokenAction="event";janrain.settings.borderColor="#ffffff";janrain.settings.fontFamily="Helvetica, Lucida Grande, Verdana, sans-serif";janrain.settings.width=300;janrain.settings.actionText=" ";janrain.settings.capture.redirectUri="http://"+window.location.hostname+"/reset-password";janrain.settings.capture.flowVersion="HEAD";janrain.settings.capture.registerFlow="socialRegistration";janrain.settings.capture.setProfileCookie=true;janrain.settings.capture.keepProfileCookieAfterLogout=true;janrain.settings.capture.modalCloseHtml='<span class="janrain-icon-16 janrain-icon-ex2"></span>';janrain.settings.capture.noModalBorderInlineCss=true;janrain.settings.capture.responseType="token";janrain.settings.capture.returnExperienceUserData=["displayName","email","pluckUserID","sites"];janrain.settings.capture.federate=false;function b(){janrain.ready=true}if(document.addEventListener){document.addEventListener("DOMContentLoaded",b,false)}else{window.attachEvent("onload",b)}var c=document.createElement("script");c.type="text/javascript";c.id="janrainAuthWidget";if(document.location.protocol==="https:"){c.src=httpsLoadUrl}else{c.src=httpLoadUrl}var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(c,a);if(typeof window.janrain.settings.share==="object"){var c=document.createElement("script");c.type="text/javascript";c.id="janrainWidgets";if(document.location.protocol==="https:"){c.src=httpsShareLoadUrl}else{c.src=httpShareLoadUrl}var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(c,a)}})();$.fn.equals=function(a){if(!a||this.length!=a.length){return false}for(var b=0;b<this.length;++b){if(this[b]!==a[b]){return false}}return true};$.fn.once=function(c,e){function a(h){var g=h.data("events");if(g!==undefined){return g}g=$.data(h,"events");if(g!==undefined){return g}g=$._data(h,"events");if(g!==undefined){return g}g=$._data(h[0],"events");if(g!==undefined){return g}return undefined}var d=a($(document));var b=this;var f=false;if(d[c]!=undefined){$.each(d[c],function(h,g){if(g.selector==b.selector&&g.handler.toString()==e.toString()){f=true}})}if(!f){$(document).on(c,this.selector,e)}return this};if(typeof console===undefined){console={log:function(){},info:function(){},debug:function(){}}}else{if(typeof console.log===undefined){console.log=function(){}}else{if(typeof console.info===undefined){console.info=function(){}}else{if(typeof console.debug===undefined){console.debug=function(){}}}}}function janrainCaptureWidgetOnLoad(){$.event.trigger({type:"janrainCaptureWidgetOnLoad",message:"janrainCaptureWidgetOnLoad",time:new Date()})}$(document).ready(function(){$(".capture_remove").on("click",function(){setTimeout(function(){if($("#captureDialogBuiltIn").length>=0){$("#captureDialogBuiltIn").next(".janrain_modal_closebutton").css("margin-top","-8px")}},100);$(".janrain_modal_closebutton").on("click",function(){setTimeout(function(){$(".janrain_modal_closebutton").css("margin-top","0")},100)})})});var LoginRegister=(function(){var n=null;var x="";var f="";var v="";var d="";var i="";var r=1;var j=function(){return d};var s=function(){d=""};var e=function(){return i};var o=function(){return n};var p=function(E,C,B,D,A){n=E;x=C;f=B;v=D;r=A};var c="";var a="";var w=false;var q="pending";function h(A){if(c==A){return}c=A;if(c=="returnTraditional"){if(typeof MultiSiteService.isThisYou=="undefined"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Sign In")}}else{if(c=="traditionalRegistration"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Registration")}else{if(c=="socialRegistration"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Almost Done!")}else{if(c=="forgotPassword"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Forgotten Your Password?")}else{if(c=="signIn"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Sign In")}else{if(c=="returnSocial"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Sign In")}else{if(c=="preferencesScreen"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Newsletter Preferences")}else{if(c=="newsletterPreferencesScreen"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Newsletter Preferences")}else{if(c=="registrationNewVerification"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Thank You For Registering")}else{if(c=="forgotPasswordSuccess"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Create A New Password")}else{if(c=="changePassword"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Change Password")}else{if(c=="publicProfileModal"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | My Profile")}else{if(c=="mergeAccounts"){n.applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Is This You?")}}}}}}}}}}}}}}function y(C,B,A){var D={alpha:/^[a-z]+$/i,numeric:/^(\d+)$/,numericReal:/^(\d+\.?\d*|\.\d+|\-\d+\.?\d*|\-\.\d+)$/,alphaExtended:/^[a-zA-Z\-']+$/,alphaExtendedSpaces:/^[a-zA-Z\-'\s]+$/,alphaNumeric:/^[a-z0-9]+$/i,alphaNumericExtended:/^[a-z][-a-z0-9\s_.]*[a-z0-9]$/i,email:/^([a-zA-Z0-9_.-])+@(([a-zA-Z]{1})|([a-zA-Z]{1}[a-zA-Z]{1})|([a-zA-Z]{1}[0-9]{1})|([0-9]{1}[a-zA-Z]{1})|([a-zA-Z0-9][a-zA-Z0-9-_]{1,61}[a-zA-Z0-9]))\.([a-zA-Z]{2,6}|[a-zA-Z0-9-]{2,30}\.[a-zA-Z]{2,3}|([a-zA-Z0-9-]{2,30}\.){0,6}[a-zA-Z]{2,6})$/,noWhitespace:/^\S*$/,zipCode:/^\d{5}$/,"zipCode+4":/^\d{5}(\-\d{4})?$/,phone:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,phoneInternational:/^(\d{1,4}[-. ]?)?\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,i18nAlphaNumeric:/^[^-\s^`~!@#$%^&*()_=+\[{\]}\|;:\u2018\u201c,<.>/?]+$/};if(!B||!A.format){return !0}B=A.format;if("string"===typeof B&&D[B]){B=D[B]}else{return !1}(C=B.test(C.value))||A.actions&&A.actions.format&&hc.push(A.actions.format);return C}var t=function(){janrain.events.onCaptureScreenShow.addHandler(function(G){if(G.screen==="traditionalRegistration"){if(MultiSiteService.wasUserPartiallyLoggedIn()){CookieService.removeCookie("partiallyLoggedIn");b()}MultiSiteService.clearInformation("currentFlow");MultiSiteService.clearUnnecessaryInformation()}else{if(G.screen==="returnTraditional"&&MultiSiteService.hasErrorMessages()){$("#capture_returnTraditional_userInformationForm_errorMessages").css("display","none");MultiSiteService.clearInformation("loginFailedMessage")}}if(isCoremetricsDisabled=="false"){h(G.screen)}function H(J,L,I){I.pending();var K=/^([A-Za-z0-9]+ ?)*$/;if(K.test(L)){I.valid();return true}else{I.notValid("Invalid");return false}}janrain.capture.ui.registerFunction("regex_displayName_validation",H)});function F(H,J,G){G.pending();var I=/^([A-Za-z0-9]+ ?)*$/;if(I.test(J)){G.valid();return true}else{G.notValid("Invalid");return false}}janrain.capture.ui.registerFunction("regex_displayName_validation",F);janrain.events.onCaptureProfileLink.addHandler(function(G){var H=LoginRegister.getAccessToken();JanrainUtil.forceUpdate(H)});janrain.events.onCaptureProfileUnlink.addHandler(function(G){var H=LoginRegister.getAccessToken();JanrainUtil.forceUpdate(H)});janrain.events.onCaptureLoginSuccess.addHandler(function(G){d=G.accessToken;i=G.userData.uuid;userEmail=G.userData.email;if(isCoremetricsDisabled=="false"&&!MultiSiteService.wasUserPartiallyLoggedIn()){cmCreateRegistrationTag("JP"+i,userEmail)}if(G.statusMessage=="accountsMerged"){JanrainUtil.forceUpdate(d)}if(G.action=="traditionalSignin"){if(MultiSiteService.isAfterFirstLogin()){if(MultiSiteService.currentFlow==="register"){g()}else{MultiSiteService.currentFlow="login";var H=janrain.capture.ui.getReturnExperienceData("email");var I=janrain.capture.ui.getReturnExperienceData("sites");MultiSiteService.doAlreadyRegisteredLogicForSites(H,I)}}else{g()}}else{if(G.action=="socialSignin"){janrain.capture.ui.modal.close();LoginRegister.postLoginAction()}}});janrain.events.onCaptureSessionFound.addHandler(function(G){if(MultiSiteService.wasUserPartiallyLoggedIn()){CookieService.removeCookie("partiallyLoggedIn");b()}else{d=G.accessToken;janrain.capture.ui.modal.close();console.log("Session found "+G);setTimeout(function(){n.showLogoutControls();u();PluckService.createPluckCookie(n.notifyAboutLoginStatus);n.notifyAboutLoginStatus()},0)}});janrain.events.onCaptureSessionNotFound.addHandler(function(G){console.log("Session not found");n.showLoginControls();s();PluckService.expirePluckCookie();n.notifyAboutLoginStatus();if(v!=""&&!janrain.capture.ui.hasActiveSession()){janrain.capture.ui.modal.open(v)}});janrain.events.onCaptureRegistrationSuccess.addHandler(function(G){i=G.userData.uuid;userEmail=G.userData.email;d=G.accessToken;if(isCoremetricsDisabled=="false"){cmCreateRegistrationTag("JP"+i,userEmail)}MultiSiteService.attachCurrentSiteToUser();janrain.capture.ui.modal.close();console.log("Registration succeeded");setTimeout(function(){n.showLogoutControls();PluckService.createPluckCookie(n.notifyAboutLoginStatus);u();k()},0);if(G.action=="traditionalRegister"){w=false;var I=janrainTimeoutInSeconds*1000;var H=janrain.capture.ui.getReturnExperienceData("email");m(a,H,i)}else{if(G.action=="socialRegister"){w=true}}});janrain.events.onCaptureSessionEnded.addHandler(function(G){n.showLoginControls();s();PluckService.expirePluckCookie();z();n.notifyAboutLoginStatus()});janrain.events.onCaptureProfileUnlink.addHandler(function(G){n.displayProvidersHeading()});janrain.events.onCaptureRenderStart.addHandler(function(G){if(A==true){return}if(typeof G=="undefined"||typeof G.fields=="undefined"){return}if(typeof G.fields.traditionalSignIn!="undefined"&&typeof G.fields.traditionalSignIn_emailAddress!="undefined"){G.fields.traditionalSignIn_emailAddress.value=""}if(typeof G.fields.traditionalRegistration_jpCommsOptIn!="undefined"&&!G.fields.traditionalRegistration_jpCommsOptIn.checked){G.fields.traditionalRegistration_jpCommsOptIn.checked=true}if(typeof G.fields.traditionalRegistration_firstName!="undefined"&&G.fields.traditionalRegistration_firstName.value.length>0){G.fields.traditionalRegistration_firstName.value=""}if(typeof G.fields.traditionalRegistration_lastName!="undefined"&&G.fields.traditionalRegistration_lastName.value.length>0){G.fields.traditionalRegistration_lastName.value=""}if(typeof G.fields.traditionalRegistration_emailAddress!="undefined"&&G.fields.traditionalRegistration_emailAddress.value.length>0){G.fields.traditionalRegistration_emailAddress.value=""}if(typeof G.fields.traditionalRegistration_displayName!="undefined"&&G.fields.traditionalRegistration_displayName.value.length>0){G.fields.traditionalRegistration_displayName.value=""}});var B="";janrain.events.onCaptureRenderComplete.addHandler(function(G){A=false;if(G.screen=="editProfile"){var I=janrain.capture.ui.getReturnExperienceData("email");var J=LoginRegister.getAccessToken();ProfileManagementLogic.displayEmailVerificationLink(I,J);if($("#capture_editProfile_name_firstname").length!=0){ProfileManagementLogic.firstName=$("#capture_editProfile_name_firstname").attr("value")}}B=G.screen;if(B=="returnTraditional"){$(".capture_right .capture_btn").on("click",function(){setTimeout(function(){$(".capture_form_item").each(function(){var L=$(this);if($(".capture_tip_error").css("display")!="none"){$(this).addClass("capture_error")}})},1500)});if(MultiSiteService.loginFailed()){MultiSiteService.loginFailedMessage=true;MultiSiteService.clearInformation("loginFailNotification");var I;if(MultiSiteService.currentFlow&&MultiSiteService.currentFlow=="register"){I=MultiSiteService.registrationEmail}else{I=janrain.capture.ui.getReturnExperienceData("email")}n.updateWithAlreadyRegisteredMessage(I,MultiSiteService.attachedSiteName,MultiSiteService.alreadyRegisteredSiteName)}else{n.onReturnTraditional()}}else{if(B=="traditionalRegistration"){n.onTraditionalRegistration();janrain.capture.ui.setValidator("isValidFormat",y);$(".capture_tip").css("display","none");$("#capture_traditionalRegistration_traditionalRegistration_emailAddress").attr("placeholder","Email address");$("#capture_traditionalRegistration_traditionalRegistration_passwordConfirm").attr("placeholder","Confirm password");$("<p>A name to use on this site</p>").insertAfter("#capture_traditionalRegistration_traditionalRegistration_displayName")}else{if(B=="socialRegistration"){n.onSocialRegistration();$("#socialRegistration .jrLeft label").css("display","none")}else{if(B=="forgotPassword"){n.onForgotPassword();$("#capture_forgotPassword_forgotPassword_sendButton").attr("value","Reset My Password")}else{if(B=="signIn"){n.onSignIn()}else{if(B=="returnSocial"){n.onReturnSocial()}else{if(B=="editProfile"){if(G.renderingBuiltInScreen==false){setTimeout(function(){ProfileManagementLogic.init()},300)}n.onEditProfile()}else{if(B=="preferencesScreen"){UserPreferencesLogic.getNewsletterPreferences(d,n.populatePreferencesScreen)}else{if(B=="newsletterPreferencesScreen"){ProfileManagementLogic.init();UserPreferencesLogic.getCheckedNewsletterPreferences(d).done(function(L){if(L.stat==="ok"){UserPreferencesLogic.populateProfilePreferencesScreen(L.result.sites)}else{console.log("Failed to retrieve preferences from Janrain.");if(L.error_description=="unknown access token"){janrain.capture.ui.endCaptureSession()}}})}else{if(B=="registrationNewVerification"){var K=janrain.capture.ui.getReturnExperienceData("displayName");var I=janrain.capture.ui.getReturnExperienceData("email");n.onRegistrationNewVerification(K,I,w,q)}else{if(B=="resetPassword"){$("#capture_resetPassword_form_item_newpassword label").text("").hide();$("#capture_resetPassword_form_item_newpassword .capture_tip").text("").hide();$("#capture_resetPassword_form_item_newpasswordConfirm label").text("").hide();$("#capture_resetPassword_form_item_newpasswordConfirm .capture_tip").text("").hide();$("#capture_resetPassword_newpassword").attr("placeholder","Password (6 characters min)");$("#capture_resetPassword_newpasswordConfirm").attr("placeholder","Confirm Password");$("#capture_resetPassword_capture_submit").click(function(L){if($("#capture_resetPassword_newpasswordConfirm").val()!=$("#capture_resetPassword_newpassword").val()){L.preventDefault();$("#capture_resetPassword_form_item_newpasswordConfirm").addClass("capture_error");$("#capture_resetPassword_form_item_newpasswordConfirm .capture_tip_error").text("Oops, looks like you entered something incorrectly. Please try again.")}});if(!Modernizr.input.placeholder){$("input, textarea").placeholder()}}else{if(B=="verifyEmailSuccess"){var H=window.location.search.replace("?","").split("=")[1];if(H=="verifyEmailError"){$("#verifyEmailSuccessMessage").css({display:"none"});if(!janrain.capture.ui.hasActiveSession()){$("#verifyEmailErrorMessage").css({display:"inline-block"})}else{$("#verifyEmailSignedInErrorMessage").css({display:"inline-block"})}}if(!janrain.capture.ui.hasActiveSession()){$("#verifyEmailSuccess .capture_closeButton").css({display:"none"});$("#verifyEmailSuccess .capture_signInButton").css({display:"inline-block"})}}else{if(B=="publicProfileModal"){$("label[for=capture_publicProfileModal_memberSince]").text("Member since:")}}}}}}}}}}}}}});janrain.events.onModalOpen.addHandler(function(){if(!jQuery.browser.mobile){if($(window).width()<=1024){setTimeout(function(){var H=$("#janrainModal").offset().left-100;var G=$("#janrainModal").offset().top-100;window.scrollTo(H,G)},300)}}else{$(".capture_col_4 a, #subscribeSubmitButton").click(function(){$("#janrainModal").css("display","none");$("html,body").animate({scrollTop:0},"slow")})}});janrain.events.onModalClose.addHandler(function(){if(B=="preferencesScreen"){MultiSiteService.clearInformation("attachedSiteName")}else{if(MultiSiteService.flowIsActive()){if(MultiSiteService.wasUserPartiallyLoggedIn()){CookieService.removeCookie("partiallyLoggedIn");b()}MultiSiteService.clearInformation("currentFlow");MultiSiteService.clearUnnecessaryInformation()}}MultiSiteService.clearInformation("loginFailNotification");MultiSiteService.clearInformation("loginFailedMessage");B="";c=""});janrain.events.onCaptureContentChange.addHandler(function(){var G=$("#janrainEngageEmbed").has("#janrainAuthReturnExperience").length==0;if(G||B==""){return}if(B=="returnTraditional"){$("#returnTraditional .switchLink").show()}else{if(B=="returnSocial"){$("#returnSocial .switchLink").show()}else{if(B=="signIn"){$("#signIn .switchLink").show();$("#signInSwitchAccounts").click(function(){$(".janrainSwitchAccountLink").click()})}}}});var C=false;janrain.events.onCaptureControlSuccess.addHandler(function(G){if((typeof G!="undefined"&&typeof G.controlName!="undefined")&&G.controlName=="resendVerificationEmail"){C=true}});janrain.events.onCaptureProfileSaveSuccess.addHandler(function(G){if(typeof G!="undefined"&&typeof G.userData!="undefined"&&typeof G.userData.givenName!="undefined"){ProfileManagementLogic.firstName=G.userData.givenName;n.setLoginName(janrain.capture.ui.getReturnExperienceData("displayName"));PluckService.createPluckCookie(n.notifyAboutLoginStatus)}});var D=false,A=false;janrain.events.onCaptureSaveFailed.addHandler(function(G){if(G.status=="error"){if(G.statusMessage=="invalidCredentials"){D=true}else{if(G.statusMessage=="invalidAccessToken"){janrain.capture.ui.endCaptureSession()}else{if(G.screen==="traditionalRegistration"&&G.statusMessage==="validationErrors"){A=true}else{if(G.statusMessage=="invalidIdentifier"||G.statusMessage=="invalidInput"||G.statusMessage=="invalidAccountIdentifier"){A=true}}}}}});janrain.events.onCaptureError.addHandler(function(G){if(G.status=="error"&&G.statusMessage=="invalidAccessToken"){janrain.capture.ui.endCaptureSession()}});janrain.events.onCaptureFormError.addHandler(function(G){if(D==false){G.invalidCredentials=""}if(A!=true){G.invalidIdentifier=""}});janrain.events.onModalClose.addHandler(function(G){D=false});janrain.events.onCaptureValidationFailed.addHandler(function(G){if(B=="returnTraditional"){$(G.field).parent().find(".capture_tip_error").text(G.message).show()}if(G.message==="Email address is already being used."){MultiSiteService.currentFlow="register";var H=$("#capture_traditionalRegistration_traditionalRegistration_emailAddress").attr("value");MultiSiteService.registrationEmail=H;MultiSiteService.getUserAssociatedSites(H,MultiSiteService.alreadyRegisteredLogic)}});janrain.events.onCaptureServerValidationFailed.addHandler(function(G){});janrain.events.onCaptureValidationSuccess.addHandler(function(G){$(".janrain-capture-ui .capture_form_error").parent().empty();if(G.field.name==="traditionalRegistration_firstName"){a=G.field.value}});janrain.events.onCaptureLoginFailed.addHandler(function(G){MultiSiteService.loginFailNotification=true});for(var E in janrain.events){if(typeof janrain.events[E].addHandler==="function"){janrain.events[E].addHandler(function(G){return function(H){console.log(G,H)}})}}};function m(D,A,C,F){var E=(janrainTimeoutInSeconds+1)*1000;var B=LoginRegister.getAccessToken();if(B){jQuery.ajax({type:"GET",url:"/ajax?action=sendWelcomeEmail&siteKey="+encodeURIComponent(siteKey)+"&firstName="+encodeURIComponent(D)+"&emailAddress="+encodeURIComponent(A)+"&userId="+encodeURIComponent(C)+"&siteStyle="+encodeURIComponent(r)+"&token="+encodeURIComponent(B),contentType:"text/plain; charset=utf-8",dataType:"json",timeout:E}).done(function(G){if(G){q="ok"}else{q="failed"}if(G===false){if(F){$("#profileEmailSentConfirmation").css("display","none");$("#profileEmailSentFailed").css("display","block");$("#profileEmailSent").lightbox_me({centered:true,closeSelector:"#emailSentCloseButton",overlayCSS:{background:"#000",opacity:0.4,position:"fixed"},closeClick:false,closeEsc:false,onLoad:function(){$("#profileEmailSent").show()}})}}else{if(F){$("#profileEmailSentConfirmation").css("display","block");$("#profileEmailSentFailed").css("display","none");$("#profileEmailSent").lightbox_me({centered:true,closeSelector:"#emailSentCloseButton",overlayCSS:{background:"#000",opacity:0.4,position:"fixed"},closeClick:false,closeEsc:false,onLoad:function(){$("#profileEmailSent #confirmationTo").html(A);$("#profileEmailSent").show()}})}}})}}function l(){setTimeout(function(){n.showLogoutControls();PluckService.createPluckCookie(n.notifyAboutLoginStatus);k()},0)}function g(){l();MultiSiteService.attachCurrentSiteToUser();janrain.capture.ui.modal.open("preferencesScreen");MultiSiteService.clearInformation("currentFlow");MultiSiteService.clearInformation("alreadyRegisteredSiteName");MultiSiteService.clearInformation("loginFailedMessage");if(MultiSiteService.wasUserPartiallyLoggedIn()){CookieService.removeCookie("partiallyLoggedIn")}}function k(){if(x=="profile"){window.location.reload()}}function z(){if(x=="profile"){window.location.replace("/")}}function u(){if(f!=""){window.location.replace(f)}}function b(){n.logoutUser()}return{initVariables:p,initJanrainEventHandlers:t,getAccessToken:j,getViewRef:o,getUserId:e,postLoginAction:l,sendWelcomeEmail:m}})();var PluckService={createPluckCookie:function(a){var d=LoginRegister.getAccessToken();var b=janrain.capture.ui.getReturnExperienceData("displayName");var c=janrain.capture.ui.getReturnExperienceData("email");var e=janrain.capture.ui.getReturnExperienceData("pluckUserID");if(e==null||e=="null"){e=""}jQuery.ajax({type:"GET",url:"/ajax?action=getPluckCookieValue&userId="+encodeURIComponent(e)+"&displayName="+encodeURIComponent(b)+"&email="+encodeURIComponent(c)+"&noEOL=true",data:"",contentType:"text/plain; charset=utf-8",dataType:"text"}).done(function(f){CookieService.setCookie("at",f,0);PluckService.savePluckUserId()}).always(function(){a()})},expirePluckCookie:function(){CookieService.removeCookie("at")},savePluckUserId:function(){var c=janrain.capture.ui.getReturnExperienceData("email");var b=LoginRegister.getAccessToken();var d=janrain.capture.ui.getReturnExperienceData("pluckUserID");if(d){return}d=PluckService.extractPluckIDFromCookie();if(d){var a=function(){var e=localStorage.getItem("janrainCaptureReturnExperienceData");if(e){e=JSON.parse(e);e.pluckUserID=d;localStorage.setItem("janrainCaptureReturnExperienceData",JSON.stringify(e))}};JanrainUtil.savePluckUserId(c,b,d,a)}},extractPluckIDFromCookie:function(){var c=CookieService.getCookie("at");var b=c.split("&");for(var a=0;a<b.length;a++){if(b[a].substring(0,2)=="u="){return b[a].substring(2)}}}};var JanrainUtil={regexPostcodeUK:/^[A-Z]{1,2}[0-9]{1,2}[A-Z]* ?[0-9][A-Z]{2}$/i,showScreen:function(c){var a=document.getElementById(c);var b=document.getElementById("janrainModal");b.innerHTML="";b.appendChild(a);b.style.display="";a.style.display="";document.getElementById("janrainModalOverlay").style.display=""},hideScreen:function(c){var a=document.getElementById(c);var b=document.getElementById("janrainModal");b.innerHTML="";b.style.display="none";a.style.display="none";document.getElementById("janrainModalOverlay").style.display="none"},saveNewsletterOptions:function(b,d){var e={};if(typeof ProfileManagementLogic&&typeof ProfileManagementLogic.allSitesPref!="undefined"){e=ProfileManagementLogic.allSitesPref}e=e.concat(d);e=JSON.stringify(e);var a=janrain.capture.ui.getReturnExperienceData("email");var c=JSON.parse(localStorage.getItem("janrainCaptureProfileData")).uuid;jQuery.ajax({type:"POST",url:"/ajax?action=saveNewsletterOptions&uuid="+c+"&email="+encodeURIComponent(a)+"&token="+b+"&sites="+encodeURIComponent(e)+"&noEOL=true",data:"",contentType:"text/plain; charset=utf-8",dataType:"json"}).done(function(f){if(f.stat==="ok"){JanrainUtil.forceUpdate(b)}else{console.log("Failed to save newsletter preferences");if(f.error_description=="unknown access token"){janrain.capture.ui.endCaptureSession()}}}).fail(function(f,h,g){console.log("Failed to save newsletter preferences: "+h)})},savePluckUserId:function(c,b,e,a){var d=JSON.parse(localStorage.getItem("janrainCaptureProfileData")).uuid;jQuery.ajax({type:"POST",url:"/ajax?action=savePluckUserId&uuid="+d+"&email="+encodeURIComponent(c)+"&token="+b+"&pluckUserID="+encodeURIComponent(e)+"&noEOL=true",data:"",contentType:"text/plain; charset=utf-8",dataType:"json"}).done(function(f){if(f.stat==="ok"){if(a){a()}}else{console.log("Failed to save pluckUserID: "+f.error+", "+f.error_description)}}).fail(function(f,h,g){console.log("Failed to save pluckUserID: "+h)})},savePrimaryAddress:function(c,b,a){var d=JSON.parse(localStorage.getItem("janrainCaptureProfileData")).uuid;jQuery.ajax({type:"POST",url:"/ajax?action=savePrimaryAddress&uuid="+d+"&email="+encodeURIComponent(c)+"&token="+b+"&postcode="+encodeURIComponent(a)+"&noEOL=true",data:"",contentType:"text/plain; charset=utf-8",dataType:"json"}).done(function(e){if(e.stat==="ok"){JanrainUtil.forceUpdate(b)}else{console.log("Failed to save post code");console.log("error: "+e.error+" error desc: "+e.error_description)}}).fail(function(e,g,f){console.log("Failed to save post code: "+g)})},forceUpdate:function(b){var a=janrain.capture.ui.getReturnExperienceData("email");var c=JSON.parse(localStorage.getItem("janrainCaptureProfileData")).uuid;jQuery.ajax({type:"POST",url:"/ajax?action=forceUpdateUser&uuid="+c+"&email="+encodeURIComponent(a)+"&token="+b+"&noEOL=true",data:"",contentType:"text/plain; charset=utf-8",dataType:"json"}).done(function(d){if(d.stat==="ok"){}else{console.log("Failed to force update");console.log("error: "+d.error+" error desc: "+d.error_description)}}).fail(function(d,f,e){console.log("Failed to force update: "+f)})},removeIdFromNewsletterPref:function(d){for(var c=0;c<d.length;c++){delete d[c]["id"];for(var b=0;b<d[c].newsletters.length;b++){delete d[c].newsletters[b]["id"];for(var a=0;a<d[c].newsletters[b].preferences.length;a++){delete d[c].newsletters[b].preferences[a]["id"]}}}return d}};var UserPreferencesLogic={getNewsletterPreferences:function(a,b){UserPreferencesLogic.addPreferencesLiveValidation();jQuery.ajax({type:"GET",url:"/ajax?action=getNewsletterPref&siteKey="+encodeURIComponent(siteKey),data:"",async:false,contentType:"text/plain; charset=utf-8",dataType:"text",success:function(d){var c=JSON.parse(d);if(c&&c.newsletters){b(c.newsletters)}}})},addPreferencesLiveValidation:function(){$("#pref_postcode").live("change",function(b){var a=$(b.target);if(!JanrainUtil.regexPostcodeUK.test(a.val())&&a.val()!=""){a.parent().addClass("capture_error").removeClass("capture_validated");a.next(".capture_tip_error").show()}else{if(a.val()!=""){a.parent().addClass("capture_validated")}else{a.parent().removeClass("capture_validated")}a.parent().removeClass("capture_error");a.next(".capture_tip_error").hide()}})},updatePreferences:function(){var a=LoginRegister.getAccessToken();UserPreferencesLogic.getCheckedNewsletterPreferences(a).done(function(h){if(h.stat==="ok"){var c=[];var g=h.result.sites;for(var f=0;f<g.length;f++){if(h.result.sites[f].code.toLowerCase()===siteKey.toLowerCase()){c=g[f].newsletters;g.splice(f,1)}}ProfileManagementLogic.allSitesPref=JanrainUtil.removeIdFromNewsletterPref(g);var j=LoginRegister.getViewRef().getCheckedPreferences();var e=$("#pref_postcode").attr("value");if(JanrainUtil.regexPostcodeUK.test(e)||e==""){var b=(typeof j!="undefined")&&(typeof j[0]!="undefined")&&(typeof j[0].newsletters!="undefined")&&(j[0].newsletters.length!=0);if(b){JanrainUtil.saveNewsletterOptions(a,j)}var d=janrain.capture.ui.getReturnExperienceData("email");JanrainUtil.savePrimaryAddress(d,a,e);JanrainUtil.hideScreen("preferencesScreen");MultiSiteService.displayThankYouForRegisteringScreen()}else{console.log("Failed to validate postcode.")}}}).fail(function(b,d,c){console.log("Failed to retrieve preferences from Janrain. ");console.log("Reason: "+d)})},getCheckedNewsletterPreferences:function(a){var b=janrainTimeoutInSeconds*1000;return jQuery.ajax({type:"GET",url:captureServer+"/entity?jsonp=?&type_name=user",data:{access_token:a,attributes:'["sites"]'},contentType:"text/plain; charset=utf-8",dataType:"json",timeout:b})},populateProfilePreferencesScreen:function(g){var b=[];for(var d=0;d<g.length;d++){if(g[d].code.toLowerCase()===siteKey.toLowerCase()){b=g[d].newsletters;g.splice(d,1)}}ProfileManagementLogic.allSitesPref=JanrainUtil.removeIdFromNewsletterPref(g);var f=[];var e=0;for(var d=0;d<b.length;d++){var a=b[d].preferences;for(var c=0;c<a.length;c++){f[e]=a[c].code;e++}}for(var d=0;d<f.length;d++){$("#newsletter-pref-content input:checkbox[name='"+f[d]+"']").attr("checked",true)}}};var ProfileManagementLogic={init:function(){$("#saveNewsletterOptions").once("click",function(b){if(b.handled!==true){var c=LoginRegister.getViewRef().getCheckedPreferences();var a=LoginRegister.getAccessToken();JanrainUtil.saveNewsletterOptions(a,c);janrain.capture.ui.modal.close();b.handled=true}return false});$("#editProfile").once("click",function(a){accessToken=localStorage.getItem("janrainCaptureToken");if(accessToken==""||accessToken==null){janrain.capture.ui.endCaptureSession()}});$("#logoutBtn").once("click",function(){$("#capture_editProfile_saveButton").attr("disabled","disabled")});if($("#capture_editProfile_addressCountry").val()=="United Kingdom"){ProfileManagementLogic.validatePostalcode(true);$("#capture_editProfile_addressPostalCode").once("blur",ProfileManagementLogic.validatePostalcode)}$("#capture_editProfile_addressCountry").once("change",function(){if($("#capture_editProfile_addressCountry").val()=="United Kingdom"){ProfileManagementLogic.validatePostalcode(true);$("#capture_editProfile_addressPostalCode").on("blur",ProfileManagementLogic.validatePostalcode);$("#capture_editProfile_saveButton").removeAttr("disabled")}else{ProfileManagementLogic.validatePostalcode(false);$("#capture_editProfile_addressPostalCode").off("blur",ProfileManagementLogic.validatePostalcode)}});if($("#capture_editProfile_addressCountry").val()=="United Kingdom"){$("#capture_editProfile_addressPostalCode").once("keyup",function(){$("#capture_editProfile_saveButton").removeAttr("disabled")});$("#capture_editProfile_addressPostalCode").once("focus",function(){$("#capture_editProfile_saveButton").removeAttr("disabled")})}$("#capture_editProfile_upload_photo_link").once("click",function(){LoginRegister.getViewRef().applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Profile Photo")});$("#capture_editProfile_edit_photo_link").once("click",function(){LoginRegister.getViewRef().applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Profile Photo")});$("#capture_editProfile_resendLink").once("click",function(d){d.preventDefault();d.stopPropagation();var b=janrain.capture.ui.getReturnExperienceData("email");var c="";try{c=JSON.parse(localStorage.getItem("janrainCaptureProfileData")).uuid;LoginRegister.sendWelcomeEmail(ProfileManagementLogic.firstName,b,c,true)}catch(a){console.log("JSON parse error "+a.message)}});$("#capture_editProfile_editProfileForm input").focus(function(){var b=$("#capture_editProfile_editProfileForm");var a=$("#capture_editProfile_saveButton");if(b.find(".capture_error").length<1){$("#capture_editProfile_saveButton").removeAttr("disabled")}});$("#capture_editProfile_saveButton").once("click",ProfileManagementLogic.onFormSubmission);$("#capture_editProfile_saveButton").on("click",function(){if(profileForm.find(".capture_error").length>0){$(".capture_save_success").css("display","none")}})},validatePostalcode:function(c){var a=$("#capture_editProfile_addressPostalCode");var b=a.parent();var e=$("#capture_editProfile_editProfileForm");var d=$("#capture_editProfile_saveButton");if(a.val()==""){}else{if($("#capture_editProfile_addressCountry").val()=="United Kingdom"&&!JanrainUtil.regexPostcodeUK.test(a.val())){if(c){b.addClass("capture_error")}b.removeClass("capture_validated");b.find(".capture_tip_error").text("Please provide a valid UK postcode.").show()}else{if(c){b.addClass("capture_validated")}b.removeClass("capture_error");b.find(".capture_tip_error").hide().text("")}}ProfileManagementLogic.updateFormSubmission()},updateFormSubmission:function(){var b=$("#capture_editProfile_editProfileForm");var a=$("#capture_editProfile_saveButton");if(b.find(".capture_error").length>0){a.attr("disabled","disabled")}else{a.removeAttr("disabled")}},onFormSubmission:function(b){var a=$("#capture_editProfile_editProfileForm");a.find(".capture_save_success").css("display","none");ProfileManagementLogic.validatePostalcode(true);if(a.find(".capture_error").length>0){b.preventDefault();b.stopImmediatePropagation();return false}return true},getActivationStatus:function(a,b){var c=janrainTimeoutInSeconds*1000;return jQuery.ajax({type:"GET",url:"/ajax?action=getActivationStatus&email="+encodeURIComponent(a)+"&token="+encodeURIComponent(b),contentType:"text/plain; charset=utf-8",dataType:"json",timeout:c})},displayEmailVerificationLink:function(a,b){ProfileManagementLogic.getActivationStatus(a,b).done(function(c){if(c==null){console.log("Could not get the activation status.");$("#capture_editProfile_resendLink").css("display","none")}else{if(c==false){$("#capture_editProfile_resendLink").css("display","block")}else{if(c==true){$("#capture_editProfile_resendLink").css("display","none")}}}}).fail(function(c,d){console.log("Failed to retrieve the activation status. Cause: "+d)})}};var CookieService={setCookie:function(d,c,b){var a="."+location.host.replace("www.","").replace("m.","");jQuery.cookie(d,c,{expires:b,path:"/",domain:a})},getCookie:function(a){return jQuery.cookie(a)},removeCookie:function(a){if(this.getCookie(a)!=null){this.setCookie(a,null,-5)}}};var MultiSiteService={isAfterFirstLogin:function(){return(CookieService.getCookie("partiallyLoggedIn")==null)},wasUserPartiallyLoggedIn:function(){return(CookieService.getCookie("partiallyLoggedIn")!=null)},attachCurrentSiteToUser:function(){var d=LoginRegister.getAccessToken();var b=janrain.capture.ui.getReturnExperienceData("sites");var f=JanrainUtil.removeIdFromNewsletterPref(b);var a={};a.code=siteKey;var g=f.concat(a);g=JSON.stringify(g);var c=janrain.capture.ui.getReturnExperienceData("email");var e=JSON.parse(localStorage.getItem("janrainCaptureProfileData")).uuid;jQuery.ajax({type:"POST",url:"/ajax?action=saveNewsletterOptions&uuid="+e+"&email="+encodeURIComponent(c)+"&token="+d+"&sites="+encodeURIComponent(g),data:"",contentType:"text/plain; charset=utf-8",dataType:"json"}).done(function(h){if(h.stat==="ok"){JanrainUtil.forceUpdate(d)}else{console.log("Failed to attach current site to the user");console.log("Reason: "+h.error_description)}}).fail(function(h,j,i){console.log("Failed to attach current site to the user");console.log("Reason: "+j)})},getUserAssociatedSites:function(b,a){var c=(janrainTimeoutInSeconds+1)*1000;jQuery.ajax({type:"GET",url:"/ajax?action=getAssociatedSites&email="+encodeURIComponent(b),async:true,contentType:"text/plain; charset=utf-8",dataType:"json",timout:c,success:function(d){if(d==null){console.log("Failed to retrieve the user associated sites.");if(MultiSiteService.currentFlow!="register"){janrain.capture.ui.modal.close();LoginRegister.postLoginAction()}}else{if(d.stat=="ok"){MultiSiteService.doAlreadyRegisteredLogicForSites(b,d.results[0].sites)}else{janrain.capture.ui.modal.close();LoginRegister.postLoginAction()}}},error:function(d,f,e){console.log("Failed to retrieve the user associated sites.");console.log("Reason:"+f);console.log(e)}})},doAlreadyRegisteredLogicForSites:function(a,d){var c=new Array();for(var b=0;b<d.length;b++){c.push(d[b].code)}MultiSiteService.alreadyRegisteredLogic(a,c)},alreadyRegisteredLogic:function(b,e){if(e.length>0){var c=$.map(e,function(g,f){return g.toLowerCase()});var a=siteKey.toLowerCase();var d=($.inArray(a,c)>-1);if(d){if(MultiSiteService.currentFlow==="login"){janrain.capture.ui.modal.close();LoginRegister.postLoginAction()}MultiSiteService.clearInformation("currentFlow")}else{MultiSiteService.displayAlreadyRegisteredScreen(b,e)}}else{if(MultiSiteService.currentFlow==="login"){MultiSiteService.attachCurrentSiteToUser();LoginRegister.postLoginAction();janrain.capture.ui.modal.close()}MultiSiteService.clearInformation("currentFlow")}},displayAlreadyRegisteredScreen:function(a,d){var b=d[d.length-1];var c=new Array();c.push(siteKey);c.push(b);MultiSiteService.getSiteNames(c).done(function(e){var f=e[siteKey];var g=e[b];MultiSiteService.isThisYou=true;LoginRegister.getViewRef().displayAlreadyRegisteredScreen(a,f,g);if(isCoremetricsDisabled=="false"){LoginRegister.getViewRef().applyCoremetricsPageViewTag(wtSiteCode.toUpperCase()+" | Is This You?")}MultiSiteService.attachedSiteName=f;MultiSiteService.alreadyRegisteredSiteName=g;MultiSiteService.clearInformation("loginFailNotification");if(MultiSiteService.currentFlow==="login"){CookieService.setCookie("partiallyLoggedIn","yes",1)}else{if(MultiSiteService.currentFlow==="register"){$("#capture_returnTraditional_userInformationForm_errorMessages").empty()}}}).fail(function(e,f){console.log("Failed to retrieve the site names. Cause: "+f);if(MultiSiteService.currentFlow!="register"){janrain.capture.ui.modal.close();LoginRegister.postLoginAction()}})},getSiteNames:function(b){var a=(sisTimeoutInSeconds+1)*1000;return jQuery.ajax({type:"GET",url:"/ajax?action=getSiteNames&siteCodes="+encodeURIComponent(b.toString()),contentType:"text/plain; charset=utf-8",dataType:"json",timeout:a})},displayThankYouForRegisteringScreen:function(){janrain.capture.ui.modal.open("registrationNewVerification");if(MultiSiteService.siteWasAttachedToUser()){$("#registrationNewVerification .capture_header h1").text("You are now connected");var a=janrain.capture.ui.getReturnExperienceData("email");var b=MultiSiteService.attachedSiteName;$("#registrationNewVerification .cbg_hint p").text(a+" is now connected with "+b+".");MultiSiteService.clearInformation("attachedSiteName")}},clearUnnecessaryInformation:function(){MultiSiteService.clearInformation("attachedSiteName");MultiSiteService.clearInformation("alreadyRegisteredSiteName")},loginFailedFromRegisterFlow:function(){return MultiSiteService.loginFailNotification&&MultiSiteService.siteWasAttachedToUser()},loginFailed:function(){return(MultiSiteService.wasUserPartiallyLoggedIn()||MultiSiteService.loginFailedFromRegisterFlow())},hasErrorMessages:function(){return MultiSiteService.loginFailedMessage&&(typeof MultiSiteService.currentFlow==="undefined")},siteWasAttachedToUser:function(){return(typeof MultiSiteService.attachedSiteName!=="undefined")},clearInformation:function(a){delete MultiSiteService[a]},flowIsActive:function(){return typeof MultiSiteService.currentFlow!=="undefined"},showProperties:function(){console.log("MultiSiteService.currentFlow= "+MultiSiteService.currentFlow);console.log("MultiSiteService.attachedSiteName= "+MultiSiteService.attachedSiteName);console.log("MultiSiteService.alreadyRegisteredSiteName= "+MultiSiteService.alreadyRegisteredSiteName);console.log("MultiSiteService.loginFailedMessage= "+MultiSiteService.loginFailedMessage);console.log("MultiSiteService.loginFailNotification= "+MultiSiteService.loginFailNotification)}};function LoginRegisterView(a){this.applyCoremetricsPageViewTag=function(d){if(isCoremetricsDisabled=="false"){cmCreatePageviewTag(d,"DESK")}};this.onReturnTraditional=function(){c();b("#returnTraditionalCarousel");document.getElementById("capture_returnTraditional_traditionalSignIn_createButton").innerHTML="No account yet? Register now."};this.onTraditionalRegistration=function(){document.getElementById("capture_traditionalRegistration_createAccountButton").value="Create my account"};this.onSocialRegistration=function(){document.getElementById("capture_socialRegistration_createAccountButton").value="Create my account"};this.onForgotPassword=function(){};this.onSignIn=function(){b("#signInCarousel");document.getElementById("capture_signIn_traditionalSignIn_createButton").innerHTML="No account yet? Register now."};this.onReturnSocial=function(){b("#returnSocialCarousel");document.getElementById("capture_returnSocial_traditionalSignIn_createButton").innerHTML="No account yet? Register now."};this.onEditProfile=function(){$("#capture_editProfile_email").attr("readonly",true);this.displayProvidersHeading()};this.showLoginControls=function(){$("#loginRegisterPanel").removeClass("hidden");$(".register").removeClass("hidden");$("#profileLogoutPanel").addClass("hidden");$("#subscribeNLWidgetLoggedIn").addClass("hidden");$("#subscribeNLWidgetLoggedOut").removeClass("hidden")};this.hideLogoutControls=function(){$("#profileLogoutPanel").addClass("hidden");$("#loginRegisterPanel").removeClass("hidden");$(".register").removeClass("hidden");$("#subscribeNLWidgetLoggedOut").removeClass("hidden");$("#subscribeNLWidgetLoggedIn").addClass("hidden")};this.showLogoutControls=function(){$("#profileLogoutPanel").removeClass("hidden");$("#loginRegisterPanel").addClass("hidden");$(".register").addClass("hidden");this.setLoginName(janrain.capture.ui.getReturnExperienceData("displayName"));$("#subscribeNLWidgetLoggedOut").addClass("hidden");$("#subscribeNLWidgetLoggedIn").removeClass("hidden")};this.notifyAboutLoginStatus=function(){$(document).trigger("loginEvent")};this.setLoginName=function(d){$("#username").text(d)};this.populatePreferencesScreen=function(h){var l=h.dailyNewsletters;var p=l.newsletterOptions;var r=p.length;if(r!=0){var j=l.description;$("#preferencesScreen #dailyDescription").text(j);var d="";for(var k=0;k<p.length;k++){var s=p[k];var e=s.encodingName;d+='<li><input type="checkbox" name="'+e+'" value="'+e+'"';if(s.selectedByDefault===true){d+=" checked "}d+="><label>"+s.name+"</label></li>"}$("#dailyNewslettersContainer").attr("style","");$("#dailyNewsletters").append(d)}var f=h.additionalNewsletters;var m=f.newsletterOptions;var o=m.length;if(o!=0){var q=f.description;$("#preferencesScreen #additionalDescription").text(q);var n="";for(var k=0;k<o;k++){var g=m[k];var e=g.encodingName;n+='<li><input type="checkbox" name="'+e+'" value="'+e+'"';if(g.selectedByDefault===true){n+=" checked "}n+="><label>"+g.name+"</label></li>"}$("#additionalNewslettersContainer").attr("style","");$("#additionalOptions").append(n)}};this.getCheckedPreferences=function(){var f=[];var e=0;$("#dailyNewsletters input[type=checkbox]").each(function(){if($(this).is(":checked")){f[e]={code:$(this).attr("name")};e++}});var g=[];var e=0;$("#additionalOptions input[type=checkbox]").each(function(){if($(this).is(":checked")){var h=$(this).attr("name");g[e]={name:h,preferences:[{code:h}]};e++}});var d;if(f.length===0){d=g}else{d=g.concat({name:"daily",preferences:f})}return[{code:siteKey,newsletters:d}]};this.onRegistrationNewVerification=function(g,d,e,f){document.getElementById("registeredUsername").innerHTML=g;if(e||f==="pending"){$("#confirmation").css("display","none")}else{$("#confirmation").css("display","block");if(f==="ok"){document.getElementById("registeredEmail").innerHTML=d}else{$("#emailSentConfirmation").text("We are unable to process your request at this time. Please try again later")}}};this.displayProvidersHeading=function(){var d=$("#capture_editProfile_linkedAccounts_linkedproviderlist .capture_provider_linked").length;(d==0)?$("#linkedAccountsHeading").addClass("hidden"):$("#linkedAccountsHeading").removeClass("hidden")};function c(){var e=document.getElementById("traditionalWelcomeName");var d=janrain.capture.ui.getReturnExperienceData("displayName");if(e&&d){e.innerHTML="Welcome back, "+d+"!"}}this.displayAlreadyRegisteredScreen=function(e,d,f){janrain.capture.ui.modal.open("returnTraditional");this.updateWithAlreadyRegisteredMessage(e,d,f)};this.updateWithAlreadyRegisteredMessage=function(e,d,f){$("#returnTraditional .capture_header h1").text("Is this you?");$("#returnTraditional #returnTraditionalCarousel").css("display","none");$("#returnTraditional .cbg_hint").append($("<p> It looks like you're already registered. </p>"));$("#returnTraditional .cbg_hint").removeClass("sign-in-carousel");$("#capture_returnTraditional_userInformationForm .jrLeft").css("display","none");$("#capture_returnTraditional_userInformationForm .janrain-capture-ui-padding").prepend($('<div id="alreadyRegisterNotification" style="min-height:60px; ">'+e+" is already registered with "+f+".	You will be able to use the same account on "+d+". Alternatively, you can create a new account with another email address.</div>"));$("#alreadyRegisterNotification").append($("#capture_returnTraditional_userInformationForm_errorMessages"));$("#capture_returnTraditional_userInformationForm_errorMessages").empty();$("#traditionalWelcomeName").css("display","none");$("#capture_returnTraditional_form_item_traditionalSignIn_emailAddress #capture_returnTraditional_traditionalSignIn_emailAddress").val(e);$("#capture_returnTraditional_form_item_traditionalSignIn_password #capture_returnTraditional_traditionalSignIn_password").attr("placeholder","Password (6 characters min)");$("#capture_returnTraditional_traditionalSignIn_createButton").css("border","none");$("#capture_returnTraditional_traditionalSignIn_createButton").css("text-align","left");$("#capture_returnTraditional_traditionalSignIn_createButton").text("Create a new account");$(".capture_right .jrForgot").css("display","none")};this.logoutUser=function(){document.getElementById("logoutBtn").click()};function b(d){$(d).jCarouselLite({btnNext:d+" .next",btnPrev:d+" .prev",speed:500,timeout:a*1000,auto:true,visible:1,start:1,scroll:1,circular:true})}}!function(G,A){function m(f,h,u){var g=f.children(),s=!1;f.empty();for(var c=0,p=g.length;p>c;c++){var a=g.eq(c);if(f.append(a),u&&f.append(u),D(f,h)){a.remove(),s=!0;break}u&&u.detach()}return s}function b(o,t,g,p,a){var h=!1,r="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",f="script, .dotdotdot-keep";return o.contents().detach().each(function(){var d=this,c=G(d);if("undefined"==typeof d||3==d.nodeType&&0==G.trim(d.data).length){return !0}if(c.is(f)){o.append(c)}else{if(h){return !0}o.append(c),a&&o[o.is(r)?"after":"append"](a),D(g,p)&&(h=3==d.nodeType?k(c,t,g,p,a):b(c,t,g,p,a),h||(c.detach(),h=!0)),h||a&&a.detach()}}),h}function k(L,s,a,l,M){var N=L[0];if(!N){return !1}var K=H(N),I=-1!==K.indexOf(" ")?" ":"　",i="letter"==l.wrap?"":I,J=K.split(i),S=-1,R=-1,P=0,O=J.length-1;for(l.fallbackToLetter&&0==P&&0==O&&(i="",J=K.split(i),O=J.length-1);O>=P&&(0!=P||0!=O);){var t=Math.floor((P+O)/2);if(t==R){break}R=t,q(N,J.slice(0,R+1).join(i)+l.ellipsis),D(a,l)?(O=R,l.fallbackToLetter&&0==P&&0==O&&(i="",J=J[0].split(i),S=-1,R=-1,P=0,O=J.length-1)):(S=R,P=R)}if(-1==S||1==J.length&&0==J[0].length){var Q=L.parent();L.detach();var u=M&&M.closest(Q).length?M.length:0;Q.contents().length>u?N=F(Q.contents().eq(-1-u),s):(N=F(Q,s,!0),u||Q.detach()),N&&(K=w(H(N),l),q(N,K),u&&M&&G(N).parent().append(M))}else{K=w(J.slice(0,S+1).join(i),l),q(N,K)}return !0}function D(a,c){return a.innerHeight()>c.maxHeight}function w(a,c){for(;G.inArray(a.slice(-1),c.lastCharacter.remove)>-1;){a=a.slice(0,-1)}return G.inArray(a.slice(-1),c.lastCharacter.noEllipsis)<0&&(a+=c.ellipsis),a}function B(a){return{width:a.innerWidth(),height:a.innerHeight()}}function q(a,c){a.innerText?a.innerText=c:a.nodeValue?a.nodeValue=c:a.textContent&&(a.textContent=c)}function H(a){return a.innerText?a.innerText:a.nodeValue?a.nodeValue:a.textContent?a.textContent:""}function C(a){do{a=a.previousSibling}while(a&&1!==a.nodeType&&3!==a.nodeType);return a}function F(f,h,d){var g,c=f&&f[0];if(c){if(!d){if(3===c.nodeType){return c}if(G.trim(f.text())){return F(f.contents().last(),h)}}for(g=C(c);!g;){if(f=f.parent(),f.is(h)||!f.length){return !1}g=C(f[0])}if(g){return F(G(g),h)}}return !1}function z(a,c){return a?"string"==typeof a?(a=G(a,c),a.length?a:!1):a.jquery?a:!1:!1}function x(d){for(var g=d.innerHeight(),i=["paddingTop","paddingBottom"],f=0,h=i.length;h>f;f++){var c=parseInt(d.css(i[f]),10);isNaN(c)&&(c=0),g-=c}return g}if(!G.fn.dotdotdot){G.fn.dotdotdot=function(p){if(0==this.length){return G.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this}if(this.length>1){return this.each(function(){G(this).dotdotdot(p)})}var r=this;r.data("dotdotdot")&&r.trigger("destroy.dot"),r.data("dotdotdot-style",r.attr("style")||""),r.css("word-wrap","break-word"),"nowrap"===r.css("white-space")&&r.css("white-space","normal"),r.bind_events=function(){return r.bind("update.dot",function(i,l){i.preventDefault(),i.stopPropagation(),a.maxHeight="number"==typeof a.height?a.height:x(r),a.maxHeight+=a.tolerance,"undefined"!=typeof l&&(("string"==typeof l||l instanceof HTMLElement)&&(l=G("<div />").append(l).contents()),l instanceof G&&(f=l)),n=r.wrapInner('<div class="dotdotdot" />').children(),n.contents().detach().end().append(f.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var o=!1,g=!1;return h.afterElement&&(o=h.afterElement.clone(!0),o.show(),h.afterElement.detach()),D(n,a)&&(g="children"==a.wrap?m(n,a,o):b(n,r,n,a,o)),n.replaceWith(n.contents()),n=null,G.isFunction(a.callback)&&a.callback.call(r[0],g,f),h.isTruncated=g,g}).bind("isTruncated.dot",function(c,g){return c.preventDefault(),c.stopPropagation(),"function"==typeof g&&g.call(r[0],h.isTruncated),h.isTruncated}).bind("originalContent.dot",function(c,g){return c.preventDefault(),c.stopPropagation(),"function"==typeof g&&g.call(r[0],f),f}).bind("destroy.dot",function(c){c.preventDefault(),c.stopPropagation(),r.unwatch().unbind_events().contents().detach().end().append(f).attr("style",r.data("dotdotdot-style")||"").data("dotdotdot",!1)}),r},r.unbind_events=function(){return r.unbind(".dot"),r},r.watch=function(){if(r.unwatch(),"window"==a.watch){var g=G(window),i=g.width(),c=g.height();g.bind("resize.dot"+h.dotId,function(){i==g.width()&&c==g.height()&&a.windowResizeFix||(i=g.width(),c=g.height(),d&&clearInterval(d),d=setTimeout(function(){r.trigger("update.dot")},100))})}else{t=B(r),d=setInterval(function(){if(r.is(":visible")){var e=B(r);(t.width!=e.width||t.height!=e.height)&&(r.trigger("update.dot"),t=e)}},500)}return r},r.unwatch=function(){return G(window).unbind("resize.dot"+h.dotId),d&&clearInterval(d),r};var f=r.contents(),a=G.extend(!0,{},G.fn.dotdotdot.defaults,p),h={},t={},d=null,n=null;return a.lastCharacter.remove instanceof Array||(a.lastCharacter.remove=G.fn.dotdotdot.defaultArrays.lastCharacter.remove),a.lastCharacter.noEllipsis instanceof Array||(a.lastCharacter.noEllipsis=G.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),h.afterElement=z(a.after,r),h.isTruncated=!1,h.dotId=j++,r.data("dotdotdot",!0).bind_events().trigger("update.dot"),a.watch&&r.watch(),r},G.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},G.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},G.fn.dotdotdot.debug=function(){};var j=1,y=G.fn.html;G.fn.html=function(a){return a!=A&&!G.isFunction(a)&&this.data("dotdotdot")?this.trigger("update",[a]):y.apply(this,arguments)};var E=G.fn.text;G.fn.text=function(a){return a!=A&&!G.isFunction(a)&&this.data("dotdotdot")?(a=G("<div />").text(a).html(),this.trigger("update",[a])):E.apply(this,arguments)}}}(jQuery);(function(b,a){b.fn.ellipsize=function(c){var d={ellipsis:"... ",wrap:"word",fallbackToLetter:false,after:null,watch:"window",height:null,tolerance:0,lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]}};var c=b.extend(c,d);this.each(function(e,g){var h=b(g),f=parseInt(h.attr("data-ellipsize-height"),10)||null;h.removeClass("js-ellipsize");h.dotdotdot(c)})};b(document).ready(function(){b(".js-ellipsize").ellipsize()})})(jQuery,(typeof jpdna!=="undefined"?jpdna:window.jpdna={}));