define(function(){if(typeof window.bbcdotcom==="undefined"||typeof bbcdotcom.objects==="undefined"){return{addEventListeners:function(){},callback:function(){},trackEvent:function(){}}}var e=[];var f=function(i){i.data={videoPlaysAutomatically:true};i.flags.playlistStarted=false;i.flags.programStarted=false;i.flags.isPaused=false;i.flags.isSeeking=false;i.flags.adRequestOrPlaybackInProgress=false;i.flags.ended=false;i.flags.playlistEnded=false;i.flags.trackProgramStartOnNextTimeupdate=false};var d=function(j){var i=j.player.settings();j.data.mediaType=j.player.kind();j.data.mediaOffset=j.player.currentTime();j.data.mediaLength=j.player.duration();j.data.mediaPlayerName=j.player.name();j.data.adId=null;j.data.mediaId=bbcdotcom.objects("settings.container.0.id")};var b=function(j,k,i){if(typeof bbcdotcom.analytics==="undefined"){return false}d(k);if(i===true){k.data.mediaOffset=0}bbcdotcom.analytics[j](k.data)};var a=function(k){if(typeof COMSCORE==="undefined"){return}var j=(bbcdotcom.objects("bbcdotcom.sections"))?bbcdotcom.sections.getSection():"other";var i=(k==="ad")?"09":"02";COMSCORE.beacon({c1:1,c2:"6035051",c3:j,c4:"",c5:i,c6:"",c15:""})};var g=function(i){if(!i.flags.playlistStarted){i.flags.playlistStarted=true;b("startPlaylist",i)}};var h=function(i){var j={player:i,data:{videoPlaysAutomatically:true},flags:{playlistStarted:false,programStarted:false,isPaused:false,isSeeking:false,adRequestOrPlaybackInProgress:false,ended:false,playlistEnded:false,trackProgramStartOnNextTimeupdate:false}};e.push(j);j.player.bind("playlistLoading",function(k){});j.player.bind("playlistLoaded",function(l){f(j);j.data.mediaName=l.playlist.title;var k=l.playlist.items;j.data.isLive=k[k.length-1].live});j.player.bind("userPlay",function(k){j.data.videoPlaysAutomatically=false});j.player.bind("playing",function(k){g(j);if(!j.flags.programStarted&&!j.flags.adRequestOrPlaybackInProgress){j.flags.programStarted=true;b("startProgramme",j,true);a()}if(j.flags.isPaused){j.flags.isPaused=false;b("endPause",j)}});j.player.bind("pause",function(k){d(j);if((j.data.mediaOffset+1)<j.data.mediaLength){j.flags.isPaused=true;b("startPause",j)}});j.player.bind("timeupdate",function(k){if(j.flags.isSeeking){j.flags.isSeeking=false;b("endSeek",j)}});j.player.bind("seeking",function(k){j.flags.isSeeking=true;b("startSeek",j)});j.player.bind("ended",function(k){j.flags.ended=true;b("endProgramme",j);if(j.flags.playlistEnded){b("endPlaylist",j)}});j.player.bind("playlistEnded",function(k){j.flags.playlistEnded=true;if(j.flags.ended){b("endPlaylist",j)}});j.player.bind("adsPlugin",function(k){switch(k.id){case"adRequest":j.flags.adRequestOrPlaybackInProgress=true;g(j);b("adRequest",j);break;case"adManagerLoaded":b("adManagerLoaded",j);break;case"adEnded":j.flags.adRequestOrPlaybackInProgress=false;b("endAdvert",j);break;case"adStarted":g(j);b("startAdvert",j);a("ad");break;case"adError":j.flags.adRequestOrPlaybackInProgress=false;break}})};var c=function(i,k){if(typeof bbcdotcom.analytics==="undefined"){return false}var j={},m;var l=e[0];d(l);for(m in l.data){j[m]=l.data[m]}if(typeof k==="object"){for(m in k){j[m]=k[m]}}bbcdotcom.analytics.trackEvent(i,j)};bbcdotcom.objects("bbcdotcom.av.emp.analytics","create");bbcdotcom.av.emp.analytics={addEventListeners:h,callback:b,trackEvent:c};return bbcdotcom.av.emp.analytics});