define(["jquery-1"],function(a){if(window.bbcdotcom&&typeof bbcdotcom.objects!=="undefined"&&bbcdotcom.objects("bbcdotcom.av.emp.adverts","create")){bbcdotcom.av.emp.adverts=(function(){var v,u,x;v={mpu:{slot:"mpu",size:"300x250",type:"adi",domId:"bbccom_mpu"}};u={MAP:[v.mpu],media_asset:[v.mpu],"default":[],video:[v.mpu],blog:[v.mpu],homepage:[],none:[]};x=[];function y(F){var C=new RegExp(F+"=(.*?)(?:;|$)");var E=C.exec(document.cookie);var D=(E&&E.length?E[1]:false);return D}function t(){var C=document.createElement("script");C.async=true;C.type="text/javascript";C.src="http://s0.2mdn.net/instream/html5/gpt_proxy.js";var D=document.getElementsByTagName("script")[0];D.parentNode.insertBefore(C,D)}function k(){var F,E=bbcdotcom.adverts.keyValues.getAll(),D="&cust_params=",C;for(F in E){if(E.hasOwnProperty(F)&&E[F]!==""){D+=F+"%3D"+E[F]+"%26"}}if(bbcdotcom.objects("bbcdotcom.adverts.adUnit.getPreviewUid")){C="uid="+bbcdotcom.adverts.adUnit.getPreviewUid();D+=encodeURIComponent(C)}return D}function c(D){var C=D.replace("media-","");if(typeof a!=="undefined"){a("#media-asset-page-video").after('<div id="bbccom_companion_'+C+'" class="bbccom_companion_outer" aria-hidden="true"></div>');a(".media-feeds").prepend('<div id="bbccom_mpu" class="bbccom_mpu_outer" aria-hidden="true"></div>');if(a("#"+D).width()>=300){a("#"+C+" .media-item").append('<div id="bbccom_companion_'+C+'" class="bbccom_companion_outer" aria-hidden="true"></div>')}}}function r(F){var C,H="",D="",G,E=bbcdotcom.av.emp.adverts.getCompanionSlots(F);if(typeof E!=="undefined"){for(G in E){if(E.hasOwnProperty(G)){H+=E[G].size+","}}H=H.slice(0,-1)}if(typeof BBC!=="undefined"&&typeof BBC.adverts!=="undefined"&&typeof BBC.adverts.empCompanion==="function"){C=BBC.adverts.empCompanion(H)}else{if(typeof bbcdotcom!=="undefined"&&typeof bbcdotcom.advert!=="undefined"&&typeof bbcdotcom.advert.getPrerollAdTag==="function"){C=bbcdotcom.advert.getPrerollAdTag(bbcdotcom.adUnit)}else{if(typeof bbcdotcom!=="undefined"&&typeof bbcdotcom.objects!=="undefined"&&bbcdotcom.objects("bbcdotcom.adverts.adUnit.get")&&bbcdotcom.objects("bbcdotcom.adverts.keyValues.getAll")){D=(H!=="")?"&ciu_szs="+H:"";C="http://pubads.g.doubleclick.net/gampad/ads?sz=512x288&iu="+bbcdotcom.adverts.adUnit.get()+k()+D+"&env=vp&gdfp_req=1&impl=s&output=xml_vast2&unviewed_position_start=1&ord="+(Math.floor(Math.random()*1000000000))+"&url="+encodeURIComponent(encodeURIComponent(bbcdotcom.config.getWindowLocation().href))+"&ad_rule=1"}}}return C}function n(E){var C=r();var D=new RegExp(/(ad_rule=)\d{1}/g);if(D.test(C)===false){C=C+"&ad_rule="+E||1}return C}function h(E){bbcdotcom.av.emp.adverts.enableCompanions();var D=bbcdotcom.av.emp.adverts.getCompanionSlotId(E);var C=bbcdotcom.av.emp.adverts.getCompanionSlots(D);bbcdotcom.av.emp.adverts.defineCompanionSlots(C)}function f(E){var D,C;D=E.split("-");if(D.length===1){D=E.split("_")}if(D.length>=2){C=D[1]}else{C=false}return C}function B(E){var C=[],D;for(D=0;D<E.length;D++){C[D]={};C[D].slot=E[D].slot;C[D].size=E[D].size;C[D].type=E[D].type;C[D].domId=E[D].domId}return C}function i(H){var G,F,E,D,C;if(typeof BBC!=="undefined"&&typeof BBC.adverts!=="undefined"&&typeof BBC.adverts.getZoneData!=="undefined"){C=BBC.adverts.getZoneData()}else{C={}}if(window.wwhomepage){G=B(u.homepage)}else{if(bbcdotcom.objects("bbcdotcom.config.isContinuousPlayPage")&&bbcdotcom.objects("config.asset.type")!=="MAP"){G=B(u.none)}else{if(bbcdotcom.objects("config.asset.type")==="MAP"&&(bbcdotcom.objects("bbcdotcom.getCurrentGroupId")===3||bbcdotcom.objects("bbcdotcom.getCurrentGroupId")===4)){G=B(u[config.asset.type])}else{if(bbcdotcom.objects("bbc.fmtj.page.assetType")&&BBC.adverts.isCreamDataPresent()){if(u[bbc.fmtj.page.assetType]!==undefined){G=B(u[bbc.fmtj.page.assetType])}else{G=B(u["default"])}}else{if(bbcdotcom.objects("zoneData.keyValues.asset_type")&&C.keyValues.asset_type==="video"){G=B(u[C.keyValues.asset_type])}else{if(bbcdotcom.objects("zoneData.keyValues.companion_slots")){E=C.keyValues.companion_slots.split(",");D=[];for(F=0;F<E.length;F++){D.push(v[E[F]])}G=B(D)}else{G=B(u["default"])}}}}}}if(H){for(F=0;F<G.length;F++){if(G[F].slot==="companion"){G[F].domId=G[F].domId+"_"+H}}}return G}function l(F){var C="",D,E;for(D=0;D<F.length;D++){E="";E+="slot:"+F[D].slot+"|";E+="size:"+F[D].size+"|";E+="type:"+F[D].type+"|";E+="domId:"+F[D].domId+";";C+=E}return C}function A(D){var C=[],H,G,E,I,F;H=D.split(";");for(G=0;G<H.length;G++){if(""!==H[G]){C[G]={};I=H[G].split("|");for(E=0;E<I.length;E++){F=I[E].split(":");C[G][F[0]]=F[1]}}}return C}function s(D,C){return function(){BBC.adverts.resetSlotForGpt(D,C)}}function e(D,C){return(" "+D.className+" ").indexOf(" "+C+" ")>-1}function m(E){var D,H,G,F,C;for(D=0;D<E.length;D++){H=E[D].slot;G=E[D].domId;F={slotDomId:G,size:E[D].size};C=document.getElementById(G);if(C&&x.join(",").indexOf(H)===-1){x.push(H);if(typeof BBC!=="undefined"&&typeof BBC.adverts!=="undefined"){if(!e(C,"bbccom_display_none")&&!e(C,"bbccom_visibility_hidden")){BBC.adverts.slideSlotClosed(H,F,s(H,F))}else{BBC.adverts.resetSlotForGpt(H,F)}}else{if(typeof bbcdotcom!=="undefined"&&typeof bbcdotcom.adverts!=="undefined"){w(H,F)}}}}}function p(F,H,D){var G,E,C;C={cur:0,max:5000};if(D===undefined){D=100}G=F.innerHTML;E=setInterval(function(){var I;I=(G!==F.innerHTML);if(I){H();clearInterval(E)}else{if(C.cur<C.max){C.cur++}else{clearInterval(E)}}},D)}var o=function(C){a("#"+C).addClass("bbccom_visibility_show").slideDown("slow")};function z(E,D,C){googletag.cmd.push(function(){googletag.defineSlot(bbcdotcom.adverts.adUnit.get(),[E,D],C).addService(googletag.companionAds()).addService(googletag.pubads());googletag.companionAds().setRefreshUnfilledSlots(false);googletag.pubads().disableInitialLoad();googletag.enableServices();if(!bbcdotcom.config.isAsync()){googletag.display(C)}})}function w(J,C){var L=C.size,I="advertisementText",D=parseFloat(L.slice(0,L.indexOf("x"))),K=parseFloat(L.slice(L.indexOf("x")+1)),F,G,E,H;if(window.googletag){F=document.getElementById(C.slotDomId);if(F){G=C.slotDomId+"_inner";E=bbcdotcom.adverts.adText.getText(I);H=bbcdotcom.adverts.adText.getInfoUrl(I);a("#"+C.slotDomId).html('<div class="bbccom_companion_inner"><a href="'+H+'" class="bbccom_text">'+E+'</a><div class="bbccom_advert_inner" id="'+G+'"></div></div>');p(F,function(){o(C.slotDomId);if(typeof bbcdotcom!=="undefined"&&typeof bbcdotcom.utils!=="undefined"){bbcdotcom.utils.addBodyTagClass("bbccom_companion")}});if(document.readyState==="complete"){z(D,K,G)}else{window.addEventListener("load",function(){z(D,K,G)},false)}}}}function j(D,F){var E,C;if(F!==undefined&&F.length>0){E=l(F);D.set("companions",E);for(C=0;C<F.length;C++){D.set("companion"+(C+1)+"Size",F[C].size);D.set("companion"+(C+1)+"Type",F[C].type);D.set("companion"+(C+1)+"Id",F[C].domId)}}}function g(D){var E,C;D.set("preroll",r(E));E=f(D.getDomId());C=i(E);j(D,C);if(BBC.adverts.isNewsPage()){m(C)}}function b(J,F){var H;var E=r()+"&ad_rule=1";var G=bbcdotcom.config.getAssetPrefix()+"vendor/smp/adsPlugin/css/AdsPlugin.css";var D=y("bbcdotcomHtml5AdsDebug");var I=function(){h(J)};var C={name:"AdsPluginParameters",data:{adTag:E,debug:D,cssPath:G,setupCompanionAds:I}};for(H in F){C.data[H]=F[H]}return C}function d(D,C){var E=C.settings();E.suppressItemKind=D;C.settings(E);return C}function q(D,E,C){var J=E.bumpVersion.split("."),K=J[0],I=J[1],G=J[2],L,M=C||{},F,H;if(/(sandbox|int)(.dev)*.bbc.co*/.test(window.location.href)||/[?|&]ads-debug/.test(window.location.href)||document.cookie.indexOf("ads-debug=")!==-1){F=bbcdotcom.config.getAssetPrefix()+"vendor/smp/adsPlugin/js/AdsPlugin.js"}else{F=bbcdotcom.config.getAssetPrefix()+"vendor/smp/adsPlugin/js/AdsPlugin.min.js"}if(typeof BBC==="undefined"&&a(".bbcdotcom_desktop").length===0){c(D)}if(M&&M.html5PluginPath){F=bbcdotcom.config.getAssetPrefix()+M.html5PluginPath}if(window.location.pathname.indexOf("/sport/0/")===0){H=bbcdotcom.config.getSwfPrefix()+"/bbcdotcom/AdsPlugin.swf"}else{H=bbcdotcom.config.getAssetPrefix()+"vendor/smp/adsPlugin/swf/AdsPlugin.swf"}if(E.loadPlugin!==undefined&&typeof E.loadPlugin==="function"){L=b(D,M);E.loadPlugin({html:F,swf:H},L)}d(["ident"],E)}return{getPrerollAdTag:r,getPrerollAdTagWithAdRule:n,setupCompanionSlots:h,enableCompanions:t,getCompanionSlotId:f,getCompanionSlots:i,encodeCompanionSlots:l,decodeCompanionSlots:A,defineCompanionSlots:m,setCompanionFlashVars:j,playerBeforeEachWrite:g,addSmpPlugin:q}}());return bbcdotcom.av.emp.adverts}});