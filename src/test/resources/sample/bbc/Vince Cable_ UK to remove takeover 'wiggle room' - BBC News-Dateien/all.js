/*!
     * jQuery Tiny Pub/Sub - v0.6 - 1/10/2011
     * http://benalman.com/
     *
     * Copyright (c) 2010 "Cowboy" Ben Alman
     * Dual licensed under the MIT and GPL licenses.
     * http://benalman.com/about/license/
     */

//Modernizr is available under the MIT license

/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.3.0
 */

/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash include="debounce"`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */

/*! grunt-grunticon Stylesheet Loader - v2.1.6 | https://github.com/filamentgroup/grunticon | (c) 2015 Scott Jehl, Filament Group, Inc. | MIT license. */

/*!
 * jQuery-ajaxTransport-XDomainRequest - v1.0.4 - 2015-03-05
 * https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest
 * Copyright (c) 2015 Jason Moon (@JSONMOON)
 * Licensed MIT (/blob/master/LICENSE.txt)
 */

define("module/bootstrappedJquery",["jquery"],function(e){return e.ajaxSetup({cache:!0}),e}),define("vendor/events/pubsub",["jquery"],function(e){var t=e({});e.eventHistory=[],e.on=function(n,r){function i(){return r.apply(this,Array.prototype.slice.call(arguments,1))}i.guid=r.guid=r.guid||(e.guid?e.guid++:e.event.guid++),t.on(n,i)},e.off=function(){t.off.apply(t,arguments)},e.emit=function(){e.eventHistory.push(arguments[0]),t.trigger.apply(t,arguments)}}),define("module/globalPubsub",["module/bootstrappedJquery","vendor/events/pubsub"],function(e){return e}),define("module/bootstrap",["config","module/bootstrappedJquery","module/globalPubsub"],function(e,t,n){var r={pubsub:n,$:t,config:e,window:window};return r}),define("module/translator",[],function(){function n(n,r){if(!n)throw t.TRANSLATION_UNDEFINED;if(!e(n))throw t.TRANSLATION_NOT_AN_OBJECT;this.translation=n,this.locale=r||"en-GB"}var e=function(e){return Object.prototype.toString.call(e)==="[object Object]"},t={TRANSLATION_UNDEFINED:"Translator Error : Translator expects a translation object as its first parameter",TRANSLATION_NOT_AN_OBJECT:"Translator Error : Translator expects an object literal as its first parameter"};return n.prototype.get=function(e){return this.translation[e]?this.translation[e]:null},n.prototype.getLocale=function(){return this.locale},n}),define("translator",["module/translator","config","translation"],function(e,t,n){return new e(n,t.locale)}),define("module/ajaxForm/ajaxForm",["module/bootstrap","config","translator"],function(e,t,n){var r=e.$,i=function(){this.errorMessage=n.get("thereWasAProblem");var t=this;e.pubsub.on("ajaxForm:submit",function(e,n){t.submit(e,n)})};return i.prototype.submit=function(t,n){e.pubsub.emit("ajaxForm:renderWait"),r.ajax({url:n+".json",dataType:"json",type:"POST",data:t,success:function(t){var n=t.body;switch(t.reply){case"success":e.pubsub.emit("ajaxForm:success",[n]);break;case"feedback":e.pubsub.emit("ajaxForm:feedback",[n]);break;default:e.pubsub.emit("ajaxForm:error",[n])}},error:r.proxy(function(t){e.pubsub.emit("ajaxForm:error",[this.errorMessage,t])},this)})},i}),define("module/ajaxForm/ajaxFormView",["module/bootstrap","translator"],function(e,t){function n(t){var n=e.$(t.parentNode);e.$(t).val()?n.addClass("input-has-content"):n.removeClass("input-has-content")}function r(n){this.translator=t,this.elm=e.$(n),this.url=this.elm.attr("action"),this.fields=e.$("input, textarea",this.elm),this.attach()}return r.prototype={attach:function(){var t=this;this.elm.on("submit",function(e){e.preventDefault(),t.send()});var n=function(t){var n=e.$(t).parent(),r=e.$(t).val()!=="";n.toggleClass("input-has-content",r)},r=function(t){var r=t.target;if(!!e.$(r).prop("nodeName").match(/(INPUT|TEXTAREA)/)){var i=t.type.toLowerCase()==="focus"?"add":"remove";e.$(r).parent().toggleClass("input-has-focus",i),n(r)}};return this.fields.on("focus",r),this.fields.on("blur",r),this.fields.on("keyup",function(t){var r=t.target;!e.$(r).prop("nodeName").match(/(INPUT|TEXTAREA)/)||n(r)}),e.pubsub.on("ajaxForm:success",function(n){t.elm.removeClass("feedback"),t.elm.addClass("successful-submit"),t.elm.before('<div id="successMsg"><p>'+n+'</p><button><span class="cta">'+t.translator.get("sendAnotherComment")+"</span></button></div>"),e.$("#successMsg button").on("click",function(){e.pubsub.emit("ajaxForm:showForm")})}),e.pubsub.on("ajaxForm:feedback",function(r){e.$("p.feedback",this.elm).remove(),t.elm.addClass("feedback"),e.pubsub.emit("ajaxForm:stopWait"),e.$(t.fields).each(function(t,i){var s=e.$(i).attr("name"),o=e.$(i).val().trim();r[s]!==undefined&&(e.$(i).val(o),e.$(i).parent().addClass("invalid"),n(i),e.$(i.parentNode).append('<p class="feedback">'+r[i.name]+"</p>"))})}),e.pubsub.on("ajaxForm:error",function(n,r){t.elm.removeClass("feedback"),t.elm.addClass("error"),e.pubsub.emit("ajaxForm:stopWait"),t.elm.before('<div id="errorMsg"><p>'+n+"</p><button><span>"+t.translator.get("retry")+"</span></button>"),e.$("#errorMsg button").on("click",function(){t.send()})}),e.pubsub.on("ajaxForm:showForm",function(){e.$("#"+t.elm.attr("id")+" fieldset p").remove(),t.fields.each(function(t,r){e.$(r).val(""),n(r)}),t.elm.removeClass("successful-submit").removeClass("error"),e.$("#successMsg, #errorMsg").remove()}),e.pubsub.on("ajaxForm:stopWait",function(){t.elm.removeClass("wait"),e.$(".spin",t.elm).remove()}),e.pubsub.on("ajaxForm:renderWait",function(){t.elm.addClass("wait"),e.$("fieldset",t.elm).removeClass("invalid"),e.$("#successMsg, #errorMsg").remove(),t.elm.append('<div class="spin"></div>')}),this},send:function(){var t=[];this.fields.each(function(n,r){var i=e.$(r);t.push(i.attr("name")+"="+i.val())}),e.pubsub.emit("ajaxForm:submit",[t.join("&"),this.url])}},r}),define("module/featureDetector",["config"],function(e){function a(e){var t=/forceTouchSupport=(on|off)/.exec(window.location.search);return t&&t[1]?t[1]===e:!1}function f(e,n){return t.hasOwnProperty(n)||(t[n]=u[e+n]?u[e+n]():undefined),t[n]}var t={},n=/OS ([0-9])/,r=document.documentElement,i="modernizr",s=document.createElement(i),o=s.style,u={isIos:function(){return/(iPod|iPad|iPhone)/.test(navigator.userAgent)},isIosVersion:function(e){var t=n.exec(navigator.userAgent);return t&&t[1]?Number(t[1])>=e?!0:!1:!1},isIos4:function(){return this.isIosVersion(4)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isAndroidMobile2:function(){return this.isAndroid()&&/Mobile/i.test(navigator.userAgent)&&/Android 2./.test(navigator.userAgent)},isAndroidMobile22:function(){return this.isAndroid()&&/Mobile/i.test(navigator.userAgent)&&/2.2/.test(navigator.userAgent)},isIE10:function(){return/MSIE 10/.test(navigator.userAgent)},isWindowsPhone:function(){return/Windows Phone/.test(navigator.userAgent)},isChrome:function(){return/Chrome/.test(navigator.userAgent)},canUseHistoryApi:function(){return window.history&&window.history.pushState},isContinuousPlayEnabled:function(){return!!document.getElementById("gnlContinuousPlayEnabled")||!!document.getElementById("continuous-play-enabled")},isShowingDesktopAds:function(){return!!document.getElementById("advert-post-script-load")},isOrbFig:function(){return typeof orb!="undefined"&&typeof orb.fig=="function"},isCollectingGNLAnalytics:function(){return!!document.getElementById("gnlAnalyticsEnabled")},isDisplayingGnlAds:function(){return!!document.getElementById("gnlAdsEnabled")},isFromUK:function(){var e=typeof orb.fig.geo!="undefined"&&typeof orb.fig.geo.isUK=="function";return this.isOrbFig()&&e?orb.fig.geo.isUK():undefined},canPlayProgressiveDownload:function(){return e.configuration.cms==="topcat"&&!this.isDesktop()&&e.asset.isLiveAvStream!==!0&&(!this.isIos()||e.asset.mediaType==="audio")},_contains:function(e,t){return!!~(""+e).indexOf(t)},_injectElementWithStyles:function(e,t,n,s){var o,u,a,f,l=document.createElement("div"),c=document.body,h=c||document.createElement("body");if(parseInt(n,10))while(n--)a=document.createElement("div"),a.id=s?s[n]:i+(n+1),l.appendChild(a);return o=["&#173;",'<style id="s',i,'">',e,"</style>"].join(""),l.id=i,(c?l:h).innerHTML+=o,h.appendChild(l),c||(h.style.background="",h.style.overflow="hidden",f=r.style.overflow,r.style.overflow="hidden",r.appendChild(h)),u=t(l,e),c?l.parentNode.removeChild(l):(h.parentNode.removeChild(h),r.style.overflow=f),!!u},_testProps:function(e,t){for(var n in e){var r=e[n];if(!this._contains(r,"-")&&o[r]!==undefined)return t==="pfx"?r:!0}return!1},_testPropsAll:function(e,t,n){var r="Webkit Moz O ms",i=r.split(" "),s=e.charAt(0).toUpperCase()+e.slice(1),o=(e+" "+i.join(s+" ")+s).split(" ");return this._testProps(o,t)},canCssColumn:function(){return!!this._testPropsAll("columnCount")},canCssTransition:function(){return!!this._testPropsAll("transition")},whichTransitionEnd:function(){var e=document.createElement("fakeelement"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var n in t)if(e.style[n]!==undefined)return t[n]},canCssTransform:function(){return!!this._testPropsAll("transform")},canCssPreserve3d:function(){if(!this.canCssTransform())return!1;var e=!!this._testPropsAll("transformStyle");return e&&this._injectElementWithStyles("#modernizr { transform-style: preserve-3d; -webkit-transform-style: preserve-3d; -moz-transform-style: preserve-3d; -o-transform-style: preserve-3d; }",function(t,n){if(!window.getComputedStyle)return!1;var r="preserve-3d",i=window.getComputedStyle(t),s=i.getPropertyValue("-webkit-transform-style")===r,o=i.getPropertyValue("-moz-transform-style")===r,u=i.getPropertyValue("-o-transform-style")===r,a=i.getPropertyValue("transform-style")===r;e=a||u||o||s}),e},canCssTransform3d:function(){var e=!!this._testPropsAll("perspective");return e&&"webkitPerspective"in r.style&&this._injectElementWithStyles("@media (transform-3d), (-webkit-transform-3d) { #modernizr{ left: 9px; position: absolute; height: 3px; }}",function(t,n){e=t.offsetLeft===9&&t.offsetHeight===3}),e},canTouchEvents:function(){return"ontouchstart"in window},canSVG:function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},isDesktop:function(){return this.isLargeScreen()&&!this.isTouchDevice()},isTouchDevice:function(){return a("off")?!1:a("on")||this.canTouchEvents()||window.navigator.msMaxTouchPoints>0||window.DocumentTouch&&document instanceof DocumentTouch?!0:!1},isLargeScreen:function(){var e=window.innerWidth>0?window.innerWidth:screen.width;return e>1024?!0:!1},_isWsChannelPage:function(){return e.isChannelPage&&e.configuration.cms==="topcat"}};return{can:function(e){return f("can",e)},is:function(e){return f("is",e)},which:function(e){return f("which",e)},__cacheClear:function(){t={}}}}),define("module/deviceInspector",["module/bootstrap","module/featureDetector"],function(e,t){function d(){o.$(i).on("resize",m)}function v(){var e=s.documentElement.clientWidth,t=s.documentElement.clientHeight;return e>t?e:t}function m(e){var t=b(),i=w();t!==n&&E(t),i!==r&&S(i)}function g(){return s.documentElement.clientWidth}function y(){return t.is("TouchDevice")}function b(){var e=g(),t="group1";return e>=a&&e<f?t="group2":e>=f&&e<l?t="group3":e>=l&&(t="group4"),t}function w(){var e=v(),t=g(),n;if(t<c||t>=c&&e<p)n="smart";return t>=c&&e>=p&&(n="tablet"),g()>=h&&!y()&&(n="wide"),n}function E(e){n=e,o.pubsub.emit("deviceGroup",[n])}function S(e){r=e,o.pubsub.emit("deviceType",[r])}function x(){return n}function T(){return r}function N(t,u){return i=t||window,o=u||e,n="group1",r="smart",s=i.document,E(b()),S(w()),d(),{getType:T,getGroup:x}}var n,r,i,s,o,u=0,a=400,f=600,l=1008,c=600,h=1008,p=720;return{init:N}}),define("deviceInspector",["module/deviceInspector"],function(e){return e.init()}),define("module/alternativeJsStrategy/processJsDependencies",[],function(){var e=function(e,t){require([e],function(e){e&&e.reProcess&&e.reProcess("#"+t)})},t=function(t,n){for(var r in t)e(t[r],n)};return t}),define("module/polyfill/bind",[],function(){Function.prototype.bind||(Function.prototype.bind=function(e){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i})}),define("module/alternativeJsStrategy/postLoadHandlers/base",["module/bootstrap","module/alternativeJsStrategy/processJsDependencies","module/polyfill/bind"],function(e,t){var n=function(e){if(!e)return;this.elementId=e.getAttribute("id"),this.element=e};return n.prototype.load=function(){e.$.ajax({url:this.url,dataType:"json",success:this.processSuccessfulResponse.bind(this)})},n.prototype.processJsDependencies=function(e){t(e,this.elementId)},n}),define("module/alternativeJsStrategy/postLoadHandlers/single",["module/bootstrap","module/alternativeJsStrategy/postLoadHandlers/base","module/polyfill/bind"],function(e,t){var n=function(e,n){e.getElementsByClassName("show-more-container").length===1?this.hasShowMoreButton=!0:this.postLoaded=!0,this.url=n,t.call(this,e)};return n.prototype=new t,n.prototype.loadIfShouldBeShown=function(){this.load()},n.prototype.addShowMoreButton=function(){require(["module/alternativeJsStrategy/moreButton"],function(e){new e(this.elementId,this.url)}.bind(this))},n.prototype.processSuccessfulResponse=function(t){t.html&&(this.element.outerHTML=t.html),t.moreContentUrl&&!this.hasShowMoreButton&&(this.url=t.moreContentUrl,this.addShowMoreButton()),this.processJsDependencies(t.jsDependencies),e.pubsub.emit("component:postloaded",document.getElementById(this.elementId))},n}),define("module/alternativeJsStrategy/postLoadHandlers/legacySingle",["config","module/alternativeJsStrategy/postLoadHandlers/base","module/bootstrap"],function(e,t,n){var r=function(r,i,s){var o={},u,a;if(i.opts){if(i.opts.bespoke_old_post_load){for(var f in i.opts.js_dependencies)i.opts.js_dependencies[f]="module/"+i.opts.js_dependencies[f];this.bespokeJsOnly=i.opts.js_dependencies;return}i.opts.loading_strategy&&(this.postLoaded=this.isPostLoaded(i),i.opts.loading_strategy="include_content"),i.opts.bespoke_post_load_handler&&(this.bespokePostLoadHandler=i.opts.bespoke_post_load_handler)}i.type==="remote-portlet"&&i.opts.js==="on"&&(i.selector="#"+i.id,this.remotePortletMeta=i),o.id=i.id,o.opts=i.opts,i.template&&(o.template=i.template),i.deviceGroups&&(this.visibleDeviceGroups=i.deviceGroups,o.deviceGroups=i.deviceGroups,this.shouldShow(s)?this.isToggleable=!0:this.delayedLoading=!0),u=i.type||i.name,a={batch:{}},a.batch[u]=o,this.url=e.pathPrefix+(e.languageVariant?"/"+e.languageVariant:"")+"/components?alternativeJsLoading=true&"+n.$.param(a),t.call(this,r)};return r.prototype=new t,r.prototype.loadRemotePortletDependency=function(e){var t=e.opts.js_dependency?e.opts.js_dependency:e.opts.id;require(["module/components/"+t],function(t){t.init(e)})},r.prototype.isPostLoaded=function(e){return e.opts.loading_strategy==="post_load"?!0:!1},r.prototype.addShowMoreButton=function(){require(["module/components/moreButton"],function(e){new e(this.elementId,this.url)}.bind(this))},r.prototype.processSuccessfulResponse=function(e){if(this.bespokePostLoadHandler){require([this.bespokePostLoadHandler],function(t){t.handleSuccess(this,e);for(var r in e)n.pubsub.emit("component:postloaded",document.getElementById(r))}.bind(this));return}for(var t in e)this.element.outerHTML=e[t].html,n.pubsub.emit("component:postloaded",document.getElementById(this.elementId)),this.remotePortletMeta?this.loadRemotePortletDependency(this.remotePortletMeta):this.processJsDependencies(e[t].jsDependencies)},r.prototype.shouldShow=function(e){return!this.visibleDeviceGroups||this.visibleDeviceGroups&&this.visibleDeviceGroups.indexOf(e)!==-1},r.prototype.loadIfShouldBeShown=function(e){this.shouldShow(e)&&this.load()},r.prototype.updateDeviceGroupVisibility=function(e){var t="#"+this.elementId;this.shouldShow(e)?n.$(t).removeClass("hidden"):n.$(t).addClass("hidden")},r.prototype.loadIfShouldBeVisible=function(e){return this.shouldShow(e)?(this.load(),!0):!1},r}),define("module/alternativeJsStrategy/postLoadHandlers/batch",["module/bootstrap","module/alternativeJsStrategy/postLoadHandlers/base"],function(e,t){var n=function(e,n){this.url=n,t.call(this,e),this.load()};return n.prototype=new t,n.prototype.processSuccessfulResponse=function(t){for(var n in t){var r=document.getElementById(n);r&&(r.outerHTML=t[n].html),this.processJsDependencies(t[n].jsDependencies),e.pubsub.emit("component:postloaded",document.getElementById(n))}},n}),define("module/alternativeJsStrategy/loaderFactory",["module/alternativeJsStrategy/postLoadHandlers/single","module/alternativeJsStrategy/postLoadHandlers/legacySingle","module/alternativeJsStrategy/postLoadHandlers/batch"],function(e,t,n){var r=function(r,i){if(r.hasAttribute("data-post-load-url"))return new e(r,r.getAttribute("data-post-load-url"));if(r.hasAttribute("data-comp-meta"))return new t(r,JSON.parse(r.getAttribute("data-comp-meta")),i);if(r.hasAttribute("data-batch-load-url"))return new n(r,r.getAttribute("data-batch-load-url"))};return{build:r}}),define("module/alternativeJsStrategy/controller",["deviceInspector","module/alternativeJsStrategy/loaderFactory","module/bootstrap","module/polyfill/bind"],function(e,t,n){var r=function(){function t(e){var t=/device--(?:feature|smart|tablet|wide)/,r=document.body.className.split(" "),i=r.length,s=-1;/^group\d$/.test(e)&&(t=/device--group/);while(++s<i)t.test(r[s])&&n.$("body").removeClass(r[s])}function r(r){e!==r&&(e=r,t(r),n.$("body").addClass("device--"+r))}var e;return n.pubsub.on("deviceGroup",function(e){r(e)}),n.pubsub.on("deviceType",function(e){r(e)}),{setBodyClass:r}}(),i={toggleableComponents:[],delayedLoaders:[],currentDeviceGroup:"",toggleComponents:function(){var e=this.toggleableComponents.length,t;while(e--)t=this.toggleableComponents[e],t.updateDeviceGroupVisibility(this.currentDeviceGroup)},checkLoadDelayedComponents:function(){var e=this.delayedLoaders.length,t=0,n;while(t<e)n=this.delayedLoaders[t],n.loadIfShouldBeVisible(this.currentDeviceGroup)?(this.toggleableComponents.push(n),this.delayedLoaders.splice(t,1),e--):t++},initialiseLoaders:function(){var e=document.querySelectorAll("[data-comp-meta], [data-post-load-url], [data-batch-load-url]"),n=e.length;while(n--){var r=t.build(e[n],this.currentDeviceGroup);r.isToggleable&&this.toggleableComponents.push(r),r.delayedLoading&&this.delayedLoaders.push(r),r.bespokeJsOnly&&require(r.bespokeJsOnly),r.remotePortletMeta&&!r.postLoaded&&r.loadRemotePortletDependency(r.remotePortletMeta),r.hasShowMoreButton?r.addShowMoreButton():r.postLoaded&&r.loadIfShouldBeShown(this.currentDeviceGroup)}},init:function(){r.setBodyClass(e.getGroup()),r.setBodyClass(e.getType()),this.currentDeviceGroup=e.getGroup(),n.pubsub.on("deviceGroup",function(e){this.currentDeviceGroup=e,this.checkLoadDelayedComponents(),this.toggleComponents()}.bind(this)),this.initialiseLoaders()}};i.init()}),define("module/request",["module/bootstrap"],function(e){var t=e.$,n=function(e){this.options=this.setOptions(e),this.url=this.options.url,this.options.getUpdatesOnInit&&this.getUpdates()};return n.prototype={setOptions:function(e){return t.extend({url:undefined,getUpdatesOnInit:!1,dataType:"jsonp",success:t.noop,error:t.noop,pending:t.noop,complete:t.noop},e)},getUpdates:function(){if(!this.url)throw new Error("url is not set");var e={url:this.url,dataType:this.options.dataType};this.options.dataType==="jsonp"&&(e.jsonpCallback="callback");var n=t.ajax(e);n.state()==="pending"&&this.options.pending(),n.done(t.proxy(function(e){this.options.success(e)},this)).fail(t.proxy(function(e){this.options.error(e)},this)).always(t.proxy(function(){this.options.complete()},this))},setUrl:function(e){this.url=e},getUrl:function(){return this.url}},n}),define("module/stream/endpoint",["module/request"],function(e){return function(t,n,r,i){var s=function(e,t){n.trigger(r+e,t)},o=!1,u={url:t,success:function(e){o=!1,e.html&&e.jsDependencies&&s(":html-with-js",e),e.updates&&s(":updates",e.updates),e.endpoints&&s(":endpoints",e.endpoints),e.endpoints&&e.endpoints[r]?a.setUrl(e.endpoints[r]):s(":noupdates")},error:function(e){o=!1,s(":error",e)},pending:function(){s(":requesting")}};i==="json"&&(u.dataType="json");var a=new e(u);return{request:function(){o||(a.getUpdates(),o=!0)},setUrl:function(e){a.setUrl(e)}}}}),define("module/stream/show_more_button",["module/bootstrap","translator"],function(e,t){var n=e.$,r=['<button class="show-more">','<span class="show-more__inner">','<span class="show-more__label">{{label}}</span>','<span class="show-more__spinner"></span>',"</span>","</button>"].join(""),i={loading:"show-more--loading"},s=function(e){var n;return e?n={normal:t.get("moreInfo"),loading:t.get("loading")}:n={normal:t.get("streamShowMoreButton"),loading:t.get("loading")},n};return function(e){var t=s(e),o=n(r.replace("{{label}}",t.normal)),u=o.find(".show-more__label"),a=n({});return o.on("click",function(e){a.trigger("click")}),{appendTo:function(e){o.appendTo(e)},element:o[0],remove:function(){o.detach()},on:function(e,t){a.on(e,t)},setNormal:function(){u.text(t.normal),o.removeClass(i.loading)},setLoading:function(){u.text(t.loading),o.addClass(i.loading)}}}}),define("module/alternativeJsStrategy/moreButton",["module/bootstrap","module/featureDetector","module/stream/endpoint","module/alternativeJsStrategy/processJsDependencies","module/stream/show_more_button"],function(e,t,n,r,i){t.can("CssTransition")&&e.$("body").addClass("css-anim");var s=function(t,r){var s=document.getElementById(t),o=e.$({});this.contentContainer=s.querySelector(".show-more-container"),this.$contentContainer=e.$(this.contentContainer),this.elementId=t,this.endpoint=new n(r,o,"more-button","json"),this.button=new i(!0),o.on("more-button:requesting",this.handleRequesting.bind(this)),o.on("more-button:html-with-js",this.handleNewContent.bind(this)),o.on("more-button:noupdates",this.button.remove.bind(this)),o.on("more-button:error",this.button.remove.bind(this)),this.button.on("click",this.handleShowMoreClick.bind(this)),this.button.appendTo(s)};return s.prototype.handleShowMoreClick=function(){this.endpoint.request()},s.prototype.handleRequesting=function(){this.button.setLoading()},s.prototype.handleNewContent=function(e,t){var n,i=document.createElement("div");i.innerHTML=t.html;var s=i.querySelector("a");this.$contentContainer.append(i.childNodes),s.focus(),t.moreContentUrl?(this.endpoint.setUrl(t.moreContentUrl),this.button.setNormal()):this.button.remove(),r(t.jsDependencies,this.elementId)},s}),define("module/assortedUtils",[],function(){function e(e){var t;try{t=JSON.parse(e)}catch(n){}return t}function t(e,t,n){for(var r=0;r<e.length;r++)t.call(n,e[r],r)}function n(e){function t(){}return t.prototype=e,new t}function r(e,n){t(n,function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})}function i(e){return e===null||typeof e=="undefined"}return{forEach:t,jsonParse:e,objectCreate:n,mergeObject:r,isNullOrUndefined:i}}),define("module/cookieUtils",[],function(){function e(){}return e.prototype.readCookie=function(e){var t=window.bbccookies.get().split(";"),n,r;for(r in t)if(t.hasOwnProperty(r)){n=t[r].replace(/^\s+/g,"");if(n.indexOf(e)===0)return n.substring((e+"=").length,n.length)}return""},e.prototype.setCookie=function(e,t,n){var r=window.location.hostname,i="";r.match(/bbc.com$/)?i=".bbc.com":r.match(/bbc.co.uk$/)&&(i=".bbc.co.uk");var s=new Date;s.setDate(s.getDate()+n);var o=e+"="+t+"; expires="+s.toGMTString()+"; path=/; domain=";window.bbccookies.set(o+i)},e.prototype.appendToCookie=function(e,t,n){var r=this.readCookie(e),i=r+t;this.setCookie(e,i,n)},e.prototype.removeFromCookie=function(e,t,n){var r=this.readCookie(e),i=r.replace(t,"");this.setCookie(e,i,n)},new e}),define("module/bannerUtils",["module/cookieUtils"],function(e){function r(e){this.cookieName=e.cookieName,this.cookieExpiryInDays=e.cookieExpiryInDays,this.optInValue=e.optInValue,this.optOutValue=e.optOutValue,this.surveyTakenValue=e.surveyTakenValue,this.dismissedValue=e.dismissedValue}var t,n="news-banner__orb-spacing";return r.prototype.isOptedOut=function(){return e.readCookie(this.cookieName).indexOf(this.optOutValue)>-1},r.prototype.isOptedIn=function(){return e.readCookie(this.cookieName).indexOf(this.optInValue)>-1},r.prototype.isDismissed=function(){return e.readCookie(this.cookieName).indexOf(this.dismissedValue)>-1},r.prototype.isSurveyTaken=function(){return e.readCookie(this.cookieName).indexOf(this.surveyTakenValue)>-1},r.prototype.optIn=function(){this.isOptedIn()||e.appendToCookie(this.cookieName,this.optInValue,this.cookieExpiryInDays),this.isOptedOut()&&e.removeFromCookie(this.cookieName,this.optOutValue,this.cookieExpiryInDays)},r.prototype.optOut=function(){this.isOptedOut()||e.appendToCookie(this.cookieName,this.optOutValue,this.cookieExpiryInDays),this.isOptedIn()&&e.removeFromCookie(this.cookieName,this.optInValue,this.cookieExpiryInDays)},r.prototype.setSurveyTakenCookie=function(){e.appendToCookie(this.cookieName,this.surveyTakenValue,this.cookieExpiryInDays)},r.prototype.setBannerDismissedCookie=function(){e.appendToCookie(this.cookieName,this.dismissedValue,this.cookieExpiryInDays)},r.prototype.overrideDesktopCookie=function(t,n){e.setCookie(t,n,this.cookieExpiryInDays)},r.prototype.getBannerDismissedClass=function(){return this.isDismissed(this.cookieName,this.dismissedValue)?"":"news-banner--fixed"},r.prototype.getSurveyTakenClass=function(){return this.isSurveyTaken(this.cookieName,this.surveyTakenValue)?"news-banner__survey--hidden":""},r.prototype.removeFixedModifierFromBanner=function(){var e=$("#news-banner");e.hasClass("news-banner--fixed")&&e.removeClass("news-banner--fixed")},r.prototype.addOrbFooterPadding=function(){this.isDismissed(this.cookieName,this.dismissedValue)||(t=$("#orb-footer"),t.addClass(n))},r.prototype.removeOrbFooterPadding=function(){t.hasClass(n)&&t.removeClass(n)},r.prototype.displayBanner=function(){var e=$("#news-banner__outer-container").detach();e=e.html().replace("{{explainerSurveyDisplay}}",this.getSurveyTakenClass()).replace("{{isExplainerBannerFixed}}",this.getBannerDismissedClass()),$("#page").append(e),this.addOrbFooterPadding()},r}),define("vendor/analytics/siteCatalyst",["module/bootstrap","config"],function(e,t){function n(n){function r(e){var t=new RegExp("[\\&|\\?]"+e+"=([^\\&\\#]+)"),n=window.location.search.match(t);return n?n[1]:""}if(t==null)return;this.document=n||document;var i=this,s=t.suitenameMap,o=t.service,u=r("ocid"),a=t.asset?t.asset.headline:"(none)";e.pubsub.on("rollingNews:openAccordion",function(e){var t=e.closest(".rolling-news").attr("data-asset-id"),n=e.find("a")[0].href,r={ev:"event11",gn:"ws::"+n,ch:"ws::"+t,c5:"ws::story",c6:"D=ch",c7:"ws::"+t+">"+"story",c15:"D=gn",c25:"BBCMobile",c45:o,c57:"no",v0:u,r:document.referrer};i.track(s,r)}),require(["vendor/analytics/siteCatalystSource"])}return n.prototype.track=function(e,t){var n=(Math.random()+Math.pow(10,-9)).toString().substr(2,8),r=[];for(var i in t)r.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));r=r.join("&");var s="http://sa.bbc.com/b/ss/bbcwglobalprod,"+e+"/5/"+n+"?"+r,o=new Image;o.src=s,o.className="tracking-image",this.document.body.appendChild(o)},n}),define("module/stats/statsSubscriber",["module/bootstrap","istats-1"],function(e,t){function n(e,n){this.config=e||{},this.istats=n||t,this.pageviews=[],this.hidden=[],this.links=[],this.processConfig(),this.bindEvents()}return n.prototype={bindEvents:function(){var t=this;e.pubsub.on("component:loaded",function(e){t.handleComponentLoaded(e)}),e.pubsub.on("component:postloaded",function(e){typeof e!="undefined"&&t.handlePostLoadedComponent(e)})},handleComponentLoaded:function(e){if(!this.linksContainsComponentName(e))return;this.registerTrackingLink(this.getLinkByName(e))},getLinkByName:function(e){for(var t=0,n=this.links.length;t<n;t++){var r=this.links[t];if(r.name===e)return r}return},linksContainsComponentName:function(e){for(var t=0,n=this.links.length;t<n;t++){var r=this.links[t];if(r.name===e)return!0}return!1},handlePostLoadedComponent:function(e){var t,n,r;r=this.findTrackingLinks(e);for(t=0;t<r.length;++t)n=this.findConfigLinkEntry(r[t]),n!==null&&(this.links.push(n),this.registerTrackingLink(n))},findTrackingLinks:function(t){var n=e.$(t).find("[data-entityid]");return typeof n=="undefined"?[]:this.extractTrackingNames(n)},extractTrackingNames:function(t){var n,r,i,s;s=[];for(i=0;i<t.length;++i)n=e.$(t[i]).attr("data-entityid"),r=n.indexOf("#"),r!==-1&&(n=n.substr(0,r)),s.indexOf(n)===-1&&s.push(n);return s},findConfigLinkEntry:function(e){var t,n,r;n='[data-entityid*="'+e+'"]';for(t=0;t<this.config.links.length;++t){r=this.config.links[t];if(typeof r.selector!="undefined"&&r.selector===n)return r}return null},addPageviews:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.pageviews.push(n),this.registerPageview(n)}},addHidden:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.hidden.push(n),this.registerHiddenEvent(n)}},addTrackingLinks:function(e){for(var t=0;t<e.length;t++){var n=e[t];this.links.push(n),this.registerTrackingLink(n)}},applyCountername:function(e,t){var n=this.istats.getCountername(),r=Array.prototype.slice.call(t);return r.unshift(n),e.apply(this,r)},applyLabels:function(e,t){return e.apply(this,t)},registerPageview:function(t){var n=this,r=t.on,i=t.countername;e.pubsub.on(r,function(){var e=typeof i=="function"?n.applyCountername(i,arguments):i;n.istats.log("pageview",e)})},registerHiddenEvent:function(t){var n=this,r=t.on,i=t.action_type||"event",s=t.action_name,o=t.labels||{};e.pubsub.on(r,function(){var e=n.appendLabels(o,arguments);n.istats.log(i,s,e)})},registerTrackingLink:function(e){var t=e.type||"internal",n=e.name,r=e.selector,i=e.labels;if(Object.prototype.toString.call(r)==="[object Array]")for(var s=0;s<r.length;s++)this.track(t,n,r[s],i);else this.track(t,n,r,i)},track:function(t,n,r,i){var s,o,u,a,f,l,c,h,p,d;c=e.$(r);for(u=0;u<c.length;++u){p=e.$(c[u]).find("a");for(a=0;a<p.length;++a)h=p[a],d="story_slot=%d".replace("%d",a+1),i&&(i=this.appendLabels(i,arguments),d+="&"+e.$.param(i)),h.linktrack===undefined?h.linktrack="":h.linktrack+="&",h.linktrack+=d;f=n,s=e.$(c[u]).closest("[data-entityid]"),s&&s.length>0&&(o=s.data("entityid"),l=o.replace(/.*#/,""),l!==o&&(f+="-"+l)),this.istats.track(t,{region:c[u],linkLocation:f})}},processConfig:function(){var e=this.config.pageviews||{};this.addPageviews(e);var t=this.config.hidden||{};this.addHidden(t);var n=this.config.links||{};this.addTrackingLinks(n)},appendLabels:function(e,t){return typeof e=="function"?this.applyLabels(e,t):e}},n}),define("module/stats/statsConfig",[],function(){var e=function(e){var t="";return typeof e.name!="undefined"?t=e.name:t="rmp",t};return{links:[{name:"recommendation_learn_more",selector:'[data-entityid*="recommendation_learn_more"]'},{name:"world-news-tv-programmes",selector:'[data-entityid*="world-news-tv-programmes"]'},{name:"world-news-tv-contact-us",selector:'[data-entityid*="world-news-tv-contact-us"]'},{name:"world-news-tv-radio",selector:'[data-entityid*="world-news-tv-radio"]'},{name:"more-section",selector:'[data-entityid*="more-section"]'},{name:"pictures",selector:'[data-entityid*="pictures"]'},{name:"more-corresp",selector:'[data-entityid*="csp-hyperpuff"]'},{name:"headline",selector:'[data-entityid*="correspondent-byline"]'},{name:"headline",selector:'[data-entityid*="section-label"]'},{name:"latest-posts",selector:'[data-entityid*="latest-posts"]'},{name:"more-story",selector:'[data-entityid*="more-on-this-story"]'},{name:"experts",selector:'[data-entityid*="correspondent-promotion-now"]'},{name:"most-popular",selector:'[data-entityid*="most-popular-by-day"]'},{name:"av-stories-live",selector:'[data-entityid*="av-stories-live-compact-tablet"]'},{name:"av-stories-live",selector:'[data-entityid*="av-stories-live-wide"]'},{name:"headlines-promo",selector:'[data-entityid*="headlines-promo-wide"]'},{name:"headlines-promo",selector:'[data-entityid*="headlines-promo-compact-tablet"]'},{name:"more-uk",selector:'[data-entityid*="more-uk"]'},{name:"more-news",selector:'[data-entityid*="more-news"]'},{name:"top-stories",selector:'[data-entityid*="container-top-stories"]'},{name:"top-stories",selector:'[data-entityid*="top-stories"]'},{name:"live-event-1",selector:'[data-entityid="live_event_1"]'},{name:"live-event-2",selector:'[data-entityid="live_event_2"]'},{name:"cluster1",selector:'[data-entityid*="cluster_1"]'},{name:"cluster2",selector:'[data-entityid*="cluster_2"]'},{name:"av",selector:'[data-entityid*="av-stories-now"]'},{name:"features",selector:'[data-entityid*="feature-main"]'},{name:"explainers",selector:'[data-entityid*="explainers"]'},{name:"the-reporters",selector:'[data-entityid*="the_reporters"]'},{name:"also-in-the-news",selector:'[data-entityid*="also_in_news"]'},{name:"the-papers",selector:'[data-entityid*="latest-content"]'},{name:"features-and-analysis",selector:'[data-entityid*="features-and-analysis"]'},{name:"strapline",selector:'[data-entityid*="strapline"]'},{name:"most-read",selector:'[data-entityid*="most-popular-read"]'},{name:"most-watched",selector:'[data-entityid*="most-popular-watched"]'},{name:"most-read-local",selector:".page--local .most-popular .panel-read"},{name:"most-watched-local",selector:".page--local .most-popular .panel-watched"},{name:"from-other-news-sites",selector:"#comp-from-other-news-sites",type:"external"},{name:"topical-top-story",selector:[".hard-news-unit--topical .faux-block-link__overlay-link",".hard-news-unit--topical .hard-news-unit__headline"]},{name:"topical-related-content",selector:"#topical-stories .related-content-links"},{name:"travel-local",selector:".container--travel-weather .travel"},{name:"weather-local",selector:".container--travel-weather .weather"},{name:"local-live-internal",selector:"#comp-local-live"},{name:"local-live-external",selector:"#comp-local-live",type:"external"},{name:"local-stream-story-promo",selector:".comp-stream-story-promo__link"},{name:"narrow-navigation-primary",selector:".navigation--narrow__toplevel"},{name:"narrow-navigation-secondary",selector:".secondary-navigation--narrow"},{name:"wide-navigation-primary",selector:".navigation--wide"},{name:"wide-navigation-primary-overflow",selector:".js-navigation-panel-primary"},{name:"wide-navigation-secondary",selector:".navigation-wide-list--secondary"},{name:"wide-navigation-secondary-overflow",selector:".js-navigation-panel-secondary"},{name:"navigation-bottom",selector:".navigation--bottom"},{name:"england_nav_link",selector:'[data-entityid="england_nav_link"]'},{name:"nireland_nav_link",selector:'[data-entityid="nireland_nav_link"]'},{name:"scotland_nav_link",selector:'[data-entityid="scotland_nav_link"]'},{name:"wales_nav_link",selector:'[data-entityid="wales_nav_link"]'},{name:"your-local-news",selector:".find-local-wide__location",action_name:"Locator"},{name:"connected-stream-internal",selector:["#comp-connected-stream .update .update__image","#comp-connected-stream .update .update__headline","#comp-connected-stream .update .update__body"]},{name:"connected-stream-external",selector:"#comp-connected-stream .update .update__body",type:"external"},{name:"connected-stream-more-regional-news-region",selector:".more-regional-news__regions .more-regional-news__region"},{name:"connected-stream-more-regional-news-story",selector:[".more-regional-news__regions .hard-news-unit__headline-link",".more-regional-news__regions .faux-block-link__overlay-link"]},{name:"election-2015-nation-navigation",selector:".mininav--election2015 .mininav__nation"},{name:"vocab-faq",selector:'[data-entityid*="vocab-faq"]'}],pageviews:[{on:"tabs:activate:mostread",countername:"news.popular.read.page"},{on:"tabs:activate:topstories",countername:"news.page"},{on:"tabs:activate:livetext",countername:function(e){return e.replace(/(\d+).*$/,"$1.page")}},{on:"tabs:activate:keypoints",countername:function(e){return e.replace(/(\d+).*$/,"$1.keypoints.page")}},{on:"tabs:activate:contribute",countername:function(e){return e.replace(/(\d+).*$/,"$1.contribute.page")}},{on:"map:asset:request:success",countername:function(e,t,n){return n.countername||e}}],hidden:[{on:"nav:header:open",action_name:"top_navigation_open"},{on:"nav:footer:open",action_name:"bottom_navigation_open"},{on:"locator:submitSearch",action_name:"news.locator"},{on:"locator:geoLocation",action_name:"news.locator"},{on:"video:load",action_type:"video",action_name:"load",labels:function(t){return{player_name:e(t)}}},{on:"video:play",action_type:"video",action_name:"play",labels:function(t){return{player_name:e(t)}}},{on:"video:pause",action_type:"video",action_name:"pause",labels:function(t){return{player_name:e(t)}}},{on:"video:end",action_type:"video",action_name:"end",labels:function(t){return{player_name:e(t)}}},{on:"tabs:activate:maprelated",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"related"}},{on:"tabs:activate:maptopstories",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"topstories"}},{on:"tabs:activate:mapmostwatched",action_type:"tabchange",action_name:"map-index",labels:{tab_name:"mostwatched"}},{on:"map:index:toggle",action_type:"toggle",action_name:"map-index",labels:function(e,t){return{section:e,toggle:t}}},{on:"map:asset:summary",action_type:"toggle",action_name:"map-asset-summary",labels:function(e){return{toggle:e}}},{on:"map:index:topstories",action_type:"toggle",action_name:"map-index-topstories",labels:function(e){return{toggle:e}}},{on:"medianav:select",action_type:"select",action_name:"medianav",labels:function(e,t){return{headline:e.headline,live:e.video.live,index:t}}},{on:"gallery:picture:click",action_type:"click",action_name:"gallery-enhanced"},{on:"gallery:viewer:toggle",action_type:"toggle",action_name:"gallery-enhanced-back",labels:function(e){return{position:e}}},{on:"gallery:caption:toggle",action_type:"toggle",action_name:"gallery-enhanced-caption",labels:function(e){return{toggle:e}}},{on:"gallery:imageonly:toggle",action_type:"toggle",action_name:"gallery-enhanced-image-only",labels:function(e){return{toggle:e}}},{on:"gallery:paginate:click",action_type:"click",action_name:"gallery-enhanced-paginate",labels:function(e,t){return{visibility:e,position:t}}},{on:"stories:more:success",action_type:"select",action_name:"blog-morestories",labels:function(e,t){return{request_count:t.requestCount}}},{on:"stories:fullyloaded",action_type:"event",action_name:"blog-fullyloaded"},{on:"stats:nav:narrow:primary:visibility",action_type:"toggle",action_name:"nav-narrow-primary-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:secondary:visibility",action_type:"toggle",action_name:"nav-narrow-secondary-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:footer:visibility",action_type:"toggle",action_name:"nav-narrow-footer-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:top:primary:accordion:visibility",action_type:"toggle",action_name:"nav-narrow-top-primary-accordion-visibility",labels:function(e,t){return{visibility:e,link:t}}},{on:"stats:nav:narrow:bottom:primary:accordion:visibility",action_type:"toggle",action_name:"nav-narrow-bottom-primary-accordion-visibility",labels:function(e,t){return{visibility:e,link:t}}},{on:"stats:nav:wide:primary:overflow:visibility",action_type:"toggle",action_name:"nav-wide-primary-overflow-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:wide:secondary:overflow:visibility",action_type:"toggle",action_name:"nav-wide-secondary-overflow-visibility",labels:function(e){return{visibility:e}}},{on:"stats:nav:narrow:click",action_type:"click",action_name:"nav-narrow-click",labels:function(e,t,n){return{link:e,url:t,strategy:n}}},{on:"stats:nav:wide:outsidePanel:click",action_type:"click",action_name:"nav-wide-outsidePanel-click",labels:function(e,t,n,r){return{link:e,url:t,strategy:n,withinMorePanel:r}}},{on:"stats:nav:wide:insidePanel:click",action_type:"click",action_name:"nav-wide-insidePanel-click",labels:function(e,t,n,r){return{link:e,url:t,strategy:n,withinMorePanel:r}}},{on:"banner:ticker:toggle",action_type:"toggle",action_name:"banner-ticker-click",labels:function(e){return{toggle:e}}},{on:"eucountry:toggle",action_type:"toggle",action_name:"eucountry-click",labels:function(e){return{toggle:e}}},{on:"euexplainer:toggle",action_type:"toggle",action_name:"euexplainer-click",labels:function(e){return{toggle:e}}},{on:"election:map:zoom",action_type:"zoom",action_name:"election-map-zoom",labels:function(e){return{zoom:e}}},{on:"scotref:map",action_type:"click",action_name:"scotref-map",labels:function(e){return{action:e}}},{on:"election:findaresult:change",action_type:"change",action_name:"election-findaresult-change",labels:function(e){return{url:e}}},{on:"stats:comments:open",action_type:"comments",action_name:"show_comments"},{on:"find-local:overlay:toggle",action_type:"find-local-news",action_name:"Locator",labels:function(e){return{visibility:e}}},{on:"find-local:overlay:done",action_type:"done",action_name:"Locator"},{on:"stream:refresh",action_type:"click",action_name:"stream-refresh"},{on:"stream:showmore",action_type:"click",action_name:"stream-showmore"},{on:"stream:back-to-top",action_type:"click",action_name:"stream-back-to-top"},{on:"scotref:summary:filter",action_type:"click",action_name:"scotref-table-filter",labels:function(e){return{click:e}}},{on:"marketdata:chart:toggle",action_type:"toggle",action_name:"marketdata-chart-toggle",labels:function(e){return{chart_ticker:e.chart_ticker,chart_timespan:e.chart_timespan,chart_width:e.chart_width,chart_height:e.chart_height}}},{on:"election:findYourConstituency:submitSearch",action_type:"click",action_name:"election-constituency-search-submit"},{on:"election:findYourConstituency:searchError",action_type:"click",action_name:"election-constituency-search-error",labels:function(e){return{error_type:e}}},{on:"election:summary:filter",action_type:"click",action_name:"general-elections-table-filter",labels:function(e){return{click:e}}},{on:"news:recommendation:load",action_type:"load",action_name:"news_recommendation",labels:function(e){return{content_name:e.content_name,content_count:e.content_count,rec_source:e.rec_source,rec_set:e.rec_set,breakpoint_type:e.breakpoint_type}}},{on:"news:recommendation:load_fail_api_down",action_type:"load_fail_api_down",action_name:"news_recommendation",labels:function(e){return{breakpoint_type:e.breakpoint_type}}},{on:"news:recommendation:load_fail_low_content_volume",action_type:"load_fail_low_content_volume",action_name:"news_recommendation",labels:function(e){return{breakpoint_type:e.breakpoint_type}}},{on:"betamax:video:playlist_loaded",action_type:"video",action_name:"play",labels:function(e){return{play_type:e.play_type,item_position:e.item_position,episode_id:e.vpid,section:e.section,action_location:e.action_location}}},{on:"vocab:clicked:enabled",action_type:"on",action_name:"vocab_button",labels:{vocab_on:1}},{on:"vocab:clicked:disabled",action_type:"off",action_name:"vocab_button"},{on:"vocab:cookie:vocab-enabled",labels:{vocab_on:1}},{on:"vocab:error",action_type:"vocab-error",action_name:"vocab-cymrufyw",labels:function(e){return{error_message:e}}}]}}),define("module/navigation/overflow",["module/bootstrap","translator"],function(e,t){function s(s,o,u){function S(){var e=f.filter(function(e){return this.offsetTop>0}).length;return e?!0:!1}function x(){b=n('<li class="navigation__more-button-container">                    <button class="navigation__more-button navigation-arrow" data-panel-id="'+l+'">'+t.get("navMoreButton")+'<span class="off-screen">'+t.get("navMoreLabel")+"</span></button>                </li>"),w=b.find(".navigation__more-button"),a.append(b)}function T(){var t=e.config.features2&&(e.config.features2.rtl||e.config.cssPostfix==="-rtl")?"padding-left":"padding-right";a.css(t,b.width()+"px"),a.css("max-width",p-b.width()+"px")}function N(){var e;e=(new RegExp("\\b"+d+"\\b","i")).test(this.className),e&&this.blur(),w.removeClass(d)}function C(){var e=n('<div class="navigation-panel__content"><div class="navigation-panel__inner"></div></div>'),t=n('<div class="navigation-panel navigation-panel--wide navigation-panel--closed '+l+'"></div>');t.append(e),E=e.find(".navigation-panel__inner"),s.after(t),k(),t=e=null,u.statsName&&r.emit("component:loaded",u.statsName)}function k(){var e=f,t=e.length,n=-1,r=[],i,s=!1;while(++n<t){var o=e[n],u=o.offsetTop>0;o.className=o.className.replace(/\binvisible\b/,"");if(u){s||(A(L(e,n)),s=!0);var a=o.cloneNode(!0);a=O(a),r.push(a),o.className+=" invisible"}}i=M(r),E.html(i),H()}function L(t,n){var r=t[n-1].offsetLeft;return r+=e.config.features2&&(e.config.features2.rtl||e.config.cssPostfix==="-rtl")?-b.width():t[n-1].offsetWidth,r}function A(e){b.css("left",e+"px")}function O(e){var t=e.getElementsByTagName("a");return t.length&&(t[0].className="navigation-panel-toplevel__link"),e}function M(e){var t=i.documentElement.clientWidth,n=document.createDocumentFragment();v=[],m=e,g=D(t),y=Math.ceil(m.length/g),B();for(var r=0,s=g;r<s;r++){var o=_();o.className+=" navigation-panel-toplevel--columnised-"+g;for(var u=0,a=v[r].length;u<a;u++)o.appendChild(v[r][u].cloneNode(!0));a>0&&n.appendChild(o)}return n}function _(){var e=document.createElement("ul");return e.className="navigation-panel-toplevel",e}function D(e){var t;return e>=h[2]&&e<h[3]?t=2:e>=h[3]&&e<h[4]?t=3:t=4,t}function P(){var e=0,t=1;return function(){v.push(m.slice(e,e+y)),e+=y,t++,t<=g?B():(e=0,t=1)}}function H(){a.length&&a[0].getElementsByClassName("invisible selected").length===1?(b&&b.addClass("selected"),u.overflowEvents&&r.emit("nav:selectedIsHidden")):(b&&b.removeClass("selected"),u.overflowEvents&&r.emit("nav:selectedIsVisible"))}var a=s.find("ul"),f=a.find("li"),l=a.attr("data-panel-id"),c=!1,h={2:600,3:740,4:1008},p=992,d="navigation__more-button--highlight",v,m,g,y,b,w,E;u=u||{},this.toggleMoreButtonHighlight=function(){var t;w.hasClass(d)?(N(),t="hidden"):(w.addClass(d),t="visible"),e.pubsub.emit("stats:nav:wide:"+o+":overflow:visibility",[t])},this.removeMoreButtonHighlight=function(){typeof w!="undefined"&&w.removeClass(d)},this.checkOverflowStatus=function(){S()?(c=!0,b?(b.removeClass("hidden"),k()):(x(),T(),C())):b&&c&&(c=!1,r.emit("nav:overflowEmpty",[l]),b.addClass("hidden"),N(),k())},this.checkIfSelectedIsOverflowed=function(){H()};var B=P();this.checkOverflowStatus()}var n=e.$,r=e.pubsub,i=e.window.document;return s}),define("module/navigation/wideView",["module/bootstrap","module/navigation/overflow"],function(e,t){function h(){n("body").on("click",".navigation-wide-list a",function(t){e.pubsub.emit("stats:nav:wide:outsidePanel:click",[n(t.currentTarget).text(),t.currentTarget.href,"wide",!1])}),n("body").on("click",".navigation-panel--wide a",function(t){e.pubsub.emit("stats:nav:wide:insidePanel:click",[n(t.currentTarget).text(),t.currentTarget.href,"wide",!0])});var t=".js-navigation-panel-primary li a, .js-navigation-panel-secondary li a",r="#page, .secondary-navigation--wide a, .nations-pseudo-nav";n("body").on("focus",t,function(){s=!1,i=!0}),n("body").on("blur",t,function(){s=!0,i=!1}),n("body").on("focus",r,function(){p()&&(e.pubsub.emit("nav:wide:panel:lostFocus"),s=i=!1)}),n("body").on("click",".navigation__more-button",function(t){t.preventDefault(),e.pubsub.emit("nav:more:clicked",t)})}function p(){return!i&&s}function d(){a&&(a.checkOverflowStatus(),a.checkIfSelectedIsOverflowed()),u&&f&&(f.checkOverflowStatus(),f.checkIfSelectedIsOverflowed())}function v(){a.removeMoreButtonHighlight(),f&&f.removeMoreButtonHighlight()}function m(){u.length?(a=new t(o,"primary",{statsName:"wide-navigation-primary-overflow"}),f=new t(u,"secondary",{overflowEvents:!0,statsName:"wide-navigation-secondary-overflow"})):a=new t(o,"primary",{statsName:"wide-navigation-primary-overflow"})}function g(){o=n(".navigation.navigation--wide"),u=n(".navigation-wide-list--secondary"),m(),h()}function y(){l||(g(),l=!0),d(),c=!0}function b(){l&&(v(),c=!1)}function w(e){var t=n(e.currentTarget).attr("data-panel-id");if(!t)return;t.match(/primary/)?(a.toggleMoreButtonHighlight(),f&&f.removeMoreButtonHighlight()):(f.toggleMoreButtonHighlight(),a.removeMoreButtonHighlight())}var n=e.$,r,i,s,o,u,a,f,l=!1,c=!1;return{enable:y,disable:b,toggleMoreButtonHighlights:w}}),define("module/navigation/narrowView",["module/bootstrap","translator"],function(e,t){function g(){n("body").on("click",".navigation__section",function(e){e.preventDefault(),r.emit("nav:sections:clicked",e)}),n("body").on("click",".navigation--narrow .navigation-arrow, .navigation--footer .navigation-arrow",function(e){e.preventDefault(),r.emit("nav:arrow:clicked",e)}),n("body").on("click",".navigation__footerButton",function(e){e.preventDefault(),r.emit("nav:footerButton:clicked",e)})}function y(){o=n("#navigation--bottom"),o.find(".navigation-panel").removeAttr("id"),o.find(".navigation-core-title").remove(),o.removeClass("core--with-secondary"),s=o.clone(),s.attr("id","navigation--top")}function b(){var r=e.config.service.replace(/(\w)/,function(e,t){return t.toUpperCase()});u=n(".navigation__footerButton"),a=n(".navigation--footer");var i=n('<button class="navigation__cta-footer navigation__footerButton">'+t.get("navFooterSectionsButton")+"</button>");o.before(i)}function w(){var e=f.find(".secondary-navigation__title span"),t=f.find(".selected .navigation-narrow-item span").text()||e.text();e.text(t)}function E(){l.addClass("navigation__section--enhanced"),l.removeClass("navigation__section--core"),s.addClass("navigation--narrow"),s.removeClass("navigation--bottom"),S(),n(".site-brand").after(s),p&&(x(),w(),n(".site-brand").after(f)),T()}function S(){s.children().first().removeClass("navigation--bottom__toplevel").addClass("navigation--narrow__toplevel")}function x(){if(p===!1)return;var t=n("#secondary-navigation--bottom");f=n('<div class="secondary-navigation secondary-navigation--narrow secondary-navigation--narrow-closed"></div>');if(t){var r=t.clone();r.addClass("secondary-navigation-narrow-list"),r.removeAttr("id"),r.find(".navigation-core-title").remove(),r.find(".navigation-core-index").remove(),r.removeClass("secondary-navigation--bottom"),r.find(".navigation-arrow").on("click",function(t){t.stopPropagation(),t.preventDefault(),e.pubsub.emit("nav:narrow:secondary:arrow:clicked",t)}),t.addClass("hidden"),f.append(r)}}function T(){return n(".navigation--narrow__toplevel, .navigation--bottom__toplevel").each(function(){var e=n(this).find(".selected .navigation-panel-secondary");if(e.length>0){var t=e.find(".selected");t.length===0&&e.find("li").first().addClass("selected")}}),this}function N(){return C()||k()}function C(){return f&&f.find("ul .selected").length>0}function k(){return f!==undefined&&f.children().length===0}function L(){N()?r.emit("nav:selectedIsHidden"):r.emit("nav:selectedIsVisible")}function A(){n("body").removeClass(m),e.pubsub.emit(v,["hidden"]),d=!1}function O(){n("body").addClass(m),e.pubsub.emit(v,["visible"]),d=!0}function M(e){d?A():O()}function _(){var e=n(".secondary-navigation--narrow"),t;e.hasClass("secondary-navigation--narrow-closed")?(e.removeClass("secondary-navigation--narrow-closed"),t="visible"):(e.addClass("secondary-navigation--narrow-closed"),t="hidden"),D(t)}function D(t){e.pubsub.emit("stats:nav:narrow:secondary:visibility",t)}function P(){f!==undefined&&(f.addClass("secondary-navigation--narrow-closed"),D("hidden"))}function H(t){var r=t.currentTarget;if(!r||!r.href)return;var i=r.href.replace(/.+bbc\.co\.uk/i,""),s="navigation-arrow--open",o=".navigation--bottom__toplevel",u=".navigation--narrow__toplevel",a=o+" ."+s+", "+u+" ."+s,f=n('.navigation-arrow[href="'+i+'"]'),l=f.find("span").eq(0).text(),c="navigation-list-item--open",h;n(a).not(f).removeClass(s),n("."+c).removeClass(c),f.hasClass(s)?(f.removeClass(s),h="hidden"):(f.addClass(s),n(r).parent().addClass(c),h="visible"),e.pubsub.emit("stats:nav:narrow:top:primary:accordion:visibility",[h,l])}function B(){var e="navigation__footer--open",t;a.hasClass(e)?(a.removeClass(e),t="hidden"):(a.addClass(e),t="visible"),r.emit("stats:nav:narrow:footer:visibility",[t])}function j(){L()}function F(){n(".navigation-arrow--open").removeClass("navigation-arrow--open"),p&&f&&f.addClass("secondary-navigation--narrow-closed"),l.removeClass("navigation__section--open"),n("body").removeClass("narrow-primary-navigation-open")}function I(){l=n(".navigation__section"),c=n("#page"),g(),y(),b(),E(),L(),h=!0,r.emit("nav:narrow:loaded")}function q(){h?j():I()}function R(){h&&F()}var n=e.$,r=e.pubsub,i=e.window,s,o,u,a,f,l,c,h=!1,p=!0,d=!1,v="stats:nav:narrow:primary:visibility",m="narrow-primary-navigation-open";return{enable:q,disable:R,togglePrimaryNav:M,toggleSecondaryNav:_,hidePrimaryNav:A,hideSecondaryNav:P,accordionNavItem:H,publishSelectedVisibilityState:L,toggleFooterNav:B}}),define("module/navigation/panels",["module/bootstrap"],function(e){function s(e){return r[e]||(r[e]=t("."+e)),r[e]}function o(e){var s=e?[t("."+e)]:r;for(var o in s)s[o].hasClass(i)||s[o].addClass(i);n.emit("nav:overflow:toggle","hidden")}function u(){t(".navigation--narrow__toplevel .navigation-arrow").each(function(e,n){var i=t(n).attr("data-panel-id");i&&(r[i]=t("."+i))})}function a(){var e="navigation-panel--wide";r[e]=t("."+e)}function f(e){var r=e.currentTarget,u=t(r).attr("data-panel-id"),a=s(u),f;return a.hasClass(i)?(o(),a.removeClass(i),f=!0,n.emit("nav:overflow:toggle","visible")):(a.addClass(i),f=!1,n.emit("nav:overflow:toggle","hidden")),f}var t=e.$,n=e.pubsub,r={},i="navigation-panel--closed";return{cacheNarrow:u,cacheWide:a,close:o,togglePanel:f}}),define("vendor/locator/main",["module/bootstrap","locator/locatorView","locator/stats"],function(bootstrap,LocatorView,Stats){function doRequest(url,success,actionType,complete){typeof complete=="function"&&(complete=function(){}),bootstrap.ajax({url:url,dataType:"json",method:"get",complete:complete,success:success,error:function(e){var responseText,response;responseText=e&&e.responseText?e.responseText:"{}";try{response=window.JSON?window.JSON.parse(responseText):eval("("+responseText+")")}catch(err){response=null}bootstrap.pubsub.emit("locator:error",[response,actionType])}})}function normaliseCoordinate(e){var t=1e3;return String(Math.round(e*t)/t)}var Locator,newsMap={3:"england/berkshire",4:"england/birmingham_and_black_country",7:"england/bristol",8:"england/cambridgeshire",11:"england/cornwall",12:"england/coventry_and_warwickshire",13:"england/cumbria",16:"england/derbyshire",17:"england/devon",18:"england/dorset",19:"scotland/edinburgh_east_and_fife",20:"england/essex",22:"scotland/glasgow_and_west",23:"england/gloucestershire",26:"world/europe/guernsey",27:"england/hampshire",28:"england/hereford_and_worcester",30:"scotland/highlands_and_islands",31:"england/humberside",32:"world/europe/isle_of_man",33:"world/europe/jersey",34:"england/kent",35:"england/lancashire",36:"england/leeds_and_west_yorkshire",37:"england/leicester",38:"england/lincolnshire",39:"england/merseyside",40:"england/london",41:"england/manchester",42:"wales/mid_wales",43:"england/norfolk",44:"england/northamptonshire",45:"scotland/north_east_orkney_and_shetland",46:"wales/north_east_wales",21:"northern_ireland",47:"wales/north_west_wales",49:"england/nottingham",50:"england/oxford",57:"england/south_yorkshire",51:"england/shropshire",52:"england/somerset",53:"wales/south_east_wales",55:"scotland/south_scotland",56:"wales/south_west_wales",58:"england/stoke_and_staffordshire",59:"england/suffolk",66:"england/surrey",60:"england/sussex",61:"scotland/tayside_and_central",62:"england/tees",1:"england/beds_bucks_and_herts",63:"england/tyne_and_wear",65:"england/wiltshire",48:"england/york_and_north_yorkshire"},newsRegionsMap={56:"South West Wales",28:"Hereford &amp; Worcester",36:"Leeds and Bradford",60:"Sussex",61:"Tayside &amp; Central Scotland",62:"Tees",63:"Tyne and Wear",35:"Lancashire",66:"Surrey",34:"Kent",26:"Guernsey",27:"Hampshire",20:"Essex",21:"Northern Ireland",48:"York &amp; North Yorkshire",49:"Nottinghamshire",46:"North East Wales",47:"North West Wales",44:"Northampton",45:"North East Scotland Orkney &amp; Shetland",42:"Mid Wales",43:"Norfolk",40:"London",41:"Manchester",1:"Beds Herts &amp; Bucks",3:"Berkshire",4:"Birmingham and Black Country",7:"Bristol",8:"Cambridgeshire",13:"Cumbria",12:"Coventry &amp; Warwickshire",30:"Highlands &amp; Islands",58:"Stoke &amp; Staffordshire",11:"Cornwall",39:"Liverpool",38:"Lincolnshire",59:"Suffolk",22:"Glasgow &amp; West of Scotland",17:"Devon",16:"Derby",19:"Edinburgh Fife &amp; East of Scotland",18:"Dorset",31:"Humberside",23:"Gloucestershire",51:"Shropshire",50:"Oxford",53:"South East Wales",52:"Somerset",33:"Jersey",55:"South Scotland",37:"Leicestershire",32:"Isle of Man",57:"Sheffield &amp; South Yorkshire",65:"Wiltshire"},newsTldMap={56:"southwestwales",42:"midwales",50:"oxford",60:"sussex",61:"taysideandcentralscotland",62:"tees",63:"tyne",49:"nottingham",66:"surrey",52:"somerset",53:"southeastwales",26:"guernsey",27:"hampshire",20:"essex",21:"northernireland",22:"glasgowandwestscotland",23:"gloucestershire",46:"northeastwales",47:"northwestwales",44:"northampton",45:"northeastscotlandnorthernisles",28:"herefordandworcester",43:"norfolk",40:"london",41:"manchester",1:"threecounties",3:"berkshire",4:"birmingham",7:"bristol",8:"cambridgeshire",39:"liverpool",38:"lincolnshire",58:"stoke",11:"cornwall",51:"shropshire",13:"cumbria",12:"coventry",59:"suffolk",48:"york",17:"devon",16:"derby",19:"edinburghandeastscotland",18:"dorset",31:"humberside",30:"highlandsandislands",37:"leicester",36:"leeds",35:"lancashire",34:"kent",33:"jersey",55:"southscotland",32:"isleofman",57:"sheffield",65:"wiltshire"},nationsMap={e:"england",n:"northernireland",s:"scotland",w:"wales"};return Locator=function(e){var t,n,r,i,s;t=this,r=!1,e=e||{},this.host=e.host||"",this.getLocation(),this.action="",e.pubsub&&(bootstrap.pubsub=e.pubsub),this._persistLocation=e.persistLocation||!1,s=!!e.confirmLocationSelection,this.confirmLocationSelection=s,i=new Stats(bootstrap.pubsub),i.applyEvents(),bootstrap.pubsub.on("locator:open",function(i){if(!r){r=!0,n=new LocatorView(i,{enableReverseGeocode:e.enableReverseGeocode!==!1,enableAutoComplete:e.enableAutoComplete!==!1}),t.location&&t._persistLocation===!0?bootstrap.pubsub.emit("locator:renderChangePrompt"):bootstrap.pubsub.emit("locator:renderForm");var o=t.getNewsRegionChoices();o.length>1&&(bootstrap.pubsub.emit("locator:renderForm"),bootstrap.pubsub.emit("locator:newsLocalRegions",[{location:{id:t.location.id},regions:o}])),bootstrap.pubsub.on("locator:locationSelected",function(e){s?t.action==="geolocate"?n.renderGeolocationResult(e):n.results.children.length===0&&n.renderSearchResults({results:[e]}):n.resetForm()}),bootstrap.pubsub.on("locator:newsLocalRegions",function(){s&&n.setMoreResultsDisplay("none")})}}),bootstrap.pubsub.on("locator:close",function(e){r&&(r=!1,n.close(),n=null)}),bootstrap.pubsub.on("locator:geoLocation",function(e){t.geoLocate(e.coords.latitude,e.coords.longitude)}),bootstrap.pubsub.on("locator:submitSearch",function(e,n){t.search(e,n)}),bootstrap.pubsub.on("locator:submitLocation",function(e,n){t.checkLocation(e,n)}),bootstrap.pubsub.on("locator:submitAutoCompleteSearch",function(e){t.autoComplete(e)}),bootstrap.pubsub.on("locator:submitAutoCompleteLocation",function(e,n){t.checkLocation(e,null)})},Locator.prototype.open=function(e){bootstrap.pubsub.emit("locator:open",[e])},Locator.prototype.close=function(){bootstrap.pubsub.emit("locator:close")},Locator.prototype.handleLocation=function(e){this.locationSelection=e,this._persistLocation===!0?(this.persistLocation(e),bootstrap.pubsub.emit("locator:renderChangePrompt"),bootstrap.pubsub.emit("locator:locationChanged",[this.getLocation()])):bootstrap.pubsub.emit("locator:locationSelected",[e])},Locator.prototype.checkLocation=function(e,t){var n=this,r=this.host+"/locator/news/responsive/location.json?id="+e;this.confirmLocationSelection||bootstrap.pubsub.emit("locator:renderWait"),t&&(r+="&newsRegion="+t),doRequest(r,function(e){n.handleResponse(e)},"location")},Locator.prototype.handleResponse=function(e){"search_results"===e.type?bootstrap.pubsub.emit("locator:searchResults",[e]):"autocomplete_search_results"===e.type?bootstrap.pubsub.emit("locator:autoCompleteSearchResults",[e]):"news_regions"===e.type?bootstrap.pubsub.emit("locator:newsLocalRegions",[e]):"geolocation"===e.type?e.isWithinContext||bootstrap.pubsub.emit("locator:locationOutOfContext",[e]):"location"===e.type&&this.handleLocation(e)},Locator.prototype.setLocServCookie=function(e){var t,n;e=e||{},e.type==="location"&&e.cookie&&e.expires&&(n=this.getCookieDomain(window.location.hostname),!1!==n&&(t="locserv="+e.cookie+"; expires="+(new Date(e.expires*1e3)).toUTCString()+"; path=/; domain="+n,this.setCookieString(t),this.hasParsedCoookie=!1))},Locator.prototype.getCookieDomain=function(e){var t;return typeof e!="string"?!1:(t=e.match(/bbc\.co(\.uk|m)$/),t&&t.length===2?"."+t[0]:!1)},Locator.prototype.persistLocation=function(e,t){var n,r,i;if(this._persistLocation===!1)return;i=this;if(!e&&!t&&typeof this.locationSelection=="object"||typeof e=="object"&&e===this.locationSelection){this.setLocServCookie(this.locationSelection);return}if(e&&t){e=e.toString();if(this.locationSelection&&this.locationSelection.id===e&&this.locationSelection.news.id===t){this.setLocServCookie(this.locationSelection);return}r=this.host+"/locator/news/responsive/location.json?id="+e,r+="&newsRegion="+t,doRequest(r,function(e){i.setLocServCookie(e)},"location");return}typeof e=="object"&&this.setLocServCookie(e)},Locator.prototype.search=function(e,t){var n=this.host+"/locator/news/responsive/search.json?search="+encodeURIComponent(e),r=this;this.action="search",t&&(n+="&offset="+t),bootstrap.pubsub.emit("locator:renderWait"),doRequest(n,function(e){r.handleResponse(e)},"search")},Locator.prototype.autoComplete=function(e){var t=this.host+"/locator/news/responsive/autocomplete.json?search="+e,n=this;doRequest(t,function(e){n.handleResponse(e)},"autocomplete")},Locator.prototype.geoLocate=function(e,t){var n=this.host+"/locator/news/responsive/geolocate.json?"+"latitude="+normaliseCoordinate(e)+"&longitude="+normaliseCoordinate(t),r=this;this.action="geolocate",bootstrap.pubsub.emit("locator:renderWait"),doRequest(n,function(e){r.handleResponse(e)},"geolocate")},Locator.prototype.getCookieString=function(){return document.cookie},Locator.prototype.setCookieString=function(e){document.cookie=e},Locator.prototype.getNewsRegionChoices=function(){var e,t,n,r;n=[],t=this.getCookieString().match(/locserv=[\w\W]*?(r=([\d+\.?]+))[;|\s|$]?/);if(t){e=t[2].split(".");for(r=0;r<e.length;r++)n.push({id:newsTldMap[e[r]],name:newsRegionsMap[e[r]]})}return n},Locator.prototype.getLocation=function(){var e,t,n,r,i;if(this.hasParsedCoookie)return this.location;r=function(e){var t,n,r,i,s={};n=e.substr(0,1),e=e.substr(3),r=e.split(":");for(t=0;t<r.length;t++)i=r[t].split("="),i[1]=i[1].replace(/\+/g,"%20"),s[i[0]]=decodeURIComponent(i[1]);return{name:n,data:s}},e=this.getCookieString().match("locserv=(.*?)(;|$)");if(!e||e.length<2)return null;this.location={id:null,name:null,nation:null,news:null,weather:null},t=e[1].substr(2).split("@");for(i=0;i<t.length;i++)n=r(t[i]),"l"===n.name?(this.location.id=n.data.i,this.location.name=n.data.n,n.data.h&&(this.location.nation=nationsMap[n.data.h])):"w"===n.name?this.location.weather={id:n.data.i,name:n.data.p}:"n"===n.name&&(this.location.news={id:n.data.r,path:newsMap[n.data.r]});return this.hasParsedCoookie=!0,this.location},Locator.prototype.setPersistance=function(e){var t=this._persistLocation;return this._persistLocation=e,t},Locator}),define("module/locatorInstance",["config","module/bootstrap","vendor/locator/main"],function(e,t,n){return new n({pubsub:t.pubsub,enableReverseGeocode:e.local&&e.local.allowLocationLookup?e.local.allowLocationLookup:!1,enableAutoComplete:e.local&&e.local.allowAutoComplete?e.local.allowAutoComplete:!1,host:e.locatorHost,confirmLocationSelection:!0,persistLocation:!0})}),define("module/locatorFacade",["config","module/locatorInstance"],function(e,t){var n=function(){return t.getNewsRegionChoices()},r=function(){return t.getLocation()},i=function(){return e.pathPrefix+"/"+t.getLocation().news.path},s=function(e){t.open(e)},o=function(e){t.handleLocation(e)},u=function(e,n){t.close(),t.setPersistance(n),t.open(e)},a=function(e){return t.setPersistance(e)},f=function(e){return t.persistLocation(e)};return{getNewsRegionChoices:n,getLocation:r,getLocationIndexUrl:i,open:s,handleLocation:o,insert:u,setPersistance:a,persistLocation:f}}),define("module/findLocalNews",["module/bootstrap","module/locatorFacade","translator"],function(e,t,n){var r,i=!1,s=".locator",o=!1,u=!1,a,f="content-interstitial-overlay-open",l=function(){return e.$(".find-local-wide").length!==0},c=function(){var e=t.getNewsRegionChoices(),n="";return e instanceof Array&&e.length>=1&&e[0].name&&(n=e[0].name),n},h=function(){var n=c(),r="",i,s,o;""!==n&&(e.$(".find-local-wide__link").addClass("find-local-wide__link--icon-only"),o='<a href="'+t.getLocationIndexUrl()+'" class="find-local-wide__location">'+n+"</a>",s=e.$(".find-local-wide__location"),s.length>0?s.replaceWith(o):e.$("#find-local-wide").prepend(o),e.pubsub.emit("component:loaded",["find-local-location-wide"]))},p=function(){var t=c(),r="",i=n.get("locationSettings");return""!==t&&(r=n.get("locationYourLocationIs").replace("@","<strong>"+t+"</strong>")),e.$(".site-brand").after('<div class="find-local-overlay">                <div class="find-local-overlay__inner">                    <h2 class="find-local-overlay__title">'+i+'</h2>                    <p class="find-local-overlay__current-location">'+r+'</p>                    <div class="find-local-overlay__locator">                    </div>                </div>                <div class="find-local-overlay__controls">                    <button type="button" class="find-local-overlay__cancel">Cancel</button>                    <button type="button" class="find-local-overlay__done" disabled="">Done</button>                </div>            </div>'),e.$(".find-local-overlay")},d=function(){e.$(".find-local-overlay__cancel").on("click",v),e.$(".find-local-overlay__done").on("click",g)},v=function(){i&&t.insert(s,!0),e.$("body").removeClass(f).css({height:"",backgroundColor:""}),e.$("#nations-pseudo-nav").removeClass("nations-pseudo-nav--hidden"),e.$("#orb-footer").css("display","block"),e.$("#services-bar").css("display","block"),e.$(".find-local-wide").removeClass("hidden"),u&&m("hidden"),u=!1},m=function(t){e.pubsub.emit("find-local:overlay:toggle",t)},g=function(){r!==null&&(t.setPersistance(!0),t.persistLocation(r),e.pubsub.emit("find-local:overlay:done"),window.location.href=t.getLocationIndexUrl())},y=function(){o?e.$(".find-local-overlay__done").prop("disabled",!0):(o=!0,p(),d()),t.insert(".find-local-overlay__locator",!1),r=null,e.$("body").addClass(f).css({height:"100%",backgroundColor:"#000"}),e.$("#nations-pseudo-nav").addClass("nations-pseudo-nav--hidden"),e.$("#orb-footer").css("display","none"),e.$("#services-bar").css("display","none"),e.$(".find-local-wide").addClass("hidden");var n=e.$("#locator-search-input");n.length>0&&n[0].focus(),u=!0,m("visible"),e.pubsub.emit("findLocal:overlayVisible")},b=function(){e.$(".find-local-narrow").addClass("navigation-arrow--open"),a?a.addClass("find-local-narrow-panel--open"):(e.$(".find-local-narrow").after('<div class="find-local-narrow-panel find-local-narrow-panel--open"><a class="find-local-narrow-panel__index-link" href='+t.getLocationIndexUrl()+">"+c()+'</a>                    <button id="change-location-narrow" class="change-location-narrow">Change location</button>                </div>'),a=e.$(".find-local-narrow-panel"))},w=function(){e.$(".find-local-narrow").removeClass("navigation-arrow--open"),a&&a.removeClass("find-local-narrow-panel--open")},E=function(){e.$(".find-local-narrow").hasClass("navigation-arrow--open")?w():b()},S=function(){e.$("#site-container").on("click",".find-local-wide__link, #change-location-narrow",y),e.pubsub.on("locator:submitSearch",function(){r=null,e.$(".find-local-overlay__done").prop("disabled",!0)}),e.pubsub.on("locator:locationSelected",function(t){r=t,e.$(".find-local-overlay__done").prop("disabled",!1)}),e.pubsub.on("locator:locationChanged",h),e.$("#site-container").on("click",".find-local-narrow",function(){t.getLocation()?E():y()})},x=function(){if(l()){var t='                <li><button class="find-local-narrow navigation-narrow-item navigation-arrow"><span>Your local news</span></button></li>            ';e.$("#navigation--top li").eq(0).after(t)}},T=function(){l()&&(S(),h(),i=e.$(s).length===1)};return{init:T,closeNarrowPanel:w,showOverlay:y,hideOverlay:v,insertIntoNarrowNav:x}}),define("module/indexTitle",["module/bootstrap"],function(e){function i(){if(typeof t=="undefined"){var r=e.$(n),i=r.data("index-title-meta")||null,s=!1,o=!1;i&&i.opts&&(s=i.opts.alwaysVisible||!1,o=i.opts.onFrontPage||!1),t={element:r,alwaysVisible:s,onFrontPage:o}}return t}var t,n="#comp-index-title",r="index-title--redundant",s=function(){},o=function(){},u=function(t){var r=e.$(n+" .index-title__container"),i=r.length!==0?r:e.$(n);i.length!==0&&i.html(t)},a=function(){i().onFrontPage||i().element.removeClass(r)},f=function(){i().alwaysVisible||i().element.addClass(r)},l=function(){i().element.hasClass(r)?a():f()},c=function(){i().onFrontPage||a()};return{getIndexTitle:i,setTitleHtml:u,setAnchorAttribute:s,appendToTitle:o,show:a,hide:f,toggle:l,init:c}}),define("module/navigation/mediaPlaceholder",["module/bootstrap"],function(e){var t=e.$(".media-placeholder"),n="media-placeholder--hidden",r="active",i=!1;return{activate:function(){i=!0},show:function(){i&&t.removeClass(n)},hide:function(){i&&t.addClass(n)}}}),define("module/components/mediaPlayer/eventDelegator",["module/bootstrappedJquery"],function(e){function r(e,r,i){e.bind(r,function(s){var o=i?s:e;t.trigger(r,o),n.push({event:r,params:[undefined,o]})})}function i(e){r(e,"initialised"),r(e,"playing"),r(e,"pause"),r(e,"ended"),r(e,"error",!0)}function s(e,t){for(var r=0;r<n.length;r++)n[r].event===e&&t.apply(this,n[r].params)}function o(e,n,r){t.on(e,n),r&&s(e,n)}var t=e({}),n=[];return{addPlayer:i,subscribe:o}}),define("module/components/mediaPlayer/view",["module/assortedUtils","module/bootstrappedJquery"],function(e,t){function i(){return document.querySelectorAll(".js-media-player-unprocessed")}function s(){return document.querySelector(".media-player")}function o(e,t){e.setAttribute("id",t)}function u(e){t(e).removeClass("js-media-player-unprocessed")}function a(e){var n=document.querySelector(e+" .media-player");t(n).addClass("js-media-player-unprocessed")}function f(e){return n(e.getAttribute("data-playable"))}function l(e){return e?e.offsetWidth:null}function c(e){t(e).addClass(r)}function h(e){t(e).removeClass(r)}var n=e.jsonParse,r="media-player--hidden";return{findFirstMediaPlaceholder:s,findUnprocessedMediaPlaceholders:i,getPlayableForPlaceholder:f,hidePlayers:c,markPlaceholderAsProcessed:u,activatePlaceholder:a,setPlaceholderId:o,getPlaceholderWidth:l,showPlayers:h}}),define("module/components/mediaPlayer/flashPlayerHandler",["module/components/mediaPlayer/view"],function(e){function i(i){!t&&i.name()==="smp-flash"&&(t=!0),n&&(n=!1,r?e.showPlayers():e.hidePlayers())}function s(i){t?e.hidePlayers(i):(n=!0,r=!1)}function o(i){t?e.showPlayers(i):(n=!0,r=!0)}var t=!1,n,r;return{handleNewPlayer:i,hide:s,show:o}}),define("module/components/mediaPlayer/pluginData",["module/featureDetector"],function(e){return[{loadedCallback:function(e,t){e.addEventListeners(t.instance)},path:"bbcdotcom/av/emp/analytics",shouldLoad:function(){return e.is("CollectingGNLAnalytics")||e.is("DisplayingGnlAds")}},{loadedCallback:function(e,t){e.addSmpPlugin(t.domId,t.instance)},path:"bbcdotcom/av/emp/adverts",shouldLoad:function(){return e.is("DisplayingGnlAds")}}]}),function(){function e(e){return typeof e=="function"||typeof e=="object"&&e!==null}function t(e){return typeof e=="function"}function n(e){return typeof e=="object"&&e!==null}function l(e){a=e}function c(e){f=e}function g(){var e=process.nextTick,t=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(t)&&t[1]==="0"&&t[2]==="10"&&(e=setImmediate),function(){e(x)}}function y(){return function(){u(x)}}function b(){var e=0,t=new d(x),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function w(){var e=new MessageChannel;return e.port1.onmessage=x,function(){e.port2.postMessage(0)}}function E(){return function(){setTimeout(x,1)}}function x(){for(var e=0;e<s;e+=2){var t=S[e],n=S[e+1];t(n),S[e]=undefined,S[e+1]=undefined}s=0}function T(){try{var e=require,t=e("vertx");return u=t.runOnLoop||t.runOnContext,y()}catch(n){return E()}}function C(){}function M(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function D(e){try{return e.then}catch(t){return O.error=t,O}}function P(e,t,n,r){try{e.call(t,n,r)}catch(i){return i}}function H(e,t,n){f(function(e){var r=!1,i=P(n,t,function(n){if(r)return;r=!0,t!==n?F(e,n):q(e,n)},function(t){if(r)return;r=!0,R(e,t)},"Settle: "+(e._label||" unknown promise"));!r&&i&&(r=!0,R(e,i))},e)}function B(e,t){t._state===L?q(e,t._result):t._state===A?R(e,t._result):U(t,undefined,function(t){F(e,t)},function(t){R(e,t)})}function j(e,n){if(n.constructor===e.constructor)B(e,n);else{var r=D(n);r===O?R(e,O.error):r===undefined?q(e,n):t(r)?H(e,n,r):q(e,n)}}function F(t,n){t===n?R(t,M()):e(n)?j(t,n):q(t,n)}function I(e){e._onerror&&e._onerror(e._result),z(e)}function q(e,t){if(e._state!==k)return;e._result=t,e._state=L,e._subscribers.length!==0&&f(z,e)}function R(e,t){if(e._state!==k)return;e._state=A,e._result=t,f(I,e)}function U(e,t,n,r){var i=e._subscribers,s=i.length;e._onerror=null,i[s]=t,i[s+L]=n,i[s+A]=r,s===0&&e._state&&f(z,e)}function z(e){var t=e._subscribers,n=e._state;if(t.length===0)return;var r,i,s=e._result;for(var o=0;o<t.length;o+=3)r=t[o],i=t[o+n],r?$(n,r,i,s):i(s);e._subscribers.length=0}function W(){this.error=null}function V(e,t){try{return e(t)}catch(n){return X.error=n,X}}function $(e,n,r,i){var s=t(r),o,u,a,f;if(s){o=V(r,i),o===X?(f=!0,u=o.error,o=null):a=!0;if(n===o){R(n,_());return}}else o=i,a=!0;n._state===k&&(s&&a?F(n,o):f?R(n,u):e===L?q(n,o):e===A&&R(n,o))}function J(e,t){try{t(function(n){F(e,n)},function(n){R(e,n)})}catch(n){R(e,n)}}function K(e,t){var n=this;n._instanceConstructor=e,n.promise=new e(C),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),n.length===0?q(n.promise,n._result):(n.length=n.length||0,n._enumerate(),n._remaining===0&&q(n.promise,n._result))):R(n.promise,n._validationError())}function G(e){return(new Q(this,e)).promise}function Z(e){function s(e){F(n,e)}function o(e){R(n,e)}var t=this,n=new t(C);if(!i(e))return R(n,new TypeError("You must pass an array to race.")),n;var r=e.length;for(var u=0;n._state===k&&u<r;u++)U(t.resolve(e[u]),undefined,s,o);return n}function tt(e){var t=this;if(e&&typeof e=="object"&&e.constructor===t)return e;var n=new t(C);return F(n,e),n}function rt(e){var t=this,n=new t(C);return R(n,e),n}function ot(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ut(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function ft(e){this._id=st++,this._state=undefined,this._result=undefined,this._subscribers=[],C!==e&&(t(e)||ot(),this instanceof ft||ut(),J(this,e))}function lt(){var e;if(typeof global!="undefined")e=global;else if(typeof self!="undefined")e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n&&Object.prototype.toString.call(n.resolve())==="[object Promise]"&&!n.cast)return;e.Promise=at}var r;Array.isArray?r=Array.isArray:r=function(e){return Object.prototype.toString.call(e)==="[object Array]"};var i=r,s=0,o={}.toString,u,a,f=function(t,n){S[s]=t,S[s+1]=n,s+=2,s===2&&(a?a(x):N())},h=typeof window!="undefined"?window:undefined,p=h||{},d=p.MutationObserver||p.WebKitMutationObserver,v=typeof process!="undefined"&&{}.toString.call(process)==="[object process]",m=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined",S=new Array(1e3),N;v?N=g():d?N=b():m?N=w():h===undefined&&typeof require=="function"?N=T():N=E();var k=void 0,L=1,A=2,O=new W,X=new W;K.prototype._validateInput=function(e){return i(e)},K.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},K.prototype._init=function(){this._result=new Array(this.length)};var Q=K;K.prototype._enumerate=function(){var e=this,t=e.length,n=e.promise,r=e._input;for(var i=0;n._state===k&&i<t;i++)e._eachEntry(r[i],i)},K.prototype._eachEntry=function(e,t){var r=this,i=r._instanceConstructor;n(e)?e.constructor===i&&e._state!==k?(e._onerror=null,r._settledAt(e._state,t,e._result)):r._willSettleAt(i.resolve(e),t):(r._remaining--,r._result[t]=e)},K.prototype._settledAt=function(e,t,n){var r=this,i=r.promise;i._state===k&&(r._remaining--,e===A?R(i,n):r._result[t]=n),r._remaining===0&&q(i,r._result)},K.prototype._willSettleAt=function(e,t){var n=this;U(e,undefined,function(e){n._settledAt(L,t,e)},function(e){n._settledAt(A,t,e)})};var Y=G,et=Z,nt=tt,it=rt,st=0,at=ft;ft.all=Y,ft.race=et,ft.resolve=nt,ft.reject=it,ft._setScheduler=l,ft._setAsap=c,ft._asap=f,ft.prototype={constructor:ft,then:function(e,t){var n=this,r=n._state;if(r===L&&!e||r===A&&!t)return this;var i=new this.constructor(C),s=n._result;if(r){var o=arguments[r-1];f(function(){$(r,i,o,s)})}else U(n,i,e,t);return i},"catch":function(e){return this.then(null,e)}};var ct=lt,ht={Promise:at,polyfill:ct};typeof define=="function"&&define.amd?define("vendor/polyfill/promise",[],function(){return ht}):typeof module!="undefined"&&module.exports?module.exports=ht:typeof this!="undefined"&&(this.ES6Promise=ht),ct()}.call(this),define("module/components/mediaPlayer/pluginLoader",["module/bootstrappedJquery","module/components/mediaPlayer/pluginData","require","vendor/polyfill/promise"],function(e,t,n,r){function s(e,t,n,r,i){try{i&&t.loadedCallback(i,e)}catch(s){r(s)}n()}function o(e){return function(t){return e(t)}}function u(e,t,n,r){return function(i){return s(e,t,n,r,i)}}function a(e,t){return new i(function(r,i){if(!t.shouldLoad()){r();return}n([t.path],u(e,t,r,i),o(i))})}function f(e){return t.reduce(function(t,n){var r=a(e,n);return t.then(function(){return r}).catch(function(e){console.error(e)})},i.resolve(null))}var i=r.Promise;return f}),define("module/stats/comscoreContextID",[],function(){function e(){}var t="ckpf_sscid",n=null,r=18897612,i=r,s="bbc-global-test",o=s,u="s_vi",a="http://b.scorecardresearch.com/b",f="https://sb.scorecardresearch.com/b",l="http://ssc.api.bbc.com/",c="https://ssc.api.bbc.com/";return e.prototype.ECHO_PROFILE_WS_ACCEPTANCE="world_service_acceptance",e.prototype.readCookie=function(e){var t=window.bbccookies.get().split(";"),n,r;for(r in t)if(t.hasOwnProperty(r)){n=t[r].replace(/^\s+/g,"");if(n.indexOf(e)===0)return n.substring((e+"=").length,n.length)}return null},e.prototype.getUserTrackingCookieValue=function(){return!n&&this.isDotCom()&&(n=this.readCookie(t)),n},e.prototype.hasUserTrackingCookie=function(){return this.getUserTrackingCookieValue()!==null},e.prototype.isDotCom=function(){return/\.bbc\.com$/.test(window.location.hostname)},e.prototype.isTestEnv=function(){return/(sandbox|int|test|stage)(\.dev)*\.bbc\.co*/.test(window.location.href)},e.prototype.isSecure=function(e){return window.location.protocol==="https:"},e.prototype.getC2Value=function(){return this.isTestEnv()?r:i},e.prototype.getSiteValue=function(){return this.isTestEnv()?s:o},e.prototype.getLegacyVisitorAlias=function(){return this.readCookie(u)},e.prototype.getBaseUrl=function(){return this.hasUserTrackingCookie()?this.getScorecardBaseUrl():this.getSscBaseUrl()},e.prototype.getSscBaseUrl=function(){return this.isSecure()?c:l},e.prototype.getScorecardBaseUrl=function(){return this.isSecure()?f:a},new e}),define("module/stats/comscore",["module/stats/comscoreContextID","module/bootstrap","module/assortedUtils","deviceInspector"],function(e,t,n,r){function u(e){this.config=e,this.asset=e.asset}function a(e){if(e&&typeof e.date=="string"){var t=e.date.split(" "),n=new Date(t[0]+"T"+t[1]+"Z");return Math.floor(n.getTime()/1e3)}}var i=t.$,s=n.mergeObject,o=n.isNullOrUndefined;return u.IMPLEMENTATION_VERSION="1.0.0.0",u.EVENT_TYPE_PAGE_VIEW="2",u.BUSINESS_UNIT_WS="ws",u.BUSINESS_UNIT_NONE=null,u.PROJECT_SOURCE_WS="ws",u.PROJECT_SOURCE_NONE=null,u.ASSET_HEADLINE_NONE=null,u.PAGE_TYPE_NONE="na",u.VIRTUAL_SITE_NONE=null,u.prototype.sendPageViewBeacon=function(){this.sendBeacon(this.getBeaconUrl(this.getPageViewBeacon()))},u.prototype.sendClickBeacon=function(e){this.sendBeacon(this.getBeaconUrl(this.getClickBeacon(e)))},u.prototype.sendBeacon=function(e){var t=document.createElement("img");t.src=e,t.style.display="none",t.className="comscore-tracking-beacon",document.body.appendChild(t)},u.prototype.getBeaconUrl=function(t){t=this.filterBeaconValues(t);var n=t.c9;delete t.c9;var r=e.getBaseUrl(t);return r+"?"+i.param(t)+"&c9="+n},u.prototype.filterBeaconValues=function(e){var t={};for(var n in e)o(e[n])||(t[n]=e[n]);return t},u.prototype.getPageViewBeacon=function(){var e=this.getBaseBeacon();return s(e,[this.getSessionLabels()]),e},u.prototype.getBaseBeacon=function(){return{c2:e.getC2Value(),ns_type:"view",ns_site:e.getSiteValue(),c1:this.getEventType(),ns_alias:e.getUserTrackingCookieValue(),b_imp_src:this.getProjectSource(),b_imp_ver:u.IMPLEMENTATION_VERSION,b_s_vi:e.getLegacyVisitorAlias(),name:this.getPageName(),b_site_section:this.getSectionId(),b_page_type:this.getPageType(),c8:this.getTitle(),b_app_type:"web",b_app_name:"news|web",b_article_title:this.getAssetHeadline(),b_article_id:this.asset.asset_id,b_article_author:this.getAssetByline(),b_article_date:a(this.asset.first_created),b_article_update:a(this.asset.last_updated),b_article_length:this.getArticleLength(),b_ad_enabled:this.getAdvertisingEnabled(),ns_search_term:this.getSearchTerm(),ns_search_result:this.getSearchResults(),c9:this.getReferrer(),c7:this.getC7(),b_c7:this.getCustomPageUrl(),ns_c:this.getCharacterEncoding(),ns__t:this.getTimestamp(),b_vp:this.getViewportWidth(),b_vph:this.getViewportHeight(),b_sr:this.getScreenRes(),bbc_site:this.getVirtualSite()}},u.prototype.getClickBeacon=function(e){var t=this.getPageViewBeacon();return s(t,[{ns_type:"hidden",b_link:this.getBLink("click",e)}]),t},u.prototype.getSessionLabels=function(){return{b_vs_un:this.getBusinessUnit(),b_vs_ls:this.config.service,b_synd_partner:this.getSyndicationPartner()}},u.prototype.getViewportWidth=function(){return i(window).width()},u.prototype.getViewportHeight=function(){return i(window).height()},u.prototype.getScreenRes=function(){return window.screen.width+"x"+window.screen.height},u.prototype.getVirtualSite=function(){return"virtual_site"in this.config.comscoreAnalytics?this.config.comscoreAnalytics.virtual_site:u.VIRTUAL_SITE_NONE},u.prototype.getEventType=function(){return u.EVENT_TYPE_PAGE_VIEW},u.prototype.getBusinessUnit=function(){return this.config.isWorldService?u.BUSINESS_UNIT_WS:u.BUSINESS_UNIT_NONE},u.prototype.getProjectSource=function(){return this.config.isWorldService?u.PROJECT_SOURCE_WS:u.PROJECT_SOURCE_NONE},u.prototype.getPageName=function(){return window.location.pathname.replace("/","").replace(/\//g,".")},u.prototype.getSyndicationPartner=function(){return"bbc|rd|"+r.getGroup()},u.prototype.getSectionId=function(){if(this.asset.section)return this.asset.section.id},u.prototype.getAssetHeadline=function(){return this.asset.headline?this.asset.headline:u.ASSET_HEADLINE_NONE},u.prototype.getAssetByline=function(){if(this.asset.byline)return this.asset.byline.name},u.prototype.getPageType=function(){return this.asset.type?this.asset.type+"|na":u.PAGE_TYPE_NONE},u.prototype.getArticleLength=function(){return typeof this.asset.length=="number"?this.asset.length:null},u.prototype.getAdvertisingEnabled=function(){return this.asset.options&&this.asset.options.allowAdvertising?1:0},u.prototype.getSearchTerm=function(){return this.config.search?this.config.search.term:null},u.prototype.getSearchResults=function(){return this.config.search?this.config.search.results:null},u.prototype.getReferrer=function(){return document.referrer},u.prototype.getC7=function(){return window.location.href},u.prototype.getTitle=function(){return document.title},u.prototype.getCustomPageUrl=function(){return window.location.pathname!==this.asset.asset_uri?window.location.pathname:null},u.prototype.getCharacterEncoding=function(){return document.querySelector("meta[charset]").getAttribute("charset")},u.prototype.getTimestamp=function(){return Math.floor(+(new Date)/1e3)},u.prototype.getBLink=function(e,t){return this.getBLinkComponents(e,t).map(function(e){return o(e)?"na":e}).join("|")},u.prototype.getBLinkComponents=function(e,t){return[null,null,this.asset.type,t,null,null,null,null,this.getSectionId(),this.asset.type,null,null,e]},u}),define("module/components/mediaPlayer/comscoreSettings",["config","module/stats/comscore","module/stats/comscoreContextID"],function(e,t,n){function r(){if(!e.features2||!e.features2.comscore_analytics)return{};var r=new t(e);return{statsObject:{x_ns_site:n.getSiteValue(),deviceId:n.getUserTrackingCookieValue(),echoProfile:n.ECHO_PROFILE_WS_ACCEPTANCE,sessionLabels:r.getSessionLabels()}}}return{get:r}}),define("module/components/mediaPlayer/playlistSelector",["module/featureDetector"],function(e){function t(t){return t.progressiveDownloadUrl?t.streamingUrl?e.is("Desktop")?t.streamingUrl:e.is("Ios")&&t.mediaType==="video"?t.streamingUrl:t.progressiveDownloadUrl:t.progressiveDownloadUrl:t.streamingUrl}return{selectPlaylist:t}}),define("module/components/mediaPlayer/autoPlay",["deviceInspector"],function(e){function t(t){var n;return t&&t.otherSettings?n=t.otherSettings.isAutoplayOnForAudience:n=!1,e.getType()!=="smart"&&n}return{isEnabled:t}}),function(){function h(){}function p(e){return typeof e=="function"&&l.test(e)}function d(e){return typeof e=="function"}function v(e){return!!e&&!!n[typeof e]}function m(t,n,r){var i,s,o,u,a,f,l,h=0,p=!1,m=!0;if(!d(t))throw new TypeError;n=c(0,n)||0;if(r===!0){var y=!0;m=!1}else v(r)&&(y=r.leading,p="maxWait"in r&&(c(n,r.maxWait)||0),m="trailing"in r?r.trailing:m);var b=function(){var r=n-(g()-u);if(r<=0){s&&clearTimeout(s);var c=l;s=f=l=e,c&&(h=g(),o=t.apply(a,i),!f&&!s&&(i=a=null))}else f=setTimeout(b,r)},w=function(){f&&clearTimeout(f),s=f=l=e;if(m||p!==n)h=g(),o=t.apply(a,i),!f&&!s&&(i=a=null)};return function(){i=arguments,u=g(),a=this,l=m&&(f||!y);if(p===!1)var e=y&&!f;else{!s&&!y&&(h=u);var r=p-(u-h),c=r<=0;c?(s&&(s=clearTimeout(s)),h=u,o=t.apply(a,i)):s||(s=setTimeout(w,r))}return c&&f?f=clearTimeout(f):!f&&n!==p&&(f=setTimeout(b,n)),e&&(c=!0,o=t.apply(a,i)),c&&!f&&!s&&(i=a=null),o}}var e,t="[object Function]",n={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},r=n[typeof window]&&window||this,i=n[typeof exports]&&exports&&!exports.nodeType&&exports,s=n[typeof module]&&module&&!module.nodeType&&module,o=s&&s.exports===i&&i,u=n[typeof global]&&global;u&&(u.global===u||u.window===u)&&(r=u);var a=Object.prototype,f=a.toString,l=RegExp("^"+String(f).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),c=Math.max;d(/x/)&&(d=function(e){return typeof e=="function"&&f.call(e)==t});var g=p(g=Date.now)&&g||function(){return(new Date).getTime()};h.debounce=m,h.isFunction=d,h.isObject=v,h.now=g,h.VERSION="2.4.1",typeof define=="function"&&typeof define.amd=="object"&&define.amd?(r._=h,define("vendor/lo-dash/lo-dash",[],function(){return h})):i&&s?o?(s.exports=h)._=h:i._=h:r._=h}.call(this),define("module/imageenhancer",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){var n=function(t){function o(){s.resizeImages([s.imageReplaceNodelist,s.backgroundImageReplaceNodelist])}var n=e.$;typeof t=="string"&&n(t).each(function(e,t){n(t).addClass("js-image-replace")}),this.widths=[96,130,165,200,235,270,304,340,375,410,445,485,520,555,590,624,625,660,695,736,768,772,800,834,872,904,936,950,976,1024,1536,2048],this.programmesWidths=[96,128,160,192,208,240,272,304,336,384,416,448,480,528,560,592,624,656,688,736,768,800,832,864,912,944,960,976,1024,1536,1920],this.isResizing=!1,this.imageReplaceNodelist=null,this.backgroundImageReplaceNodelist=null,this.upscale=e.config.hasOwnProperty("imageUpscale")?e.config.imageUpscale:!0,e.config.features2&&e.config.features2.hasOwnProperty("lazy_images")?this.lazyImages=e.config.features2.lazy_images:this.lazyImages=!0;var r=e.window.document.documentElement.clientHeight,i=r&&r>400?r/2:200;this.lazyBufferZone=e.config.hasOwnProperty("imageBuffer")?e.config.imageBuffer:i;var s=this;this.changeDivsToImgs(),e.pubsub.on("imageEnhancer:resize",o),e.pubsub.on("imageEnhancer:scroll",o),e.pubsub.on("component:loaded",function(){s.changeDivsToImgs(),s.initResizeImages()}),e.pubsub.on("component:postloaded",function(){s.changeDivsToImgs(),s.initResizeImages()}),setTimeout(function(){s.initResizeImages()},250)};return n.prototype={changeDivsToImgs:function(){$("div.js-delayed-image-load").each(function(e,t){t=typeof t!="number"?t:e;var n=t.getAttribute("data-width"),r=t.getAttribute("data-height"),i="";n>0&&r>0&&(i=' width="'+t.getAttribute("data-width")+'" height="'+t.getAttribute("data-height")+'"'),$(t).replaceWith('<img src="data:image/gif;base64,R0lGODlhEAAJAIAAAP///wAAACH5BAEAAAAALAAAAAAQAAkAAAIKhI+py+0Po5yUFQA7" datasrc="'+t.getAttribute("data-src")+'" class="responsive-image__img responsive-image__img--loading js-image-replace" alt="'+t.getAttribute("data-alt")+'"'+i+" />")})},initResizeImages:function(){this.imageReplaceNodelist=$(".js-image-replace"),this.backgroundImageReplaceNodelist=$(".js-bg-image-replace"),this.resizeImages([this.imageReplaceNodelist,this.backgroundImageReplaceNodelist]),window.addEventListener?(window.addEventListener("resize",function(){e.pubsub.emit("imageEnhancer:resize")},!1),this.lazyImages&&this.addScrollEventListener()):window.attachEvent("resize",function(){e.pubsub.emit("imageEnhancer:resize")})},addScrollEventListener:function(){window.addEventListener("scroll",t.debounce(function(){e.pubsub.emit("imageEnhancer:scroll")},100),!1)},removeLoadingClass:function(){$(this).removeClass("responsive-image__img--loading")},resizeImages:function(e){if(!this.isResizing){this.isResizing=!0;for(var t=0,n=e.length;t<n;t++){var r=e[t];if(r!==null)for(var i=0,s=r.length;i<s;i++){var o=r[i];if(o.getAttribute("class").match("no-replace"))continue;if(this.lazyImages&&this.isBelowFold($(window),$(o)))continue;this.upscale===!1&&!o.style.maxWidth&&o.hasAttribute("width")&&(o.style.maxWidth=o.getAttribute("width")+"px"),$(o).on("load",this.removeLoadingClass);var u=this.calcImgSrc(o.getAttribute("datasrc")||o.getAttribute("databgsrc")||o.src,o.clientWidth);o.src?!!u&&u!==o.src&&o.setAttribute("src",u):!!u&&"url("+u+")"!==o.style.backgroundImage&&(o.style.backgroundImage="url("+u+")")}this.isResizing=!1}}},calcImgSrc:function(e,t){if(e==null)return!1;if(e.indexOf("cps-images-private")!==-1)return e;var n=e.match(/\/news\/(?:ws\/)?(\d*)/)||e;if(n===null||typeof n=="string"){var r=/\/images\/ic\/(\d+)x(\d+)/,i=e.match(r);if(i===null)return!1;var s=parseInt(i[1],10),o=parseInt(i[2],10),u=this.matchBestProgrammesWidth(t),a=u/s,f=Math.round(o*a),l="/images/ic/"+u+"x"+f;return e.replace(r,l)}var c=e.indexOf(n[1]),h=n[1].length;return e.substr(0,c)+this.matchBestWidth(t)+e.substr(c+h)},matchBestProgrammesWidth:function(e){return this.matchBestWidth(e,this.programmesWidths)},matchBestWidth:function(e,t){t=t||this.widths;var n=t.length,r=t[n-1];while(n--)t[n]<r&&t[n]>=e&&(r=t[n]);return r},isBelowFold:function(e,t){var n=e.height()-1+e.scrollTop(),r=t.offset().top;return r>n+this.lazyBufferZone}},n}),define("module/components/mediaPlayer/settingsBuilder",["module/components/mediaPlayer/comscoreSettings","module/components/mediaPlayer/playlistSelector","module/components/mediaPlayer/autoPlay","module/assortedUtils","module/featureDetector","module/imageenhancer","istats-1"],function(e,t,n,r,i,s,o){function h(r){var s=a(c),u=r.otherSettings||{};f(s,[r.settings,e.get()]),s.counterName||(s.counterName=o.getCountername()),s.autoplay=n.isEnabled(r);if(!s.playlistObject){if(u.playlist){var l=u.playlist;s.playlist=t.selectPlaylist(l),l.overrideHoldingImage&&(s.overrideHoldingImage=p(l.overrideHoldingImage,u.placeholderWidth))}}else{var h=s.playlistObject;u.advertisingAllowed&&i.is("DisplayingGnlAds")&&h.items.unshift({kind:"advert"}),h.holdingImageURL||(h.holdingImageURL=p(u.unProcessedImageUrl,u.placeholderWidth))}return s}function p(e,t){return e}var u=r.forEach,a=r.objectCreate,f=r.mergeObject,l=new s,c={appName:"news",product:"news",responsive:!0,waitOnPluginLoad:!0,superResponsive:!0};return{fromPlayable:h}}),define("module/components/mediaPlayer/main",["module/assortedUtils","module/components/mediaPlayer/eventDelegator","module/components/mediaPlayer/flashPlayerHandler","module/components/mediaPlayer/pluginLoader","module/components/mediaPlayer/settingsBuilder","module/components/mediaPlayer/view","module/globalPubsub","vendor/polyfill/promise","require"],function(e,t,n,r,i,s,o,u,a){function d(){return new f(function(e){a(["bump-3"],function(t){e(t)})})}function v(e,n,s){var o=i.fromPlayable(s),u;d().then(function(i){return u=i(e).player(o),t.addPlayer(u),r({instance:u,domId:n})}).then(function(){u.load()})}function m(e){o.emit("player:initialised",[e])}function g(e,t){n.handleNewPlayer(t),m(t)}function y(){x("initialised",g)}function b(){h=s.findUnprocessedMediaPlaceholders();var e="media-player-";h&&(y(),l(h,function(t){p++;var n=e+p;s.markPlaceholderAsProcessed(t),s.setPlaceholderId(t,n);var r=s.getPlayableForPlaceholder(t);r&&(r.otherSettings.placeholderWidth=s.getPlaceholderWidth(t),v(t,n,r))}))}function w(e){s.activatePlaceholder(e)}function E(){n.hide(h)}function S(){n.show(h)}function x(e,n){t.subscribe(e,n)}var f=u.Promise,l=e.forEach,c=e.jsonParse,h,p=0;return{hideFlashPlayers:E,processNewPlayers:b,showFlashPlayers:S,subscribeToPlayerEvent:x,activatePlaceholder:w}}),define("module/navigation/mediator",["module/navigation/wideView","module/navigation/narrowView","module/navigation/panels","module/findLocalNews","module/indexTitle","module/navigation/mediaPlaceholder","module/components/mediaPlayer/main"],function(e,t,n,r,i,s,o){function f(){return!!document.querySelector(".media-player")}function l(){a(),e.disable(),n.close(),t.enable(),n.cacheNarrow()}function c(){t.disable(),n.close(),e.enable(),n.cacheWide(),r.closeNarrowPanel()}function h(){e.enable(),n.cacheWide()}function p(){r.hideOverlay(),t.togglePrimaryNav(),i.toggle()}function d(){t.hidePrimaryNav(),t.hideSecondaryNav()}function v(e){t.accordionNavItem(e),n.togglePanel(e)}function m(){t.toggleSecondaryNav()}function g(t){e.toggleMoreButtonHighlights(t),n.togglePanel(t)}function y(e){t.toggleFooterNav(e)}function b(){t.publishSelectedVisibilityState()}function w(){r.insertIntoNarrowNav()}function E(){n.close(),a()}function S(e){n.close(e)}function x(){i.hide()}function T(){i.show()}var u,a;return f()?(u=o.hideFlashPlayers,a=o.showFlashPlayers):(u=s.hide,a=s.show),{enableWideStrategy:c,refreshWideStrategy:h,enableNarrowStrategy:l,toggleNarrowNav:p,toggleNarrowFooterNav:y,toggleNarrowSecondaryNav:m,toggleNarrowNavItem:v,toggleWideOverflow:g,hideNarrowNav:d,publishSelectedVisibilityState:b,insertFindLocalIntoNarrowNav:w,closePanels:E,closePanel:S,hideIndexTitle:x,showIndexTitle:T,showMediaPlaceholder:a,hideMediaPlaceholder:u}}),define("module/navigation/handler",["module/bootstrap","module/featureDetector","module/navigation/mediator"],function(e,t,n){function i(){r.on("global:resize",a),r.on("global:group:changed",u),r.on("nav:strategy:changed",f),r.on("nav:strategy:unchanged",l),r.on("nav:narrow:loaded",c),r.on("nav:footerButton:clicked",h),r.on("nav:arrow:clicked",p),r.on("nav:more:clicked",d),r.on("nav:sections:clicked",v),r.on("nav:narrow:secondary:arrow:clicked",m),r.on("findLocal:overlayVisible",g),r.on("nav:wide:panel:lostFocus",y),r.on("nav:overflowEmpty",b),r.on("nav:selectedIsVisible",w),r.on("nav:selectedIsHidden",E),r.on("nav:overflow:toggle",x)}function s(e){return e>2}function o(e){return s(e)===!1}function u(e){o(e)?n.enableNarrowStrategy():n.enableWideStrategy()}function a(e){s(e)&&n.refreshWideStrategy()}function f(e){e==="narrow"?n.enableNarrowStrategy():e==="wide"&&n.enableWideStrategy()}function l(e){e==="wide"&&n.refreshWideStrategy()}function c(){n.insertFindLocalIntoNarrowNav()}function h(e){n.toggleNarrowFooterNav(e)}function p(e){n.toggleNarrowNavItem(e)}function d(e){n.toggleWideOverflow(e)}function v(e){n.toggleNarrowNav()}function m(e){n.toggleNarrowSecondaryNav()}function g(){n.hideNarrowNav()}function y(){n.closePanels()}function b(e){n.closePanel(e)}function w(){n.hideIndexTitle()}function E(){n.showIndexTitle()}function S(e){i()}function x(e){e==="visible"?n.hideMediaPlaceholder():n.showMediaPlaceholder()}var r=e.pubsub;return{init:S}}),define("module/hotspot/reflow",["module/bootstrap"],function(e){function o(){u();if(!a())return;for(var e=0;e<i.length;e++)f(t(i[e]),t(s[e]))}function u(){i=[],s=[],r.each(function(){this.firstElementChild?i.push(this):s.push(this)})}function a(){return s.length>=i.length}function f(e,t){e.children().detach().appendTo(t),t.removeClass(n),e.addClass(n)}function l(){r.removeClass("hotspot--hidden")}function c(e){r=e}var t=e.$,n="hotspot--empty",r,i,s;return{init:c,execute:o,unmask:l}}),define("module/windowHelper",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){function n(n){e.$(e.window).on("resize",t.debounce(n,100))}function r(){return e.window.innerWidth}return{getInnerWidth:r,onResize:n}}),define("module/strategiser",["module/bootstrap","module/windowHelper"],function(e,t){function o(){var e;for(var n=1;n<=4;n++)t.getInnerWidth()>=s[n]&&(e=n);return e}function u(){f(),a()?(i.trigger("strategyChange",n),e.pubsub.emit("global:group:changed",n)):e.pubsub.emit("global:resize",n)}function a(){return n!==r}function f(){r=n,n=o()}function l(e){i.on("strategyChange",e)}function c(){u(),t.onResize(u)}var n,r,i=e.$({}),s={1:0,2:400,3:600,4:1008};return{init:c,determineStrategy:o,subscribeToStrategyChange:l}}),define("module/hotspot/handler",["module/bootstrap","module/hotspot/reflow","module/strategiser"],function(e,t,n){function s(){n.subscribeToStrategyChange(function(e,t){o(t)})}function o(e){if(r===e)return;r===null&&e===4?t.execute():i[e][r]!==undefined&&t.execute(),r==null&&t.unmask(),r=e}function u(){var r=e.$(".hotspot");if(r.length<2)return;t.init(r),o(n.determineStrategy()),s()}var r=null,i={1:{4:1},2:{4:1},3:{4:1},4:{1:1,2:1,3:1}};return{init:u}}),define("module/dotcom/facade",["module/bootstrap"],function(e){return{onResize:function(){e.window&&e.window.bbcdotcom&&typeof e.window.bbcdotcom.reset!="undefined"&&e.window.bbcdotcom.reset()}}}),define("module/dotcom/handler",["module/bootstrap","module/dotcom/facade"],function(e,t){function r(){n.on("global:resize",i),n.on("global:group:changed",i)}function i(e){t.onResize()}function s(e){r()}var n=e.pubsub;return{init:s}}),define("vendor/rum-event-client/source/lib/json",["require"],function(e){var t={};return function(){function e(e){return e<10?"0"+e:e}function o(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,function(e){var t=s[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function u(e,t){var n,s,a,f,l=r,c,h=t[e];h&&typeof h=="object"&&typeof h.toJSON=="function"&&(h=h.toJSON(e));switch(typeof h){case"string":return o(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";r+=i,c=[];if(Object.prototype.toString.apply(h)==="[object Array]"){f=h.length;for(n=0;n<f;n+=1)c[n]=u(n,h)||"null";return a=c.length===0?"[]":r?"[\n"+r+c.join(",\n"+r)+"\n"+l+"]":"["+c.join(",")+"]",r=l,a}for(s in h)Object.prototype.hasOwnProperty.call(h,s)&&(a=u(s,h),a&&c.push(o(s)+(r?": ":":")+a));return a=c.length===0?"{}":r?"{\n"+r+c.join(",\n"+r)+"\n"+l+"}":"{"+c.join(",")+"}",r=l,a}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r,i,s={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};typeof t.stringify!="function"&&(t.stringify=function(e){return u("",{"":e})})}(),t}),define("vendor/rum-event-client/source/analytics_client",["require","./lib/json"],function(e){function t(n){this.events=[],this.labels={},this.dataLabels={},this._getCookie=n.custom_cookie_getter||this._getCookie,this.p=n.product||"_",this.e=n.edition||null,this.id2=this._getCookie(t.USER_COOKIE_NAME),this.posting=this._setDelivery(n.delivery_method,n.server,n.url_params,n.custom_delivery),this.limit_url=!this.posting,this.JSON=window.JSON||e("./lib/json")}return t.USER_COOKIE_NAME="s1",t.MAX_URL_LENGTH=2e3,t.RT_THRESHOLD=6e4,t.AJAX_POST=1,t.AJAX_GET=2,t.DOM_GET=3,t.CUSTOM_POST=4,t.CUSTOM_GET=5,t.LABELS={COUNT_CONTENT_ID:"ccid",COUNT_LIST_ID:"clid"},t.VERSION="0.4.5",t.prototype._setDelivery=function(e,n,r,i){var s,o,u;switch(e){case t.AJAX_POST:s=!0,o=!0,u=!1;break;case t.AJAX_GET:s=!1,o=!0,u=!1;break;case t.DOM_GET:s=!1,o=!1,u=!1;break;case t.CUSTOM_POST:s=!0,o=!1,u=!0;break;case t.CUSTOM_GET:s=!1,o=!1,u=!0;break;default:s=!0,o=!0,u=!1}return s&&typeof navigator=="object"&&navigator.platform&&(navigator.platform.indexOf("iPhone")!=-1||navigator.platform.indexOf("iPod")!=-1||navigator.platform.indexOf("iPad")!=-1)&&(s=!1),u?this._makeRequest=t._useCustomRequest(i,t._makeURL(s,n,r),s):o&&typeof XMLHttpRequest!="undefined"&&typeof (new XMLHttpRequest).withCredentials!="undefined"?this._makeRequest=t._useXMLHttpRequest(t._makeURL(s,n,r),s):(s=!1,this._makeRequest=t._useImageRequest(t._makeURL(!1,n,r))),s},t._makeURL=function(e,n,r){var i=e?"":"/legacy",s=n+i;return r?t._addParams(s,r):s},t._addParams=function(e,t){e.indexOf("?")===-1?e+="?":e.indexOf("?")!==e.length-1&&(e+="&");for(var n in t)e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n])+"&";return e.replace(/(\?|&)$/,"")},t.prototype._addEvent=function(e,n,r){var i,s,o={},u={};for(i in this.dataLabels)o[i]=this.dataLabels[i];for(i in n)o[i]=n[i];for(i in this.labels)u[i]=this.labels[i];for(i in r)i===t.LABELS.COUNT_CONTENT_ID||i===t.LABELS.COUNT_LIST_ID?o[i]=r[i]:u[i]=r[i];s={cv:t.VERSION,p:this.p,id:e,id2:this.id2,ts:(new Date).getTime(),l:u,data:o},this.e!==null&&(s.e=this.e),this.events.push(s)},t.prototype._getCookie=function(e){if(typeof document=="undefined"||typeof document.cookie!="string")return null;var t,n=document.cookie;if(n.indexOf(e+"=")===0)t=e.length+1;else{t=n.indexOf(" "+e+"=");if(t==-1)return null;t+=e.length+2}var r=n.indexOf(";",t);return r==-1&&(r=n.length),n.substring(t,r)},t.prototype._addEventAndSend=function(e,t,n,r){this._addEvent(e,t,n),this._sendEvents(r)},t._createPLData=function(){return{url:window.location.pathname,referrer:document.referrer}},t._createPTData=function(){if(typeof window.performance!="object")return null;var e={url:window.location.pathname};for(var t in window.performance.timing)typeof window.performance.timing[t]!="function"&&(e[t]=window.performance.timing[t]);e.navigationStart=e.navigationStart||e.redirectStart||e.fetchStart;var n=e.loadEventEnd,r=e.navigationStart,i=e.requestStart,s=e.responseEnd;return n&&r&&i&&s&&(e.plt=n-r,e.pre=i-r,e.req=s-i,e.pro=n-s),e},t._createRTData=function(e,n){if(window.performance&&window.performance.getEntriesByType){var r=t._cleanRTData(window.performance.getEntriesByType("resource"));return{url:window.location.pathname,plt:e,"long":n,res:r}}return null},t._cleanRTData=function(e){var t=[];for(var n=0,r=e.length;n<r;n++){t[n]={};for(var i in e[n])e[n][i]!==0&&(i==="name"?t[n][i]=e[n][i].replace(/\?.*$/,""):t[n][i]=e[n][i])}return t},t.prototype._sendEvents=function(e,n){var r=n,i,s;r||(r=this.events,this.events=[]),i=this.JSON.stringify({events:r});if(this.limit_url&&r.length>1&&i.length>t.MAX_URL_LENGTH)for(s=0;s<r.length;s++)this._sendEvents(e,[r[s]]);else this._makeRequest(e,i,{"Content-type":"application/json"})},t._useXMLHttpRequest=function(e,n){return function(r,i,s){var o,u=e;n||(u=t._addParams(u,{data:i})),o=new XMLHttpRequest,o.open(n?"POST":"GET",u,!0);for(var a in s)o.setRequestHeader(a,s[a]);o.onreadystatechange=function(){o.readyState==4&&r&&r(o.status)};try{o.send(i)}catch(f){}}},t._useImageRequest=function(e){function i(e,t){n.push(function(){var n=new Image;n.onload=function(){s(),typeof e=="function"&&e()},n.onerror=function(){s()},n.onabort=function(){s()},n.src=t}),o()}function s(){r=!1,o()}function o(){if(r||n.length<1)return;r=!0;var e=n.shift();e()}var n=[],r=!1;return function(n,r){var s=t._addParams(e,{data:r});i(n,s)}},t._useCustomRequest=function(e,n,r){return r?function(t,r,i){e(t,null,"POST",n,i,r)}:function(r,i,s){e(r,null,"GET",t._addParams(n,{data:i}),s)}},t.prototype.load=function(e,n){var r=this;r._addEvent("PL",t._createPLData(),e),setTimeout(function(){var i=t._createPTData(),s,o,u;if(i){r._addEvent("PT",i,e);if(n!==!1){o=i.plt,u=i.plt>t.RT_THRESHOLD;if(n||u)s=t._createRTData(i.plt,u),s&&(r.rtSent=!0,r._addEvent("RT",s,e))}}r._sendEvents()},0)},t.prototype.sendError=function(e,t,n,r){this._addEventAndSend("ERR",{m:e,file:t,line:n},r)},t.prototype.sendExit=function(e,t,n){this._addEventAndSend("EXIT",{s:e,d:t},n)},t.prototype.addLabels=function(e,t){for(var n in e)this.addLabel(n,e[n],t)},t.prototype.addLabel=function(e,t,n){this[n?"dataLabels":"labels"][e]=t},t.prototype.removeLabels=function(e){for(var t=0;t<e.length;t++)delete this.labels[e[t]]},{AC:t}}),define("module/rum",["vendor/rum-event-client/source/analytics_client","config","module/bootstrap"],function(e,t,n){return{init:function(){this.rumEnabled()&&this.willSendAnalytics()&&this.rumParametersPresent()&&(this.ac=new e.AC({server:t.rumAnalytics.server,edition:t.rumAnalytics.edition,product:t.rumAnalytics.key+"_"+t.environment,url_params:t.rumAnalytics.url_params}),this.bindOnError(),this.deferTimings())},bindOnError:function(){var e=this,t=window.onerror;window.onerror=function(r,i,s){t&&t.apply(window,arguments),e.ac.sendError(r,i,s,n.$.eventHistory)}},deferTimings:function(){var r={},i=t.asset?t.asset.asset_id:null,s=this;r[e.AC.LABELS.COUNT_CONTENT_ID]=i;try{window.loaded?this.ac.load(r):n.$(window).on("load",function(){s.ac.load(r)})}catch(o){}},rumEnabled:function(){return typeof t!="undefined"&&typeof t.features2!="undefined"&&typeof t.features2.rum!="undefined"?t.features2.rum:!1},rumParametersPresent:function(){return typeof t.environment!="undefined"&&typeof t.rumAnalytics!="undefined"&&typeof t.rumAnalytics.key!="undefined"&&typeof t.rumAnalytics.server!="undefined"&&typeof t.rumAnalytics.edition!="undefined"&&typeof t.rumAnalytics.url_params!="undefined"},willSendAnalytics:function(){return typeof t.rumAnalytics!="undefined"&&typeof t.rumAnalytics.sample_rate!="undefined"&&Math.random()>t.rumAnalytics.sample_rate?!1:!0}}}),define("module/tableScroll",["module/bootstrap"],function(e){function n(){var e=document.getElementsByClassName("responsive-table-container"),t=e.length,n=0;while(n<t)e[n].addEventListener("touchstart",r,!1),e[n].addEventListener("touchmove",i,!1),n++}function r(e){t=e.currentTarget.scrollLeft+e.touches[0].pageX}function i(e){var n=e.currentTarget;(s(n,e)||o(n,e))&&e.preventDefault(),n.scrollLeft=t-e.touches[0].pageX}function s(e,n){return e.scrollLeft<e.scrollWidth-e.offsetWidth&&e.scrollLeft+n.touches[0].pageX<t-5}function o(e,n){return e.scrollLeft!==0&&e.scrollLeft+n.touches[0].pageX>t+5}function u(){return navigator.userAgent.match(/Android 2/i)?!0:!1}var t=0;return{init:function(){u()&&n()}}}),define("module/components/handler",["module/bootstrap"],function(e){return{handleSuccess:function(t,n){var r=e.$(t.selector);if(r){var i=document.createElement("div");i.innerHTML=n,r.replaceWith(i.childNodes)}},enable:function(t){var n=e.$(t.selector);n&&n.removeClass("hidden")},disable:function(t){var n=e.$(t.selector);n&&n.addClass("hidden")}}}),define("module/components/loader",["module/bootstrap","module/components/handler","deviceInspector","config"],function(e,t,n,r){var i={components:{},batchStore:[],device:"",register:function(e){this.components[e.id]=e},registerComponentsFromDom:function(){var t=e.$("[data-comp-meta]");for(var n=t.length-1;n>=0;n--){var r=e.$(t[n]).data("comp-meta");r&&(r.selector="#"+t[n].id,this.register(r))}},init:function(t){t=t||{},this.registerComponentsFromDom(),n=t.deviceInspector||n,this.device=n.getGroup(),this.processComponents(),e.pubsub.on("deviceGroup",function(e){i.device=e,i.processComponents()})},processComponents:function(){for(var t in this.components){var n=this.components[t],r=this.shouldShow(n.deviceGroups);!n.loaded&&r?i.load(n):n.loaded&&!r?this.callHandler(n,"disable"):n.loaded&&r&&this.callHandler(n,"enable")}this.requestComponents(this.batchStore),e.pubsub.emit("loader:process:done")},load:function(e){switch(e.opts.loading_strategy){case"post_load":this.requestComponents([e]);break;case"batch_load":this.batchStore.push(e);break;default:this.callHandler(e,"handleSuccess")}e.loaded=!0},shouldShow:function(e){return e?e.indexOf(i.device)!==-1:!0},requestComponents:function(t){var n=t.length,i={batch:{}};if(!n)return;while(n--){var s=t[n],o=s.type||s.name;s.opts.loading_strategy="include_content",i.batch[o]={opts:s.opts,id:s.id},s.template&&(i.batch[o].template=s.template)}var u=e.$.param(i),a=r.pathPrefix+(r.languageVariant?"/"+r.languageVariant:"")+"/components?"+u,f=this;e.$.ajax({url:a,dataType:"json",success:e.$.proxy(this.processResponse,this)})},processResponse:function(e){var t;for(var n in e){t=i.components[n];var r=e[n];i.callHandler(t,"handleSuccess",r)}i.batchStore=[]},callHandler:function(e,n,r){var s=e.handler;s==="default"?(t[n].call(t,e,r),i.emitEvent(e,n)):require(["module/components/"+s],function(s){s[n]?s[n].call(s,e,r):t[n].call(t,e,r),i.emitEvent(e,n)})},emitEvent:function(t,n){var r=n==="handleSuccess"?"loaded":n;e.pubsub.emit("component:"+r,[t.name,t])}};return i}),define("module/localisation/scriptToggle",["module/bootstrap","deviceInspector"],function(e,t){var n=e.$,r={zhongwen:["simp","trad"],ukchina:["simp","trad"]},i=365,s={zhongwen:"ckps_chinese",ukchina:"ckps_chinese"},o={init:function(){if(!e.config.isWorldService)return!1;var t=e.config.service,n=r.hasOwnProperty(t),i=document.querySelector(".script-toggle");if(!n||!i)return!1;this.bindEvents(t)},bindEvents:function(e){var t=this;n(".script-toggle").on("click",function(r){var i=t.getVariant(e,n(this));t.setCookie(e,i)})},getVariant:function(e,t){var i=t.attr("data-variant"),s=r[e];return!i||n.inArray(i,s)===-1?null:i},setCookie:function(t,n){if(!s.hasOwnProperty(t)||!n)return!1;var r=window.location.hostname.match(/com/)?".bbc.com":".bbc.co.uk";document.cookie=s[t]+"="+n+"; expires="+(new Date((new Date).getTime()+864e5*i)).toGMTString()+"; path=/; domain="+r,e.pubsub.emit("scriptToggle:cookieSaved",[{name:s[t],value:n}])}};return o}),define("module/commentCounts",["module/bootstrap","config"],function(e,t){var n=e.$,r=e.$({}),i=!1;return{init:function(e){var s,o=[];e?s=e+" .js-comment-count":s=".js-comment-count",n(s).each(function(){o.push(n(this).attr("data-comments-id"))}),o.length>0?n.getScript(t.commentsHost+"/modules/comments/getcount/?items="+o.toString(),function(){i||(i=!0,r.trigger("commentsButtonCodeCanRun"))}):i||(i=!0,r.trigger("commentsButtonCodeCanRun"))},onCommentsButtonCodeCanRun:function(e){r.on("commentsButtonCodeCanRun",e)}}}),define("module/initialiser",["module/bootstrap","module/navigation/handler","module/hotspot/handler","module/dotcom/handler","module/findLocalNews","module/indexTitle","module/rum","module/tableScroll","module/components/loader","module/strategiser","module/localisation/scriptToggle","module/commentCounts"],function(e,t,n,r,i,s,o,u,a,f,l,c){function h(){o.init(),a.init(),u.init(),c.init(),s.init(),t.init(),i.init(),n.init(),r.init(),l.init(),f.init()}return{init:h}}),define("module/urlShrinker",["module/bootstrap"],function(e){var t=e.$;return{find:function(e){return this.links=t(e),this},bindEvents:function(){this.links.on("click",this.shorten),e.pubsub.emit("urlShrinker:eventsBinded")},shorten:function(){var e=this.getAttribute("data-target-url"),n=this.getAttribute("data-social-url"),r="http://www.bbc.co.uk/modules/sharetools/v1/shrink.json?url=";t.ajax({async:!1,url:r+encodeURIComponent(e),success:t.proxy(function(e,t,r){this.href=n+e.url},this)})}}}),function(e){function t(t,n,r,i){var s=e.document.createElement("link"),o=n||e.document.getElementsByTagName("script")[0],u=e.document.styleSheets;return s.rel="stylesheet",s.href=t,s.media="only x",i&&(s.onload=i),o.parentNode.insertBefore(s,o),s.onloadcssdefined=function(e){for(var n,r=0;u.length>r;r++)u[r].href&&u[r].href.indexOf(t)>-1&&(n=!0);n?e():setTimeout(function(){s.onloadcssdefined(e)})},s.onloadcssdefined(function(){s.media=r||"all"}),s}function n(e,t){e.onload=function(){e.onload=null,t&&t.call(e)},"isApplicationInstalled"in navigator&&"onloadcssdefined"in e&&e.onloadcssdefined(t)}var r=function(i,s){if(i&&3===i.length){var u=e.Image,a=!(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")||e.opera&&-1===navigator.userAgent.indexOf("Chrome")||-1!==navigator.userAgent.indexOf("Series40")),f=new u;f.onerror=function(){r.method="png",r.href=i[2],t(i[2])},f.onload=function(){var e=1===f.width&&1===f.height,u=i[e&&a?0:e?1:2];r.method=e&&a?"svg":e?"datapng":"png",r.href=u,n(t(u),s)},f.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",document.documentElement.className+=" grunticon"}};r.loadCSS=t,r.onloadCSS=n,e.grunticon=r}(this),function(e,t){var n=t.document,r="grunticon:",i=function(e){if(n.attachEvent?"complete"===n.readyState:"loading"!==n.readyState)e();else{var t=!1;n.addEventListener("readystatechange",function(){t||(t=!0,e())},!1)}},s=function(e){return t.document.querySelector('link[href$="'+e+'"]')},o=function(e){var t,n,i,s,o,u,a={};if(t=e.sheet,!t)return a;n=t.cssRules?t.cssRules:t.rules;for(var f=0;n.length>f;f++)i=n[f].cssText,s=r+n[f].selectorText,o=i.split(");")[0].match(/US\-ASCII\,([^"']+)/),o&&o[1]&&(u=decodeURIComponent(o[1]),a[s]=u);return a},u=function(e){var t,i,s,o;s="data-grunticon-embed";for(var u in e){o=u.slice(r.length);try{t=n.querySelectorAll(o)}catch(a){continue}i=[];for(var f=0;t.length>f;f++)null!==t[f].getAttribute(s)&&i.push(t[f]);if(i.length)for(f=0;i.length>f;f++)i[f].innerHTML=e[u],i[f].style.backgroundImage="none",i[f].removeAttribute(s)}return i},a=function(t){"svg"===e.method&&i(function(){u(o(s(e.href))),"function"==typeof t&&t()})};e.embedIcons=u,e.getCSS=s,e.getIcons=o,e.ready=i,e.svgLoadedCallback=a,e.embedSVG=a}(grunticon,this),function(e,t){var n=t.document,r=function(e,n){var r=new t.XMLHttpRequest;return"withCredentials"in r?r.open("GET",e,!0):t.XDomainRequest!==void 0&&(r=new t.XDomainRequest,r.open("GET",e)),n&&(r.onload=n),r.send(),r},i=function(t){"svg"===e.method&&e.ready(function(){r(e.href,function(){var r=n.createElement("style");r.innerHTML=this.responseText;var i=e.getCSS(e.href);i&&(i.parentNode.insertBefore(r,i),i.parentNode.removeChild(i),e.embedIcons(e.getIcons(r)),"function"==typeof t&&t())})})};e.ajaxGet=r,e.svgLoadedCORSCallback=i,e.embedSVGCors=i}(grunticon,this),define("vendor/grunticon-loader",function(){}),define("module/iconLoader",["module/bootstrap","vendor/grunticon-loader"],function(e){return{init:function(){var t=window.grunticon,n=e.config;t([n.staticPrefix+"/icons/generated/icons.data.svg.css",n.staticPrefix+"/icons/generated/icons.data.png.css",n.staticPrefix+"/icons/generated/icons.fallback.css"],function(){t.embedSVGCors()})}}}),define("module/noTouchDetectionForCss",["module/bootstrap","module/featureDetector"],function(e,t){t.is("TouchDevice")||e.$("body").addClass("no-touch")}),define("module/components/commentCountAdapter",["module/commentCounts"],function(e){var t=function(t){e.init(t)};return t(),{onCommentsButtonCodeCanRun:e.onCommentsButtonCodeCanRun,reProcess:t}}),define("module/components/fauxBlockLink",["module/bootstrap"],function(e){var t=function(t){var n;t?n=t+" .faux-block-link":n=".faux-block-link";var r=e.$(n);r.on("mouseover",".faux-block-link__overlay-link",function(e){e.delegateTarget.className+=" faux-block-link--hover"}),r.on("mouseout",".faux-block-link__overlay-link",function(e){e.delegateTarget.className=e.delegateTarget.className.replace(/ faux-block-link--hover/,"")})};return t(),{reProcess:t}}),define("module/components/responsiveImage",["module/imageenhancer"],function(e){var t=new e,n=function(){t.changeDivsToImgs(),t.initResizeImages()};return{reProcess:n}}),define("module/timestamp",["module/bootstrap","translator"],function(e,t){var n=function(e,t){this.time=e,this.insertTime(t)};return n.prototype.insertTime=function(t){var n;t?n=t+" .date":n=".date";var r=e.$(n);for(var i=0,s=r.length;i<s;i++){var o=r.get(i);if(o.getAttribute("data-timestamp-inserted")!==undefined&&e.$(".live",o.parentElement).length===0){var u=o.getAttribute("data-seconds");if(typeof u!==undefined){var a=Math.abs(Math.ceil(this.time/1e3-parseInt(o.getAttribute("data-seconds"),10))),f=this.timeAgoInWords(a);if(f!==null)o.innerHTML=f,o.className+=" relative-time";else if(o.innerHTML===""){var l=document.createElement("p");l.innerHTML=o.getAttribute("data-datetime"),l.className=o.className,o.parentNode.insertBefore(l,o)}o.setAttribute("data-timestamp-inserted",!0)}}}},n.prototype.russianRelativeTime=function(e,t,n,r){var i=e%10;return i===1&&(e===1||e>20)?t:i>1&&i<5&&(e>20||e<10)?n:r},n.prototype.gaelicRelativeTime=function(e,t,n,r){return e===1?t:e===2?n:r},n.prototype.minutesAgo=function(e){switch(t.getLocale()){case"ru":case"ru-UK":return this.russianRelativeTime(e,t.get("singularMinutesAgo"),t.get("genSingularMinutesAgo"),t.get("genPluralMinutesAgo")).replace("{x}",e);case"gd":return this.gaelicRelativeTime(e,t.get("singularMinutesAgo"),t.get("dualMinutesAgo"),t.get("pluralMinutesAgo")).replace("{x}",e);default:return e===1?t.get("oneMinuteAgo"):t.get("xMinutesAgo").replace("{x}",e)}},n.prototype.hoursAgo=function(e){switch(t.getLocale()){case"ru":case"ru-UK":return this.russianRelativeTime(e,t.get("singularHoursAgo"),t.get("genSingularHoursAgo"),t.get("genPluralHoursAgo")).replace("{x}",e);case"gd":return this.gaelicRelativeTime(e,t.get("singularHoursAgo"),t.get("dualHoursAgo"),t.get("pluralHoursAgo")).replace("{x}",e);default:return e===1?t.get("oneHourAgo"):t.get("xHoursAgo").replace("{x}",e)}},n.prototype.timeAgoInWords=function(e){var n=Math.floor(e/60),r=Math.floor(e/3600);return n<1?t.get("lessThanAMinuteAgo"):r<1?this.minutesAgo(n):r<10?this.hoursAgo(r):null},n}),define("module/components/timestampAdaptor",["module/timestamp"],function(e){var t=function(t){new e((new Date((new Date).toUTCString())).getTime(),t)};return t(),{reProcess:t}}),define("module/polyfill/location.origin",[],function(){window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""))}),define("module/base",["module/bootstrap","vendor/analytics/siteCatalyst","module/stats/statsSubscriber","module/stats/statsConfig","module/initialiser","module/urlShrinker","deviceInspector","module/iconLoader","module/stats/comscore","module/noTouchDetectionForCss","module/components/commentCountAdapter","module/components/fauxBlockLink","module/components/responsiveImage","module/components/timestampAdaptor","module/polyfill/location.origin"],function(e,t,n,r,i,s,o,u,a){function l(){e.config.service||(e.config={service:"news"})}var f=function(){function n(t){var n=/device--(?:feature|smart|tablet|wide)/,r=document.body.className.split(" "),i=r.length,s=-1;/^group\d$/.test(t)&&(n=/device--group/);while(++s<i)n.test(r[s])&&e.$("body").removeClass(r[s])}function r(r){t!==r&&(t=r,n(r),e.$("body").addClass("device--"+r))}var t;return e.pubsub.on("deviceGroup",function(e){r(e)}),e.pubsub.on("deviceType",function(e){r(e)}),{setBodyClass:r}}();return{init:function(c){u.init(),s.find(".shortenUrl").bindEvents(),e.config.isWorldService&&new t;if(e.config.features2.comscore_analytics){var h=new a(e.config);h.sendPageViewBeacon()}new n(r),f.setBodyClass(o.getGroup()),f.setBodyClass(o.getType()),l(),i.init()}}}),define("module/blog/blogButton",["module/bootstrap"],function(e){var t=function(t){return this.element=e.$('<button class="blog__show-more"><span class="cta">'+t+'</span><span class="spin"></span></button>'),this.bindEvents(),this.listen(),this.element};return t.prototype={bindEvents:function(){this.element.on("click",function(t){t.preventDefault(),e.pubsub.emit("stories:more:request")})},listen:function(){e.pubsub.on("stories:more:loading",e.$.proxy(this.handleLoading,this)),e.pubsub.on("stories:more:success",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("stories:more:error",e.$.proxy(this.handleError,this)),e.pubsub.on("stories:fullyloaded",e.$.proxy(this.handleFullyLoaded,this))},handleLoading:function(e){this.element.attr("disabled","disabled")},handleSuccess:function(e){this.element.removeAttr("disabled")},handleError:function(e){this.element.remove()},handleFullyLoaded:function(e){this.element.remove()}},{create:function(e){return new t(e)}}}),define("module/components/adverts",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){var n=t.debounce(function(){bbcdotcom.adverts.layout.reset()},150);return{handleSuccess:function(t){typeof bbcdotcom!="undefined"&&typeof bbcdotcom.objects!="undefined"&&bbcdotcom.objects("bbcdotcom.adverts.slot")&&e.$(window).on("resize",n)}}}),define("module/components/advertsAdapter",["module/components/adverts"],function(e){e.handleSuccess()}),define("module/media/empFacade",["module/bootstrap","module/featureDetector","module/navigation/mediaPlaceholder","config","module/stats/comscore","module/stats/comscoreContextID"],function(e,t,n,r,i,s){var o=e.$,u=function(e){return e.autoplay===!0&&e.playlistObject&&e.playlistObject.guidance===undefined},a=function(a,f,l){var c=function(e,t){this.config=o.extend(!0,r,t),this.options=e||{},this.embed()};return c.prototype={analytics:null,getAsset:function(){var e=this.config||{},t=this.config.asset||{};return t},getPageType:function(){var e=this.getAsset(),t=e.type||null,n={MAP:"eav1",STY:"eav2",IDX:"eav3"};return n[t]?n[t]:"eav3"},getEdition:function(){var e=this.getAsset();return e.edition||"Domestic"},getAssetId:function(){var e=this.getAsset(),t=e.asset_id||null;return t?parseInt(t,10):0},getCounterName:function(){var e=this.getAsset();return e.iStats_counter_name},navigationMediaPlaceholderRequired:function(e){return e.name()==="smp-flash"},handleRequest:function(e,t,r,i,s,o){e.decide()!=="aaamp"&&(this.analytics=i,this.navigationMediaPlaceholderRequired(e)&&n.activate(),this.addEventListeners(e),s!==undefined&&s.addSmpPlugin(this.options.id,e),o!==undefined&&o.addSmpPlugin(e,!1),r&&i!==undefined&&i.addEventListeners(e),e.width(this.options.width),e.height(this.options.height),this.options.poster&&e.poster(this.options.poster),this.options.playlistObject?(e.load(),e.loadPlaylist(this.options.playlistObject,u(this.options))):this.options.vpid!==undefined?(e.load(),e.loadPlaylist({items:[{vpid:this.options.vpid,kind:this.getMediaKind(this.options.mediaType)}],holdingImageURL:this.options.poster,title:this.options.title?this.options.title:""})):this.options.playlist&&e.load(this.options.playlist))},addEventListeners:function(t){function r(e){return{opts:{mediaType:e.kind()},name:e.name()}}var n=this.config||{};t.bind("initialised",function(n){e.pubsub.emit("player:initialised",[t]),e.pubsub.emit("video:load",[r(t)])}),t.bind("playlistLoaded",function(n){e.pubsub.emit("player:playlistLoaded",[t]),e.pubsub.emit("player:playlistLoading",[t])}),t.bind("fullscreenchange",function(t){e.pubsub.emit("nav:all:close")}),t.bind("playing",function(n){e.pubsub.emit("video:play",[r(t)])}),t.bind("pause",function(n){e.pubsub.emit("video:pause",[r(t)])}),t.bind("ended",function(n){e.pubsub.emit("video:end",[r(t)])})},getUI:function(){return{colour:this.config.smpBrand}},getMediaKind:function(e){return e==="audio"?"radioProgramme":"programme"},appendLiveStatsSettings:function(e){return e.pageType=this.getPageType(),e.edition=this.getEdition(),e.uniqueID=this.getAssetId(),e},appendComscoreSettings:function(e){var t=new i(r);return e.statsObject={x_ns_site:s.getSiteValue(),deviceId:s.getUserTrackingCookieValue(),echoProfile:s.ECHO_PROFILE_WS_ACCEPTANCE,sessionLabels:t.getSessionLabels()},e},getSettings:function(){var e=this.config||{},t=this.config.locale||"en-GB",n={product:"news",playerProfile:"smp",responsive:!0,superResponsive:!0,siteID:"News",counterName:this.getCounterName(),appName:"news",appType:"web",disable3GWarning:!0,ui:{locale:{lang:t.toLowerCase()}}};return this.config.service==="news"&&(n=this.appendLiveStatsSettings(n)),this.config.features2&&this.config.features2.comscore_analytics&&(n=this.appendComscoreSettings(n)),n},configureContinuousPlay:function(e){e.autoplay=!1,require(["bump-3","bbcdotcom/av/emp/analytics","bbcdotcom/av/emp/adverts","bbcdotcom/av/continuous_play/continuousPlay"],o.proxy(function(n,r,i,s){var o=n("#"+this.options.id).player(e);this.handleRequest(o,t.is("ShowingDesktopAds"),!0,r,i,s)},this))},configurePlayerWithGnlAdsAndAnalytics:function(e){require(["bump-3","bbcdotcom/av/emp/analytics","bbcdotcom/av/emp/adverts"],o.proxy(function(n,r,i){var s=n("#"+this.options.id).player(e);this.handleRequest(s,t.is("ShowingDesktopAds"),!0,r,i)},this))},configurePlayerWithGnlAnalytics:function(e){require(["bump-3","bbcdotcom/av/emp/analytics"],o.proxy(function(n,r){var i=n("#"+this.options.id).player(e);this.handleRequest(i,t.is("ShowingDesktopAds"),!0,r)},this))},configurePlayer:function(e){require(["bump-3"],o.proxy(function(t){var n=t("#"+this.options.id).player(e);this.handleRequest(n,!1,!1)},this))},embed:function(){if(a&&f&&l)this.handleRequest(a,!0,!0,f,l);else if(a&&f)this.handleRequest(a,!1,!0,f);else if(a)this.handleRequest(a,!1,!1);else{var e=this.getSettings();this.config.smpBrand&&(e.ui=this.getUI()),this.getPageType()==="eav1"&&t.is("CollectingGNLAnalytics")&&t.is("ShowingDesktopAds")&&(e.autoplay=!0),!t.is("CollectingGNLAnalytics")&&!t.is("DisplayingGnlAds")?this.configurePlayer(e):(e.waitOnPluginLoad=!0,t.is("DisplayingGnlAds")&&t.is("ContinuousPlayEnabled")&&this.getPageType()==="eav1"?this.configureContinuousPlay(e):t.is("DisplayingGnlAds")?this.configurePlayerWithGnlAdsAndAnalytics(e):this.configurePlayerWithGnlAnalytics(e))}}},c};return{init:a}}),define("module/media/template",["module/featureDetector","translator"],function(e,t){var n=function(){var e=t.get("offScreenMediaCaption"),n="figure",r="",i="figcaption",s="",o=["<"+n+' class="media-item {{classes}}'+r+'">','<div class="media-container media-wrapper" id="media-{{id}}"></div>',"<"+i+' class="media-caption'+s+'"><span class="off-screen">'+e+'</span> <span class="media-caption__text">{{caption}}</span></'+i+">","</"+n+">"].join("");return function(){return o}}();return function(e){var t=n();for(var r in e)t=t.replace(new RegExp("{{"+r+"}}","g"),e[r]);return t}}),define("module/page",["istats-1"],function(e){return{getCountername:function(){return e.getCountername()},setCountername:function(t){e.setCountername(t)}}}),define("module/media/mediaLoader",["module/bootstrap","module/media/empFacade","module/media/template","module/featureDetector","module/page"],function(e,t,n,r,i){var s=function(){return t.init()}(),o=function(t,n,r){this.placeholder=e.$(t),this.meta=n||{},this.options=r||{},this.id=this.getMediaId(),this.hasCaption=!!this.meta.caption&&!!this.meta.caption.length,this.caption=this.hasCaption?this.meta.caption:"",this.posterSrc=this.meta.image&&this.meta.image.href?this.meta.image.href:"",this.render()};return o.prototype={getMediaId:function(){return this.options.mediaId?this.options.mediaId:this.placeholder.attr("id")},getAssetId:function(){return this.options.assetId?this.options.assetId:this.placeholder.attr("data-asset-id")?this.placeholder.attr("data-asset-id"):this.parseAssetIdFromHref()},parseAssetIdFromHref:function(){if(this.meta.href){var e=this.meta.href.match(/(\d+)/g);return e?e.pop():null}},render:function(){this.renderContainer(),this.embedPlayer()},renderContainer:function(){this.placeholder.append(n({classes:this.getClasses(),id:this.id,caption:this.caption})),this.show()},getClasses:function(){var e="default-player",t=this.hasCaption?"has-caption":"no-caption";return[e,t].join(" ")},assetAllowsAds:function(){var t=typeof this.options.adsEnabled!="undefined"?this.options.adsEnabled:!0,n=e.$("meta[name=CPS_AUDIENCE]").attr("content"),r=!1;if(typeof n!="undefined"&&typeof this.meta.blockedAudiences!="undefined"){n=n.toLowerCase();for(var i in this.meta.blockedAudiences)if(n===this.meta.blockedAudiences[i].toLowerCase()){r=!0;break}}return t&&!r},getMediaDuration:function(){return typeof this.meta.durationInSeconds!="undefined"?this.meta.durationInSeconds:0},getEmbedRights:function(){return this.meta.allowOffSiteEmbedding?"allowed":"blocked"},getMediaKind:function(){return this.options.mediaType==="audio"?"radioProgramme":"programme"},getProgrammeItem:function(){return{kind:this.getMediaKind(),live:!!this.meta.live,vpid:typeof this.meta.vpid!="undefined"?this.meta.vpid:this.meta.externalId}},getAdvertItem:function(){return{kind:"advert",media:{kind:"video",width:this.options.width,height:this.options.height,type:"video/mp4"}}},getPlaylistItems:function(){var e=[];return r.is("DisplayingGnlAds")&&this.assetAllowsAds()&&this.getMediaDuration()>=30&&e.push(this.getAdvertItem()),e.push(this.getProgrammeItem()),e},embedPlayer:function(){var e;this.meta.externalId&&(e={embedRights:this.getEmbedRights(),holdingImageURL:this.posterSrc,items:this.getPlaylistItems(),summary:this.meta.caption,title:this.meta.caption,guidance:this.meta.guidance,simulcast:!!this.meta.live,liveRewind:!!this.meta.live}),new s({errorOnRender:!1,externalId:this.meta.externalId,height:this.options.height,href:this.options.href,id:"media-"+this.id,live:this.meta.live,vpid:this.meta.vpid,title:this.meta.title,mediaType:this.options.mediaType||"video",playlist:this.meta.href,playlistObject:e,poster:this.posterSrc,width:this.options.width,autoplay:!!this.options.autoplay},{asset:{iStats_counter_name:i.getCountername(),asset_id:this.getAssetId()}})},show:function(){this.placeholder.addClass("enabled")}},o}),define("module/media/mediaFilter",["module/bootstrap"],function(e){var t=e.$,n=function(e,n,r){return this.options=r||{},typeof e=="object"&&(e=t.map(e,function(e){return e})),this.getAssetWithEncoding(e,n)};return n.prototype={getAssetWithEncoding:function(e,n){var r=n==="video"?"mp4":"mp3",i=t.grep(e,function(e){return e.encoding===r});i.sort(function(e,t){return e.bitrate===t.bitrate?0:e.bitrate<t.bitrate?1:-1});switch(this.options.quality){case"high":return i[0];case"medium":return i[1]||i[0];case"low":return i[2]||i[1]||i[0];default:return i[1]||i[0]}}},n}),define("module/media/longformFilter",[],function(){function e(){}var t=["/persian/meta/tx/tv/smp/newshour.xml","/persian/meta/tx/tv/smp/cheshmandaz.xml","/persian/meta/tx/tv/smp/nowbateshoma.xml","/persian/meta/tx/tv/smp/tamasha.xml","/persian/meta/tx/tv/smp/37degrees.xml","/persian/meta/tx/tv/smp/pargar.xml","/persian/meta/tx/tv/smp/click.xml","/persian/meta/tx/tv/smp/beebaratedigar.xml","/persian/meta/tx/tv/smp/safheye2weekend.xml","/persian/meta/tx/tv/smp/safheye2.xml","/persian/meta/tx/tv/smp/dideban.xml","/persian/meta/tx/tv/smp/purplecrystal.xml","/persian/meta/tx/tv/smp/khabarnegaran.xml","/arabic/meta/tx/flash/tv/fourtech.xml","/arabic/meta/tx/flash/tv/iwitness.xml","/arabic/meta/tx/smp/tv/cinema_badila.xml","/afrique/meta/tx/tv/smp/afrtvbulletin.xml","/afrique/meta/tx/smp/afrtvbulletin_mon.xml","/afrique/meta/tx/smp/afrtvbulletin_tue.xml","/afrique/meta/tx/smp/afrtvbulletin_wed.xml","/afrique/meta/tx/smp/afrtvbulletin_thu.xml","/afrique/meta/tx/smp/afrtvbulletin_fri.xml","/burmese/meta/tx/tv/smp/burtvbulletin.xml","/hausa/meta/tx/smp/hautvbulletin.xml","/kyrgyz/meta/tx/tv/smp/kyrtvbulletin.xml","/kyrgyz/meta/tx/tv/smp/kyrtvbulletin_mon.xml","/kyrgyz/meta/tx/tv/smp/kyrtvbulletin_tue.xml","/kyrgyz/meta/tx/tv/smp/kyrtvbulletin_wed.xml","/kyrgyz/meta/tx/tv/smp/kyrtvbulletin_thu.xml","/kyrgyz/meta/tx/tv/smp/kyrtvbulletin_fri.xml","/pashto/meta/tx/tv/smp/pastvbulletin.xml","/tamil/meta/tx/smp/tv/tamtvbulletin_latest.xml","/urdu/meta/tx/tv/smp/sairbeen.xml","/urdu/meta/tx/flash/tv/sairbeen_mon.xml","/urdu/meta/tx/flash/tv/sairbeen_tue.xml","/urdu/meta/tx/flash/tv/sairbeen_wed.xml","/urdu/meta/tx/flash/tv/sairbeen_thu.xml","/urdu/meta/tx/flash/tv/sairbeen_fri.xml"];return e.prototype.isLongformContent=function(e){var n=e.replace("http://wsdownload.bbc.co.uk","");return t.indexOf(n)>-1},new e}),define("module/media/mediaHandler",["module/bootstrap","module/media/mediaLoader","module/media/mediaFilter","module/media/longformFilter","module/featureDetector"],function(e,t,n,r,i){var s=e.$,o=function(e,n){this.options=e||{},t=n||t};return o.prototype={createMedia:function(){s.each(this.findMediaPlaceholders(),s.proxy(function(s,o){var u=e.$(o).data("media-meta"),a=e.$(o).data("media-type"),f=u.sourceFiles,l={mediaType:a};if(f){var c=new n(f,a);l.href=c.url;if(i.can("PlayProgressiveDownload")&&u.hasOwnProperty("href")&&!r.isLongformContent(u.href)){var h=window.location;u.href=h.origin+h.pathname+"/smp_playlist.xml"+h.search}}if(this.options.audio===!1&&a==="audio")return;u&&new t(o,u,l)},this))},findMediaPlaceholders:function(){return e.$(".media-placeholder").not(".enabled")}},o}),define("module/components/shareTools",["module/bootstrap"],function(e){var t=e.$;return{handleSuccess:function(e){var n=t(e.selector),r=n.find(".share__button"),i=n.find(".share");r.on("click",t.proxy(this.toggleShareToolsVisibility,this,i,r))},toggleShareToolsVisibility:function(e,t,n){e.toggleClass("show"),t.toggleClass("active"),n.preventDefault()}}}),define("module/components/blog",["module/bootstrap","module/blog/blogButton","module/imageenhancer","module/media/mediaHandler","module/timestamp","module/components/shareTools","module/components/mediaPlayer/main","translator"],function(e,t,n,r,i,s,o,u){var a=e.$,f={init:function(n){(function(){var t=["Webkit","Moz"],n=[];for(var r in t)n.push(document.body.style[t[r]+"AnimationName"]);e.$("html").addClass(a.inArray("",n)>-1?"css-anim":"animated-gif")})(),this.mediaHandler=new r,this.enhanceContent(),this.firstName=n.opts&&n.opts.firstName?n.opts.firstName:null,this.container=a(n.selector),this.nextStoriesLink=this.hasNextStories(this.container),this.requesting=!1,this.requestCount=0,this.nextStoriesLink&&(this.bindEvents(),this.container.after(t.create(u.get("moreStories")))),this.bindShareButtons(this.container)},enhanceContent:function(){new n(".story-body figure img,.story-body .HTML5figure img"),new i((new Date((new Date).toUTCString())).getTime()),this.mediaHandler.createMedia()},bindEvents:function(){e.pubsub.on("stories:more:success",a.proxy(function(e){this.handleSuccess(e)},this)),e.pubsub.on("stories:more:error",a.proxy(function(){this.handleError()},this)),e.pubsub.on("stories:more:request",a.proxy(function(){this.handleRequest()},this)),e.pubsub.on("stories:more:loading",a.proxy(function(){this.handleLoading()},this))},hasNextStories:function(e){return e.attr("data-next")},setRequesting:function(e){this.requesting=e},setNextStoriesLink:function(t){this.nextStoriesLink=this.hasNextStories(t),this.nextStoriesLink||e.pubsub.emit("stories:fullyloaded")},handleRequest:function(){this.requesting||this.getMoreStories(this.nextStoriesLink)},handleLoading:function(){this.setRequesting(!0)},handleSuccess:function(e){e=a(e),this.setRequesting(!1),this.setNextStoriesLink(e),this.insertStoriesIntoDom(e.children()),this.enhanceContent()},handleError:function(){this.setRequesting(!1)},insertStoriesIntoDom:function(e){this.container.append(e),this.bindShareButtons(e),o.processNewPlayers()},getRequestCount:function(){return this.requestCount},getMoreStories:function(t){if(t){var n=this.firstName?{firstName:this.firstName}:null;this.requestCount++,e.pubsub.emit("stories:more:loading"),a.ajax({url:t,data:n,success:a.proxy(function(t){e.pubsub.emit("stories:more:success",[t,{requestCount:this.getRequestCount()}])},this),error:a.proxy(function(){e.pubsub.emit("stories:more:error")},this)})}},bindShareButtons:function(e){e.find(".js-share-tools").each(function(e,t){s.handleSuccess({selector:"#"+t.id})})}};return{handleSuccess:function(e,t){f.init.apply(f,arguments)},init:function(e,t){var n={selector:e,opts:{firstName:t}};f.init.apply(f,[n])}}}),define("module/poller",["module/bootstrap"],function(e){function n(t,n){return e.$.extend(t,n)}function r(e){var t="cachebuster="+Math.floor((new Date).getTime()/1e3);return e.indexOf("?")>0?e+"&"+t:e+"?"+t}function i(e){return e&&e>=3e4}function s(e){var t=!1;"clientdirective"in e&&"pollPeriod"in e.clientdirective&&(t=e.clientdirective.pollPeriod),"pollPeriod"in e&&(t=e.pollPeriod);if(!o(t)){t=parseInt(t,10);if(isNaN(t))return!1}return this.updateFrequency===0&&(t=!1),t}function o(e){return typeof e=="number"}var t=function(e,t,r){this.setPollingTime(e),this.options={timeout:1e4},this.setUrl(t),this.polling=!1,this.options=n(this.options,r),this.cacheBusting=!1};return t.prototype={setUrl:function(e){this.url=e},buildUrl:function(){return this.cacheBusting?r(this.url):this.url},setPollingTime:function(e){o(e)&&e>=30&&e<=7200&&(this.updateFrequency=e*1e3)},startPolling:function(e){this.polling=!0,this.options=n(this.options,e),this.poll()},stopPolling:function(){this.polling=!1},poll:function(){if(!this.polling||!this.url)return;var t=this.options.callbackName||"callback",n=this;e.$.ajax({url:n.buildUrl(),dataType:"jsonp",timeout:this.options.timeout,jsonpCallback:t,method:"get",success:function(e){var t=s(e);i(t)?(n.updateFrequency=t,n.rePoll()):n.stopPolling();if(n.options.success){var r=n.options.success(e);n.url=r||n.url}},error:function(e){n.options.error&&n.options.error(e)}})},rePoll:function(){if(!this.updateFrequency)return;var e=this;window.setTimeout(function(){e.poll()},e.updateFrequency)},stopCacheBusting:function(){this.cacheBusting=!1},startCacheBusting:function(){this.cacheBusting=!0}},t}),define("module/components/breakingNews/storage",["module/cookieUtils"],function(e){function o(){var t=e.readCookie(n);return t.length===0?[]:t.split(",")}function u(t){e.setCookie(n,t.join(","),r)}function a(){return t.length>0?t:(t=o(),t)}var t=[],n="ckps_breaking_seen",r=90,i=1,s={maxArticlesToStore:1};return s.articleAlreadySeen=function(e){if(typeof e!="string"&&typeof e!="number")return;var t=a();for(var n in t)if(e.toString()===t[n])return!0;return!1},s.setArticleAsSeen=function(e){if(typeof e!="string"&&typeof e!="number")return;var t=a();t.push(e.toString()),t.length>s.maxArticlesToStore&&t.shift(),u(t)},s}),define("module/components/breakingNews/view",["module/bootstrap"],function(e){function i(){n.off("click","button"),n.empty()}function s(){return n.children().length>0}function o(){return e.$("#breaking-news-container")}function u(){n.hide(),i()}var t={},n,r=e.$({});return t.getAssetIdFromHtml=function(t){var n=e.$;try{n=e.$(t)}catch(r){return""}return n.find("a").data("asset-id")},t.insert=function(e){n=o(),n.show(),n.html(e),n.on("click","button",function(){u(),r.trigger("close")})},t.getPollingUrl=function(){return o().data("polling-url")},t.onClose=function(e){r.on("close",e)},t}),define("module/components/breakingNews/main",["module/bootstrap","module/poller","module/components/breakingNews/storage","module/components/breakingNews/view"],function(e,t,n,r){function a(){o.startPolling({callbackName:"breakingNews",success:function(e){if(!e||!e.html)return;var t=r.getAssetIdFromHtml(e.html);if(!t||n.articleAlreadySeen(t))return;n.setArticleAsSeen(t),r.insert(e.html),f()}})}function f(){o.stopPolling()}var i=6e4,s=5e3,o,u={};return u.init=function(){var e=r.getPollingUrl();e&&(o=new t(i,s),o.setUrl(e),a(),r.onClose(function(){a()}))},u}),define("module/components/breakingNewsAdapter",["module/components/breakingNews/main"],function(e){e.init()}),function(e){typeof define=="function"&&define.amd?define("vendor/xdomainrequest/xdomainrequest",["jquery"],e):typeof exports=="object"?module.exports=e(require("jquery")):e(jQuery)}(function(e){if(e.support.cors||!e.ajaxTransport||!window.XDomainRequest)return e;var t=/^(https?:)?\/\//i,n=/^get|post$/i,r=new RegExp("^(//|"+location.protocol+")","i");return e.ajaxTransport("* text html xml json",function(i,s,o){if(!i.crossDomain||!i.async||!n.test(i.type)||!t.test(i.url)||!r.test(i.url))return;var u=null;return{send:function(t,n){var r="",o=(s.dataType||"").toLowerCase();u=new XDomainRequest,/^\d+$/.test(s.timeout)&&(u.timeout=s.timeout),u.ontimeout=function(){n(500,"timeout")},u.onload=function(){var t="Content-Length: "+u.responseText.length+"\r\nContent-Type: "+u.contentType,r={code:200,message:"success"},i={text:u.responseText};try{if(o==="html"||/text\/html/i.test(u.contentType))i.html=u.responseText;else if(o==="json"||o!=="text"&&/\/json/i.test(u.contentType))try{i.json=e.parseJSON(u.responseText)}catch(s){r.code=500,r.message="parseerror"}else if(o==="xml"||o!=="text"&&/\/xml/i.test(u.contentType)){var a=new ActiveXObject("Microsoft.XMLDOM");a.async=!1;try{a.loadXML(u.responseText)}catch(s){a=undefined}if(!a||!a.documentElement||a.getElementsByTagName("parsererror").length)throw r.code=500,r.message="parseerror","Invalid XML: "+u.responseText;i.xml=a}}catch(f){throw f}finally{n(r.code,r.message,i,t)}},u.onprogress=function(){},u.onerror=function(){n(500,"error",{text:u.responseText})},s.data&&(r=e.type(s.data)==="string"?s.data:e.param(s.data)),u.open(i.type,i.url),u.send(r)},abort:function(){u&&u.abort()}}}),e}),define("module/components/capercaillie/constituencySearch",["module/bootstrap","translator","vendor/xdomainrequest/xdomainrequest"],function(e,t){function n(n){function p(){r(f).on("submit",function(e){e.preventDefault()}),r(c).on("focusout keypress",r.proxy(x,this)),r(h).on("click",r.proxy(m,this))}function d(e,t){E("constituencySearchInternalError",t)}function v(n,r){var i,s;if(n&&n.response&&n.response.details&&n.response.details[0]&&n.response.details[0].externalId&&n.response.details[0].distance!==undefined){s=n.response.details[0].externalId,i=n.response.details[0].distance;if(e.config.service==="cymrufyw"&&s[0].toUpperCase()!=="W"){E("constituencySearchNoResults",r);return}if(n.response.details[0].distance>=0){e.pubsub.emit("election:findYourConstituency:submitSearch"),b(t.get("constituencySearchConstituencyPath")+s);return}}E("constituencySearchNoResults",r)}function m(){var e;r(l).text("").addClass("hidden"),e=r(c).val();if(!g(e)){E("constituencySearchNoResults",e);return}r(u).addClass("constituency-search--searching"),r.ajax({url:s.replace("SEARCH_POSTCODE",S(e)),dataType:"json",success:r.proxy(function(t){v(t,e)},this),error:r.proxy(function(t){d(t,e)},this)})}function g(e){return!!e.match(new RegExp(o))}function y(){var e=r(e);e.find("[placeholder]").each(function(){r(this).val(r(this).attr("placeholder")),r(this).on("focus",function(){r(this).val("")}),r(this).on("focusout",function(){r(this).val()===""&&r(this).val(r(this).attr("placeholder"))})}),e.on("submit",function(){e.find("[placeholder]").each(function(){r(this).val()===r(this).attr("placeholder")&&r(this).val("")})})}function b(e){window.location=e}function w(){return e.config.locatorFlagPole}function E(n,i){e.pubsub.emit("election:findYourConstituency:searchError",n),i=i===undefined?"":encodeURIComponent(i).replace(/%20/g," "),r(u).removeClass("constituency-search--searching"),r(l).html(t.get(n).replace("{postcode}",i)).removeClass("hidden")}function S(e){return encodeURIComponent(e.toUpperCase().replace(/ /g,""))}function x(e){var t;if(e.type==="keypress"&&e.keyCode!==13)return;t=r(c).val(),t!==r(c).attr("placeholder")&&r(c).val(t.toUpperCase())}var r=e.$,i=e.config.environment?e.config.environment.replace("sandbox","live"):"live",s="http://open."+i+".bbc.co.uk/locator/locations/SEARCH_POSTCODE/details/gss-seat?op=intersect&format=json&dv=1.1",o="GIR 0AA|[A-PR-UWYZ]([0-9]{1,2}|([A-HK-Y][0-9]|[A-HK-Y][0-9]([0-9]|[ABEHMNPRV-Y]))|[0-9][A-HJKPS-UW]) *[0-9][ABD-HJLNP-UW-Z]{2}",u="#"+n,a="#"+n+"-template",f="#"+n+"-form",l="#"+n+"-message",c="#"+n+"-input",h="#"+n+"-search";w()&&(r(a).after(r(a).html()),"placeholder"in document.createElement("input")==0&&y(),p())}return{init:function(e){return new n(e)}}}),define("module/components/capercaillie/constituencySearchAdapter",["module/bootstrap","module/components/capercaillie/constituencySearch"],function(e,t){e.$(".capercaillie").each(function(){var e=$(this).attr("id");e&&t.init(e)})}),define("vendor/cbbcNavigation",[],function(){return{handleSuccess:function(){function i(e,t,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function s(e,t){e.className=e.className.replace(new RegExp("(?:^|\\s)"+t+"(?!\\S)"),"")}function o(e,t){e.textContent?e.textContent=t:e.innerText=t}var e=document.getElementById("cbbc-menu-toggle"),t=document.getElementById("cbbc-menu-toggle-title"),n=document.getElementById("cbbc-menu"),r=!1;i("click",e,function(e){r=!r,r?(s(n,"cbbc-menu--closed"),n.className+=" cbbc-menu--open",o(t,"Close")):(s(n,"cbbc-menu--open"),n.className+=" cbbc-menu--closed",o(t,"Menu")),e.preventDefault()})}}}),define("module/components/cbbcNavigation",["vendor/cbbcNavigation"],function(e){return e}),define("module/responsiveIframe/iframe",["module/bootstrap"],function(e){var t=e.$,n=e.pubsub;return{updateFrequency:100,createIframe:function(e){var r=location.host.match(/bbc.co.uk|bbc.com/);r&&(document.domain=r[0]);var i=t("#"+e+" a"),s=i.attr("data-iframe-src"),o=i.attr("id");this.iframe=t("<iframe>",{src:s,id:o,"class":"responsive-iframe",scrolling:"no",width:"100%",height:0}).on("load",t.proxy(function(){n.emit("responsiveiframe:loaded",[o]),this.iframeBody=this.iframe.contents().find("body"),this.startWatching(),this.modifyExternalLinks()},this)),i.replaceWith(this.iframe)},startWatching:function(){window.setInterval(t.proxy(function(){this.iframe.css("height",this.iframeBody.height()+"px")},this),this.updateFrequency)},modifyExternalLinks:function(){var e=this,n=this.iframeBody.find("a");n.each(function(){var n=t(this);if(n.attr("href")){var r=decodeURIComponent(n.attr("href"));e.isExternal(r,location)&&n.attr("target","_parent")}})},isExternal:function(e,t){var n=e.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/),r=!1;if(typeof n[1]=="string"&&n[1].length>0&&n[1].toLowerCase()!==t.protocol||typeof n[2]=="string"&&n[2].length>0&&n[2].replace(new RegExp("Î:("+{"http:":80,"https:":443}[t.protocol]+")?$"),"")!==t.host)r=!0;return r}}}),define("module/components/commentsButton",["module/bootstrap","module/responsiveIframe/iframe","module/commentCounts"],function(e,t,n){var r=e.$,i=e.pubsub;return{disableAction:function(e){e.preventDefault()},triggerComments:function(){this.commentsAction.off("click",r.proxy(this.triggerComments,this)),i.on("responsiveiframe:loaded",r.proxy(this.iframeLoaded,this)),this.spinner.appendTo(this.component.selector),this.openComments()},openComments:function(){t.createIframe(this.component.id),i.emit("stats:comments:open")},iframeLoaded:function(e){this.spinner.remove(),this.modifyIframeLinks(e)},modifyIframeLinks:function(e){var t=r("#"+e).contents(),n=".comments-permalink",i=".id4-cta-signin, .id4-cta-register, .id4-cta-signout",s=".comments-previous-comments a, .comments-permalink";t.find(s).attr("target","_parent"),t.find(n).each(function(){var e=r(this).attr("href");r(this).attr("href",e.replace("/iframe",""))}),t.find(i).each(function(){var e=r(this);if(e.attr("href")){var t=decodeURIComponent(e.attr("href")),n=t.split("/comments/iframe");if(n){var i=n[0]+"?comments";n[1]&&(i=i+"&"+n[1].substring(1)),e.attr("href",i)}}})},handleSuccess:function(e){var t="dna-comment-count_"+e.opts.commentsId,i=r("#"+t+".dna-comment-count-show").not(".comments-button__count");if(i.length&&parseInt(i.text(),10)>0){var s=r(e.selector+" .js-comment-count");s.text(i.text()),s.addClass("dna-comment-count-show")}else n.init();e.opts.jsEnabled&&(this.component=e,this.commentsAction=r(e.selector+" a"),this.commentsAction.on("click",r.proxy(this.disableAction)),this.commentsAction.on("click",r.proxy(this.triggerComments,this)),this.spinner=r('<div class="comments-button__loader js-comments-button__loader"><span class="comments-button__spinner"></span></div>'),window.location.href.indexOf("?comments")!==-1&&this.triggerComments())}}}),define("module/components/commentsButtonAdapter",["module/components/commentsButton","module/components/commentCountAdapter"],function(e,t){var n=document.getElementById("comp-comments-button");if(!n)return;var r=JSON.parse(n.getAttribute("data-comp-meta"));r&&(r.selector="#"+r.id),t.onCommentsButtonCodeCanRun(function(){e.handleSuccess(r)})}),define("module/components/correspondentBlogAdapter",["module/components/blog"],function(e){var t=document.getElementById("comp-correspondent");t&&e.init(t)}),define("module/components/hardNewsUnit",["module/bootstrap"],function(e){return{init:function(t){var n=e.$(t+" .faux-block-link");n.on("mouseover",".faux-block-link__overlay-link",function(e){e.delegateTarget.className+=" faux-block-link--hover"}),n.on("mouseout",".faux-block-link__overlay-link",function(e){e.delegateTarget.className=e.delegateTarget.className.replace(/ faux-block-link--hover/,"")})}}}),define("module/hyperpuff/minihyper",["module/bootstrap","config"],function(e,t){var n=4,r=['<aside class="pullout mini-hyper">','<div class="pullout-inner">','<h2 class="heading">{{title}}</h2>','<ul class="related-items">{{content}}</ul>',"</div>","</aside>"].join(""),i=function(e,t){return r.replace("{{title}}",e).replace("{{content}}",t)};return{init:function(){var r;try{r=t.asset.options.allowRelatedStoriesBox}catch(s){r=!1}if(r){var o=e.$(".hyperpuff"),u=e.$(".hyper-title",o).text(),a=e.$(".group .unit",o),f=e.$(".story-body__introduction").first(),l=document.createElement("div"),c=a.length<4?a.length:n;if(o.length){for(var h=0;h<c;h++)l.appendChild(a[h].cloneNode(!0));f.length&&f.before(i(u,l.innerHTML))}}}}}),define("module/components/hyper",["module/bootstrap","module/hyperpuff/minihyper"],function(e,t){return{handleSuccess:function(n,r){var i=e.$(n.selector);i.find(".placeholder-hyperpuff").html(r),i.removeClass("not-fetched").addClass("fetched"),t.init(),e.pubsub.emit("hyperpuff:complete")}}}),define("module/components/hyperAdapter",["module/components/hyper"],function(e){var t=function(t,n){var r="#"+t.elementId,i;n["comp-hyper"]&&n["comp-hyper"].html&&(i=n["comp-hyper"].html),e.handleSuccess({selector:r},i)};return{handleSuccess:t}}),define("module/components/in_view_detector",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){var n=e.$,r=t.debounce(function(){i.checkModulesInView()},100),i={eventName:"module:in:view",modules:[],eventsSet:!1,window:n(window),register:function(t){var i=n("#"+t);if(!t||i.length===0)return;this.modules.push(i),this.addRegisteredClass(i),this.eventsSet||(e.pubsub.on(this.eventName,n.proxy(this.moduleInView,this)),this.window.on("scroll",r),this.eventsSet=!0),this.window.on("load",n.proxy(function(){this.checkModuleInView(i)},this))},addRegisteredClass:function(e){e.addClass(e.attr("id")+"--in-view-registered")},moduleInView:function(e){this.removeModule(e),e=n(e),e.addClass(e.attr("id")+"--in-view")},removeModule:function(t){var n=[],i=this.modules.length;for(var s=0;s<i;s++)this.modules[s][0]!==t&&n.push(this.modules[s]);this.modules=n,this.modules.length===0&&(e.pubsub.off(this.eventName),this.window.off("scroll",r),this.eventsSet=!1)},checkModulesInView:function(){var e=this,t=this.modules.length;for(var n=0;n<t;n++)e.checkModuleInView(this.modules[n])},checkModuleInView:function(t){this.isModuleInView(t)&&e.pubsub.emit(this.eventName,t)},isModuleInView:function(e){if(e===undefined)return!1;e=e[0];if(!e)return!1;var t=this.window.height(),n=e.getBoundingClientRect(),r=n.top>=0&&n.top<t,i=n.bottom>0&&n.bottom<=t,s=r||i;return s}};return i}),define("module/liveEvent/timeline",["config","module/bootstrap","module/stats/comscore"],function(e,t,n){var r=function(t,n,r,i){i=i||{},this.poller=r,this.view=n,this.channel=t,this.sort=i.sort||"descending",this.active=typeof i.active=="undefined"?!0:!!i.active,this.host=i.pulsarPollingHost||"",this.path=i.pulsarPollingPath||"/"+e.service+"/walkietalkie/pulsar/"+t,this.requestInProgress=!1};return r.prototype={init:function(){var n=this;t.pubsub.on("timeline:more:click",function(){n.requestMoreEntries(),e.features2.comscore_analytics&&n.logComscoreEvent()}),this.setupPolling()},setupPolling:function(){this.sort==="descending"&&this.active&&(this.poller.startCacheBusting(),this.poller.setUrl(this.buildPulsarUrl(!0)),this.poller.startPolling({success:t.$.proxy(function(e){return t.pubsub.emit("timeline:new:dataReceived",[e]),this.buildPulsarUrl(!0)},this),error:function(e){t.pubsub.emit("timeline:new:dataError","dataError")}}))},requestMoreEntries:function(){var e=this;this.requestInProgress||(this.requestInProgress=!0,t.$.ajax({url:this.buildPulsarUrl(!1),dataType:"jsonp",jsonpCallback:"callback",success:function(n){e.requestInProgress=!1,t.pubsub.emit("timeline:more:dataReceived",[n])},error:function(n,r,i){e.requestInProgress=!1,t.pubsub.emit("timeline:more:dataError",[n,r,i])}}))},buildPulsarUrl:function(e){var t={sort:this.sort};return e?(t.entryId=this.view.getTopId(),t.top=!0):t.entryId=this.view.getBottomId(),this.host+this.buildUrl(this.path,t)},buildUrl:function(e,t){var n="";for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];if(!i)continue;n+=r+"="+i+"&"}return n.length>0&&(n=n.substring(0,n.length-1),e=e+"?"+n),e},logComscoreEvent:function(){var t=new n(e);t.sendClickBeacon("show-more")}},r}),define("module/liveEvent/timelineView",["module/bootstrap","translator"],function(e,t){function r(e){return"#"+e.replace(/(:|\.)/g,"\\$1")}var n=function(t){this.container=e.$(t),this.articleWrapper=this.$(".article-wrapper"),this.moreButton=this.$(".timeline-more a"),this.moreButtonText=this.$(".timeline-more a .cta"),this.windowTopAboveContainerFlag=this.isWindowTopAboveContainer(),this.init(),this.moreButton.append('<span class="spin"></span>')};return n.prototype={init:function(){var t=this;if(this.moreButton.length>0){this.buttonShowMore(),this.moreButton[0].setAttribute("href","#more-button"),this.moreButton[0].addEventListener("click",function(n){return n.preventDefault(),t.moreButton.removeClass("highlighted"),t.buttonLoading(),e.pubsub.emit("timeline:more:click"),!1},!1);var n=function(e,n){t.moreButton[0].addEventListener(e,function(){t.moreButton[n+"Class"]("highlighted")},!1)};n("touchstart","add"),n("touchmove","remove"),n("touchend","remove")}window.addEventListener("scroll",function(){t.hasScrolledAboveContainer()&&e.pubsub.emit("timeline:scroll:top")},!1),window.addEventListener("unload",function(){t.buttonShowMore()},!0),e.pubsub.on("timeline:more:dataReceived",function(e){t.buttonShowMore(),t.appendEntries(e),e.hasMore===!1&&t.buttonHide()}),e.pubsub.on("timeline:new:dataReceived",function(e){t.prependEntries(e),t.handleStickies(e)}),e.pubsub.on("timeline:scroll:top",function(){t.showHiddenEntries()}),e.pubsub.on("timeline:more:dataError",function(){t.buttonError()}),e.pubsub.on("timeline:temp:load",function(){t.buttonLoading()})},handleStickies:function(e){e&&e.stickies&&(this.addStickies(e.stickies),this.removeStickies(e.stickies))},addStickies:function(t){var n=this.$(".sticky-wrapper");for(var i in t)if(t.hasOwnProperty(i)){var s=t[i],o=r(i),u=o+"_stuck";this.$(u).length===0&&(s=s.replace(i,i+"_stuck"),n.prepend(s),this.$(u+" > div").addClass("deleted"));var a=this.$(o);a.length>0&&a.hide()}setTimeout(function(){e.$(".sticky-wrapper .deleted").removeClass("deleted")},500)},removeStickies:function(t){var n=this.$(".sticky-wrapper article");n.each(function(n,i){var s=i.id.replace("_stuck",""),o=s in t;o||(e.$(i).remove(),e.$(r(s)).show())})},updateButton:function(e,t){this.moreButton.removeClass("loading").removeClass("error"),this.moreButton.addClass(e),this.moreButtonText.html(t)},buttonShowMore:function(){this.updateButton("",t.get("showMore"))},buttonHide:function(){this.moreButton.hide()},buttonLoading:function(){this.updateButton("loading","Loading")},buttonError:function(){this.buttonShowMore()},getIds:function(){var e=this.$(".article-wrapper article");return e.length>0?e:[]},getTopId:function(){var e=this.getIds();if(e.length>0)return e[0].getAttribute("id")},getBottomId:function(){var e=this.getIds();return e?e[e.length-1].getAttribute("id"):null},appendEntries:function(e){e.text&&this.articleWrapper.append(e.text)},prependEntries:function(e){if(e&&e.text){this.articleWrapper.prepend('<div class="hidden">'+e.text+"</div>");if(this.windowTopAboveContainerFlag){var t=this;setTimeout(function(){t.showHiddenEntries()},500)}}},hasScrolledAboveContainer:function(){var e=this.isWindowTopAboveContainer();return this.windowTopAboveContainerFlag!==e?(this.windowTopAboveContainerFlag=e,e):!1},isWindowTopAboveContainer:function(){var e=this.container[0];if("getBoundingClientRect"in e)return e.getBoundingClientRect().top>0;var t=0;if(e.offsetParent)while(e.offsetParent!==null)e=e.offsetParent,t+=e.offsetTop;else t=e.offsetTop;return t>window.pageYOffset},showHiddenEntries:function(){this.$(".hidden").removeClass("hidden")},$:function(t){return e.$(t,this.container)}},n}),define("module/tabbed/panel",["module/bootstrap"],function(e){function r(e){t(e).attr("role","tabpanel")}var t=e.$,n=function(e){this.hide=function(){e.removeClass("open"),e.addClass("closed")},this.show=function(){e.removeClass("closed"),e.addClass("open")},r(e)};return n}),define("module/tabbed/tab",["module/bootstrap","module/tabbed/panel"],function(e,t){function r(e){return typeof e=="object"&&isFinite(e.length)}function i(e){return r(e)?n(e[0]):n(e)}function o(e,t){e.eq(0).attr("role","presentation"),e.parent().eq(0).attr("role","tablist"),t&&t.attr("role","tab")}function u(e){var t=e.which,r=n(e.target).parent(),i=r.next().find("a"),s=r.prev().find("a"),o=r.parent().find("a").first(),u=r.parent().find("a").last(),a;t===39?a=i.length?i:o:t===37&&(a=s.length?s:u),a&&(a.trigger("click"),a[0].focus())}var n=e.$,s=function(e,n,r,s){this.tabsName=s,this.tabId=typeof r!="undefined"?r:"",this.tab=i(e),this.panel=new t(i(n)),this.tabAnchor=this.tab.find("a")||!1,this.selected=!1,this.dataEvent=this.tab.attr("data-event")||!1,this.addListerners(),o(this.tab,this.tabAnchor)};return s.prototype.addListerners=function(){n(this.tab[0]).on("click",n.proxy(function(t){t.preventDefault(),e.pubsub.emit("tabs:click"),this.selected||e.pubsub.emit("tabs:activate",[this.tabsName,this.tabId])},this)),n(this.tab[0]).on("keydown",n.proxy(function(e){u(e)},this)),e.pubsub.on("tabs:deactivate",n.proxy(function(e){e===this.tabsName&&this.deactivate()},this)),e.pubsub.on("tabs:activate",n.proxy(function(e,t){t===this.tabId&&e===this.tabsName&&this.activate()},this))},s.prototype.activate=function(t){this.selected=!0,e.pubsub.emit("tabs:deactivate",[this.tabsName]),this.tab.addClass("open"),this.panel.show(),this.tabAnchor&&this.tabAnchor.attr("tabindex","0").append('<span class="off-screen"> selected</span>'),!t&&this.dataEvent&&e.pubsub.emit("tabs:activate:"+this.dataEvent)},s.prototype.deactivate=function(){this.selected=!1,this.tab.removeClass("open"),this.tab.find("span.off-screen").remove(),this.panel.hide(),this.tabAnchor&&this.tabAnchor.attr("tabindex","-1")},s}),define("module/tabbed/tabbed",["module/bootstrap","module/tabbed/tab"],function(e,t){function i(e,t,r){for(var i=0,s=e.length;i<s;i++){var o=i+1,u=e[i],a=t+"__tab-"+o;e[i]==="#"+n(e[i]).attr("id")&&(e[i]="#"+a),n(u).attr("id",a),n(r[i]).addClass("panel-"+o).attr("aria-labelledby",t+"__tab-"+o)}return e}var n=e.$,r=function(e,n,r,s){r=r===undefined?!0:r,this.tabsName=s||"default",this.tabs=[],e=i(e,this.tabsName,n);for(var o=0,u=e.length;o<u;o++)this.tabs.push(new t(e[o],n[o],o,this.tabsName));typeof this.tabs[0]!="undefined"&&this.tabs[0].activate(r)};return r.prototype.addTab=function(e,n){this.tabs.push(new t(e,n,this.tabs.length,this.tabsName))},r}),define("module/transclude",["module/bootstrap"],function(e){var t=function(){};return t.prototype.get=function(t,n){function i(e,t,r){n[e]&&n[e](t,r)}function s(){r.shift(),r.length===0&&i("complete")}function o(e){var t=e.getAttribute("data-fetch-url");return t||e.href}function u(e){e+="?";for(var t in n.urlParameters)e+=t+"="+n.urlParameters[t]+"&";return e.slice(0,-1)}n=n||{};var r=[];(function(a){e.$(t).each(function(t,a){a=typeof a!="number"?a:t;if(!a.href){i("error","Error: No href attribute on  elm "+t,t);return}r.push(t);var f=o(a),l=e.$(n.target||a),c=n.maintainLink||!1;n.requestUrl&&(f=n.requestUrl),n.urlParameters&&(f=u(f)),e.$.ajax({url:f,dataType:"html",success:function(e){c||a.setAttribute("href","#"+(a.id||"transcluded"+(new Date).getTime()));if(n.insert)l.html(e);else if(l[0]){var r=l[0].id?'id="'+l[0].id+'"':"";l.replaceWith("<div "+r+">"+e+"</div>")}s(),i("success",e,t)},error:function(e){s(),i("error","Error: 404",t)}})})})(this)},t}),define("module/history/native",["module/bootstrap"],function(e){var t=function(t,n){this.EmittedFromHistory=!1;var r=this,i=function(t){e.pubsub.on(t,function(){r.EmittedFromHistory?r.EmittedFromHistory=!1:window.history.pushState({isNewsMobile:!0,eventName:t,eventData:Array.prototype.slice.call(arguments)},"")})};for(var s=0,o=t.length;s<o;s++)i(t[s]);window.addEventListener("popstate",function(t){t.state&&"isNewsMobile"in t.state&&(r.EmittedFromHistory=!0,e.pubsub.emit(t.state.eventName,t.state.eventData))},!1),typeof n!="undefined"&&window.history.replaceState({isNewsMobile:!0,eventName:n.eventName,eventData:n.data},"")};return t}),define("module/history/hashed",["module/bootstrap"],function(e){var t=function(t,n,r){var i=this;this.sessionStorage=r||window.sessionStorage,this.EmittedFromHistory=null,this.queue=[],this.historyPos=0,e.pubsub.on("history:hashchange",function(e){i.manageHashChange(e)}),window.addEventListener("hashchange",function(t){typeof t.newURL=="undefined"&&(t.newURL=window.location.href),e.pubsub.emit("history:hashchange",[t.newURL.split("#")[1]])},!0),window.addEventListener("unload",function(){i.sessionStorage.setItem("news:history:save:"+window.location.pathname,JSON.stringify(i.queue))},!0),this.initState(n),this.addPubSubListeners(t)};return t.prototype.addPubSubListeners=function(t){var n=this,r=function(t){e.pubsub.on(t,function(){n.EmittedFromHistory===t?n.EmittedFromHistory=null:(window.location.href=window.location.pathname+"#"+n.incrementHistoryPos(),n.queue[n.historyPos]={isNewsMobile:!0,eventName:t,eventData:Array.prototype.slice.call(arguments)})})};for(var i=0,s=t.length;i<s;i++)r(t[i])},t.prototype.incrementHistoryPos=function(){return this.historyPos++,this.historyPos},t.prototype.initState=function(t){var n=this.sessionStorage.getItem("news:history:save:"+window.location.pathname);n&&typeof window.location.hash!="undefined"?(this.queue=JSON.parse(n),this.historyPos=window.location.hash.split("#")[1],e.pubsub.emit("history:hashchange",[this.historyPos])):typeof t!="undefined"&&(window.location.href=window.location.pathname+"#"+this.historyPos,this.queue[this.historyPos]={isNewsMobile:!0,eventName:t.eventName,eventData:t.data})},t.prototype.manageHashChange=function(t){var n=this.queue[t];typeof n!="undefined"&&(this.EmittedFromHistory=n.eventName,e.pubsub.emit(n.eventName,n.eventData))},t}),define("module/history/history",["require","module/history/native","module/history/hashed"],function(e){return typeof window.history=="object"&&typeof window.history.pushState!="undefined"?e("./native"):e("./hashed")}),define("module/liveEvent/liveMediaPlayerView",["module/bootstrap","module/featureDetector","translator"],function(e,t,n){var r=e.$,i={live:n.get("live"),watch:n.get("watch")},s={item:150,itemSpacing:2},o={carousel:"media-nav--carousel",item:"media-nav__item",highlight:"media-nav__item--highlight",live:"media-nav__item--live",ondemand:"media-nav__item--ondemand"},u={container:'<div class="media-nav"></div>',items:'<ol class="media-nav__items"></ol>',item:'<li class="media-nav__item {{itemClass}}"><b>{{label}}</b> {{headline}}</li>'},a={init:function(e,t){return this.container=r(e),this.mediaItems=t,this.mediaNav=this.createNav(),this.mediaNavContainer=this.mediaNav.find(".media-nav__items"),this.mediaNavItems=this.mediaNavContainer.find(".media-nav__item"),this.supportsCarousel()&&(this.mediaNav.addClass(o.carousel),this.setMediaNavWidth()),this.container.after(this.mediaNav),this.bindEvents(),this},createNav:function(){var e=r(u.items);return r.each(this.mediaItems,r.proxy(function(t,n){e.append(this.createNavItem(t,n))},this)),r(u.container).append(e)},createNavItem:function(e,t){var n=t.video.live,s=n?i.live:i.watch,a=n?o.live:o.ondemand,f=u.item.replace("{{itemClass}}",a).replace("{{label}}",s).replace("{{headline}}",t.headline);return r(f)},supportsCarousel:function(){return t.is("AndroidMobile2")?!1:!0},setMediaNavWidth:function(){var e=this.mediaItems.length*s.item,t=(this.mediaItems.length-1)*s.itemSpacing,n=e+t;this.mediaNavContainer.css("width",n)},bindEvents:function(){this.mediaNavContainer.on("click","li",r.proxy(function(t){var n=r(t.currentTarget),i=this.mediaNavItems.index(n);n.hasClass(o.highlight)||(e.pubsub.emit("medianav:select",[this.mediaItems[i],i]),this.highlightItem(i))},this))},highlightItem:function(e){this.mediaNavItems.removeClass(o.highlight).eq(e).addClass(o.highlight)}};return a}),define("module/liveEvent/liveMediaPlayer",["module/bootstrap","module/media/mediaLoader","module/featureDetector","module/liveEvent/liveMediaPlayerView"],function(e,t,n,r){function o(e){var t=["journalism_uk_news_stream_04"];for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function u(e){return i.grep(e,function(e){if(e.video)return o(e.video.externalId)?!1:!0})}function a(e,n){if(n){i(e).empty();var r=new t(e,n.video,{width:"100%",height:"0%",forceErrorMessages:!1,mediaId:n.video.externalId})}}var i=e.$,s={ITEMS_NOT_ARRAY:"init expects an array as it's first parameter"};return{init:function(e,t){if(!e||!t)return;if(!document.querySelector(e))return;if(!i.isArray(t))throw TypeError(s.ITEMS_NOT_ARRAY);this.selector=e,this.mediaItems=u(t),this.createView(),this.bindEvents(),this.loadMediaItem(0)},createView:function(){this.view=r.init(this.selector,this.mediaItems)},bindEvents:function(){e.pubsub.on("medianav:select",i.proxy(function(e,t){a(this.selector,e)},this))},loadMediaItem:function(e){a(this.selector,this.mediaItems[e]),this.view.highlightItem(e)}}}),define("module/live-event",["config","module/bootstrap","module/liveEvent/timeline","module/liveEvent/timelineView","module/poller","module/tabbed/tabbed","module/transclude","module/ajaxForm/ajaxForm","module/ajaxForm/ajaxFormView","module/history/history","module/liveEvent/liveMediaPlayer"],function(e,t,n,r,i,s,o,u,a,f,l){return{init:function(e,c){(function(){var e=["Webkit","Moz"],n=[];for(var r in e)n.push(document.body.style[e[r]+"AnimationName"]);t.$("html").addClass(n.indexOf("")>-1?"css-anim":"animated-gif")})(),l.init("#media-wrapper",c);var h=t.$,p=h("#live-tabs li"),d=h("#live-panels .panel"),v=h(".tab-2 a")[0],m=h(".tab-3 a")[0],g=v?d.splice(0,2,d[1],d[0]):null,y=p[0]?new s(p,d):null,b=new o,w=new n(e.channelId,new r("#live-timeline"),new i(e.pollPeriod),{sort:e.channelOrder,active:e.isLive,pulsarPollingHost:e.pollingHost}),E=new f(["tabs:activate"],{eventName:"tabs:activate",data:[0]});w.init(),m&&(m.href+="?transcluded=true",b.get(m,{target:"#contribute-placeholder",success:function(){var e=new u,t=new a("#join-discussion");window.location.hash==="#contribute"&&h(m).trigger("click")}}))}}}),define("module/components/liveEventPage",["module/live-event"],function(e){var t=document.getElementById("live-event-page"),n=t.getAttribute("data-live-event-opts"),r=JSON.parse(n),i=t.getAttribute("data-media-player-items"),s=JSON.parse(i);e.init({channelId:r.channelId,channelOrder:r.channelOrder,pollingHost:r.pollingHost,pollPeriod:r.pollPeriod,isLive:r.isLive},s)}),define("module/components/liveEventPromo",["config","module/bootstrap","module/poller","module/timestamp"],function(e,t,n,r){return{pollingUrl:function(e,t,n){return typeof t=="undefined"&&(t={service:"nfp"}),e+"/"+t.service+"/walkietalkie/latest_index_asset/"+n},handleSuccess:function(){if(e.features.liveeventcomponent){this.init(e.pollingHost,null);var n=t.$("primary-live-event.faux-block-link");n.on("mouseover",".faux-block-link__overlay-link",function(e){e.delegateTarget.className+=" faux-block-link--hover"}),n.on("mouseout",".faux-block-link__overlay-link",function(e){e.delegateTarget.className=e.delegateTarget.className.replace(/ faux-block-link--hover/,"")})}},init:function(i,s){var o=t.$,u=this;o("[data-channel]").each(function(){var t=o(".live-event-index__container",this),a=o(".live-event-index__summary",t),f=o(".live-event-index__entries",t),l=o(this).attr("data-channel"),c=new n(30),h="",p=u.pollingUrl(i,e,l);c.startCacheBusting(),c.setUrl(p),c.startPolling({success:function(e){o.trim(f.html())||a.remove();if(e.entryId!==h){var t=null;if(e.createTime){var n=e.createTime.split(/[\-T:]/g),i=new Date(n[0],n[1]-1,n[2]);i.setHours(n[3],n[4],n[5]);var u=((new Date).getTime()-i.getTime())/1e3,l=new r(null),c=l.timeAgoInWords(u);c&&(t='<span class="date--v2">'+c+"</span>")}if(t){var d=e.html.indexOf(">")+1,v=e.html.substring(0,d),m=e.html.substring(d);e.html=v+t+m}return s?s(f,e.html):(f.css("opacity","0"),setTimeout(function(){f.html(e.html).css("opacity","1")},1200)),h=e.entryId,p}},error:function(){o.trim(f.html())||(f.css("display","none"),a.css("visibility","visible"),c.stopPolling())}})})}}}),define("module/components/localLive",["module/bootstrap","module/request","module/featureDetector"],function(e,t,n){var r=e.$,i={COMPONENT:"#comp-local-live",BUTTON:".local-live__progress-button",STICKY_WRAPPER:".sticky-wrapper",ARTICLE_WRAPPER:".article-wrapper",TOGGLE:".toggle"};return{handleSuccess:function(e){var s,o;this.localLive=r(e),this.stickyWrapper=this.localLive.find(i.STICKY_WRAPPER),this.articleWrapper=this.localLive.find(i.ARTICLE_WRAPPER),this.toggledElems=this.localLive.find(i.TOGGLE),this.canTransition=n.can("CssTransition"),this.button=r(i.BUTTON),this.localLive.data("live-event-channel")&&this.localLive.data("live-event-channel")!==""?o=this.localLive.data("live-event-channel"):o=null,this.localLive.data("polling-host")&&this.localLive.data("polling-host")!==""&&(s=this.localLive.data("polling-host"));if(!s||!o)return;this.request=new t({getUpdatesOnInit:!0,url:this.constructPulsarUrl(s,o),success:r.proxy(this.handleRefreshSuccess,this),pending:r.proxy(this.handleRefreshPending,this),complete:r.proxy(this.handleRefreshComplete,this)}),this.bindEvents()},constructPulsarUrl:function(e,t){return e+"/news/walkietalkie/pulsar/"+t+"?sort=descending&limit=3&show=all"},handleRefreshSuccess:function(e){this.transition(r.proxy(function(){this.insertStickies(e.stickies),this.insertArticles(e.text)},this))},handleRefreshPending:function(){this.button.addClass("spinner")},handleRefreshComplete:function(){this.button.removeClass("spinner")},transition:function(e){this.canTransition?(this.toggledElems.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",r.proxy(function(){e(),this.showUpdates()},this)),this.hideUpdates()):e()},insertStickies:function(e){var t="",n;for(n in e)e.hasOwnProperty(n)&&(t+=e[n]);this.stickyWrapper.html(t)},insertArticles:function(e){this.articleWrapper.html(e)},hideUpdates:function(){this.toggledElems.addClass("refreshing")},showUpdates:function(){this.toggledElems.removeClass("refreshing")},bindEvents:function(){this.button.on("click",r.proxy(function(e){this.request.getUpdates()},this))}}}),define("module/components/market_data/chart",["module/bootstrap","deviceInspector"],function(e,t){var n=e.$,r="group1",i="",s=".markets-chart__image",o=".markets-chart__timespans",u=".markets-chart_timespan-item",a="markets-chart_timespan-item--selected",f={group1:{height:171,width:304},group2:{height:171,width:304},group3:{height:343,width:610},group4:{height:363,width:645}},l=function(e){this.init(n(e))};return l.prototype.init=function(r){this.image=r.find(s);if(this.image.length===0)return;this.imageUrl=this.image.data("chart-url"),i=this.image.data("chart-code"),this.timespans=r.find(o),this.timespanItems=r.find(u),this.timespans.on("click",u,n.proxy(this.handleClick,this)),this.handleResize(t.getGroup()),e.pubsub.on("deviceGroup",n.proxy(this.handleResize,this))},l.prototype.handleClick=function(e){return this.swapImage(e),this.toggleSelected(e),!1},l.prototype.swapImage=function(e){var t=e.target.getAttribute("data-timespan"),n=this.imageUrl.replace("CHART_TIMESPAN",t);this.track({chart_ticker:i,chart_timespan:t,chart_width:f[r].width,chart_height:f[r].height});if(this.image.attr("src")===n)return;this.image.attr("src",n)},l.prototype.toggleSelected=function(e){this.timespanItems.removeClass(a),n(e.target).addClass(a)},l.prototype.track=function(t){e.pubsub.emit("marketdata:chart:toggle",[t])},l.prototype.handleResize=function(e){r=e,this.imageUrl=this.imageUrl.replace("CHART_WIDTH",f[e].width).replace("CHART_HEIGHT",f[e].height),n("."+a).trigger("click")},l}),define("module/components/market_data/company_ticker_chart",["module/components/market_data/chart"],function(e){return{init:function(t){new e(t.selector)}}}),define("module/components/market_data/company_ticker_navigation",["module/bootstrap"],function(e){var t=e.$,n,r="markets-selector-item__link",i="."+r,s,o="markets-selector-item__link--selected",u="company-ticker-top__market-panel",a="."+u,f;return{init:function(e){n=t(e.selector),s=n.find(i);if(s.length<=1)return;f=t(a),f.hide().first().show(),n.on("click",i,t.proxy(this.handleClick,this))},handleClick:function(e){var n=t(e.target);return f.hide(),s.removeClass(o),t(n.attr("href")).show(),n.addClass(o),!1}}}),define("module/components/market_data/company_ticker_top",["module/bootstrap","module/components/market_data/chart"],function(e,t){var n=e.$,r=".markets-chart";return{init:function(e){n(e.selector).find(r).each(function(){new t(this)})}}}),define("module/components/market_data/index-selector",["module/bootstrap"],function(e){var t=e.$,n="index-selector__toggle--open",r="index-selector__index--selected",i,s;return{init:function(){this.getElements(),i.addClass("hidden"),i.find("li").first().addClass("hidden"),s.on("click",this.toggleDropdown)},getElements:function(){i=t(".index-selector__indices"),s=t(".index-selector__main button")},toggleDropdown:function(e){e.preventDefault(),s.toggleClass(n),i.toggleClass("hidden")}}}),define("module/components/market_data/markets_index_chart",["module/components/market_data/chart"],function(e){return{init:function(t){new e(t.selector)}}}),define("module/components/scotland_decides/dropdown",["module/bootstrap"],function(e){var t=e.$,n,r,i,s,o,u,a,f,l,c,h;return{handleSuccess:function(e){this.component=e,this.setModule(),this.displayDropdown(),this.setupVars(),this.removeHeaderLink(),this.resetDropdown()},setModule:function(){n=t("#"+this.component.id)},setupVars:function(){r="#"+n.data("list"),i="#"+n.data("header"),f=n.data("button"),l=t("#"+f).text(),c=t("#"+f).data("close"),s="."+n.data("item"),o=n.data("item-selected"),u="."+o,a=n.data("open"),h=t("#page")},removeHeaderLink:function(){var e=t(i);e.html(e.find("a").html())},bindButtonEvent:function(){t("#"+f).one("click",t.proxy(this.toggleList,this))},bindHtmlEvent:function(){t("html").one("click",t.proxy(this.resetDropdown,this))},resetDropdown:function(){this.bindButtonEvent(),this.removeListOpenClass(),this.removeMinPageHeight(),this.hideNonSelectedItems(),this.changeButtonText(l)},hideNonSelectedItems:function(){t(r+" "+s+":not("+u+")").hide()},showAllItems:function(){t(r+" "+s).show()},changeButtonText:function(e){t("#"+f).find("span").html(e)},removeListOpenClass:function(){t(r).removeClass(a)},addListOpenClass:function(){t(r).addClass(a)},toggleList:function(){this.showAllItems(),this.addListOpenClass(),this.addMinPageHeight(),this.changeButtonText(c),setTimeout(t.proxy(this.bindHtmlEvent,this),0)},addMinPageHeight:function(){h.css("min-height",2050)},removeMinPageHeight:function(){h.css("min-height",0)},displayDropdown:function(){var e=n.find("script");n.append(e.html()),e.remove()}}}),define("module/components/market_data/markets_index_dropdown",["module/bootstrap","module/components/scotland_decides/dropdown"],function(e,t){return{init:function(e){t.handleSuccess({id:"comp-markets-index-dropdown"})}}}),define("module/components/mediaPlayer/mainAdapter",["module/components/mediaPlayer/main"],function(e){e.processNewPlayers()}),define("module/components/moreFromThisIndex",["module/bootstrap","module/timestamp","module/imageenhancer"],function(e,t,n){return{handleSuccess:function(r,i){var s=e.$(r.selector),o;s.find(".small-promo-group__body").html(i),o=new t((new Date((new Date).toUTCString())).getTime()),o.insertTime(),new n}}}),define("module/components/moreFromThisIndexAdapter",["module/bootstrap"],function(e){var t=function(t,n){if(n["comp-more-from-this-index"]&&n["comp-more-from-this-index"].html){var r=document.getElementById(t.elementId),i=e.$(r),s=n["comp-more-from-this-index"].html;i.find(".small-promo-group__body").html(s),require(["module/components/responsiveImage","module/components/timestampAdaptor"],function(e,n){var r="#"+t.elementId;e.reProcess(r),n.reProcess(r)})}};return{handleSuccess:t}}),define("module/components/mostPopular",["module/bootstrap","module/tabbed/tabbed"],function(e,t){return{handleSuccess:function(t,n){t=t||{},this.selector=t.selector,this.element=e.$(this.selector);if(!this.element.length)return;n&&this.element.replaceWith(n),e.$(this.selector).find(".most-popular__header__tabs").length&&this.loadTabs()},loadTabs:function(){var n=new t(e.$(".most-popular__header__tabs li"),e.$(".most-popular__list-container"),!0,"most-popular")}}}),define("module/components/mostPopularAdapter",["module/bootstrap","module/components/mostPopular"],function(e,t){e.$(".most-popular__header__tabs").length&&t.loadTabs()}),define("module/stream/core",["module/bootstrap","module/stream/endpoint"],function(e,t){return function(n){var r=e.$({}),i=new t(n.latest,r,"latest"),s=new t(n.earlier,r,"earlier");return r.on("latest:request",function(){i.request()}),r.on("earlier:request",function(){s.request()}),r.on("latest:endpoints",function(e,t){s.setUrl(t.earlier)}),{emit:function(e){r.trigger(e)},on:function(e,t){r.on(e,function(){return t.apply(this,Array.prototype.slice.call(arguments,1))})}}}}),define("module/stream/view",["module/bootstrap","translator","module/featureDetector"],function(e,t,n){var r=e.$,i={refresh:'<p class="comp-stream__error comp-stream__error--refresh">{{message}}</p>',showMore:'<p class="comp-stream__error comp-stream__error--show-more">{{message}}</p>'},s=function(e,t){return r.contains(e[0],t[0])},o=n.which("TransitionEnd"),u=function(e,t){n.can("CssTransition")?(e.on(o,function(){e.off(o),t(),e.removeClass("refreshing")}),e.addClass("refreshing")):t()};return function(e,n){var o=r({}),a=r(i.refresh.replace("{{message}}",t.get("streamRefreshError"))),f=r(i.showMore.replace("{{message}}",t.get("streamShowMoreError")));return e.on("latest:updates",function(e){u(n,function(){n.html(e),o.trigger("updates:inserted")}),s(n,a)&&a.remove()}),e.on("earlier:updates",function(e){var t=r.parseHTML(e),i=r("a",t)[0];n.append(t),i&&i.focus(),o.trigger("updates:inserted"),s(n,f)&&f.remove()}),e.on("latest:error",function(e){s(n,a)||n.prepend(a)}),e.on("earlier:error",function(e){s(n,f)||n.append(f)}),{on:function(e,t){o.on(e,function(){return t.apply(this,Array.prototype.slice.call(arguments,1))})}}}}),define("module/stream/refresh_button",["module/bootstrap","translator"],function(e,t){var n=e.$,r=['<button class="comp-stream__button--refresh">','<span class="off-screen">{{label}}</span>','<span class="comp-stream__button--refresh-icon"></span>',"</button>"].join(""),i={normal:t.get("streamRefreshButton")},s={loading:"spinner"};return function(){var e=n(r.replace("{{label}}",i.normal)),t=n({});return e.on("click",function(e){t.trigger("click")}),{appendTo:function(t){e.appendTo(t)},remove:function(){e.detach()},on:function(e,n){t.on(e,n)},setNormal:function(){e.removeClass(s.loading)},setLoading:function(){e.addClass(s.loading)}}}}),define("module/components/nexus/connectedStream",["module/stream/core","module/stream/view","module/stream/refresh_button","module/stream/show_more_button","module/bootstrap","module/featureDetector","module/media/mediaHandler","module/imageenhancer"],function(e,t,n,r,i,s,o,u){function h(e){return{latest:e.opts.endpoints.latest,earlier:e.opts.endpoints.earlier}}var a=i.$,f={init:function(e){return e.on("updates:inserted",a.proxy(this.run,this)),this},run:function(){this.publishTrackEvents(),this.createStatsData()},publishTrackEvents:function(){i.pubsub.emit("component:loaded",["connected-stream-internal"]),i.pubsub.emit("component:loaded",["connected-stream-external"])},createStatsData:function(){var e=a("#comp-connected-stream .update"),t=[".update__image",".update__headline",".update__body"];e.each(function(n,r){a(r).find("a").each(function(r,s){var o=a.grep(t,function(e){return a(s).closest(e).length>0}),u={update_index:n+1,update_total:e.length,update_type:a(s).closest(".update").attr("class"),update_position:o[0]};s.linktrack=i.$.param(u)})})}},l={init:function(e){return e.on("updates:inserted",a.proxy(this.run,this)),this.mediaHandler=new o,this},run:function(){this.mediaHandler.createMedia()}},c={init:function(e){return e.on("updates:inserted",a.proxy(this.run,this)),this},run:function(){new u(".update__body img",".update__image img")}};return{handleSuccess:function(o){var u=a(o.selector),p=s.can("CssTransition"),d=new e(h(o)),v=new t(d,u.find(".updates")),m=new n,g=new r,y=a(".back-to-top");m.on("click",function(){d.emit("latest:request"),i.pubsub.emit("stream:refresh")}),d.on("latest:requesting",function(){m.setLoading()}),d.on("latest:updates",function(){m.setNormal()}),d.on("latest:error",function(){m.setNormal()}),m.appendTo(u.find(".comp-stream__header")),h(o).earlier&&(g.on("click",function(){d.emit("earlier:request"),i.pubsub.emit("stream:showmore")}),d.on("earlier:requesting",function(){g.setLoading()}),d.on("earlier:updates",function(){g.setNormal()}),d.on("earlier:noupdates",function(){g.remove()}),d.on("earlier:error",function(){g.setNormal()}),g.appendTo(u)),d.on("latest:endpoints",function(e){e.earlier&&g.appendTo(u)}),y.on("click",function(){i.pubsub.emit("stream:back-to-top")}),a("body").addClass(p?"css-anim":"animated-gif"),c.init(v).run(),l.init(v).run(),f.init(v).run()}}}),define("module/components/nexus/connectedStreamAdapter",["module/bootstrap","module/components/nexus/connectedStream"],function(e,t){var n=e.$,r=n("#comp-connected-stream");if(r.length){var i=r.data("compMeta");if(i){var s={id:i.id||"",type:i.type||"",handler:i.handler||"",deviceGroups:i.deviceGroups||null,loaded:!0,opts:{about:i.opts.about,title:i.opts.title,endpoints:{latest:i.opts.endpoints.latest,earlier:i.opts.endpoints.earlier}},selector:"#comp-connected-stream",template:i.template};t.handleSuccess(s)}}}),define("module/stats/statsBindingAdapter",["module/globalPubsub","module/components/mediaPlayer/main"],function(e,t){function n(e){return{opts:{mediaType:e.kind()},name:e.name()}}t.subscribeToPlayerEvent("playing",function(t,r){e.emit("video:play",[n(r)])},!0),t.subscribeToPlayerEvent("pause",function(t,r){e.emit("video:pause",[n(r)])},!0),t.subscribeToPlayerEvent("ended",function(t,r){e.emit("video:end",[n(r)])},!0),t.subscribeToPlayerEvent("initialised",function(t,r){e.emit("video:load",[n(r)])},!0)}),define("module/components/nexus/ompConnectedStream",["module/stream/core","module/stream/view","module/stream/refresh_button","module/stream/show_more_button","module/bootstrap","module/featureDetector","module/media/mediaHandler","module/imageenhancer","module/components/mediaPlayer/main","module/stats/statsBindingAdapter"],function(e,t,n,r,i,s,o,u,a){function p(e){return{latest:e.opts.endpoints.latest,earlier:e.opts.endpoints.earlier}}var f=i.$,l={init:function(e){return e.on("updates:inserted",f.proxy(this.run,this)),this},run:function(){this.publishTrackEvents(),this.createStatsData()},publishTrackEvents:function(){i.pubsub.emit("component:loaded",["connected-stream-internal"]),i.pubsub.emit("component:loaded",["connected-stream-external"])},createStatsData:function(){var e=f("#comp-connected-stream .update"),t=[".update__image",".update__headline",".update__body"];e.each(function(n,r){f(r).find("a").each(function(r,s){var o=f.grep(t,function(e){return f(s).closest(e).length>0}),u={update_index:n+1,update_total:e.length,update_type:f(s).closest(".update").attr("class"),update_position:o[0]};s.linktrack=i.$.param(u)})})}},c={init:function(e){return e.on("updates:inserted",f.proxy(this.run,this)),this},run:function(){a.processNewPlayers()}},h={init:function(e){return e.on("updates:inserted",f.proxy(this.run,this)),this},run:function(){new u(".update__body img",".update__image img")}};return{handleSuccess:function(o){var u=f(o.selector),a=s.can("CssTransition"),d=new e(p(o)),v=new t(d,u.find(".updates")),m=new n,g=new r,y=f(".back-to-top");m.on("click",function(){d.emit("latest:request"),i.pubsub.emit("stream:refresh")}),d.on("latest:requesting",function(){m.setLoading()}),d.on("latest:updates",function(){m.setNormal()}),d.on("latest:error",function(){m.setNormal()}),m.appendTo(u.find(".comp-stream__header")),p(o).earlier&&(g.on("click",function(){d.emit("earlier:request"),i.pubsub.emit("stream:showmore")}),d.on("earlier:requesting",function(){g.setLoading()}),d.on("earlier:updates",function(){g.setNormal()}),d.on("earlier:noupdates",function(){g.remove()}),d.on("earlier:error",function(){g.setNormal()}),g.appendTo(u)),d.on("latest:endpoints",function(e){e.earlier&&g.appendTo(u)}),y.on("click",function(){i.pubsub.emit("stream:back-to-top")}),f("body").addClass(a?"css-anim":"animated-gif"),h.init(v).run(),c.init(v).run(),l.init(v).run()}}}),define("module/components/nexus/ompConnectedStreamAdapter",["module/bootstrap","module/components/nexus/ompConnectedStream"],function(e,t){var n=e.$,r=n("#comp-connected-stream");if(r.length){var i=r.data("compMeta");if(i){var s={id:i.id||"",type:i.type||"",handler:i.handler||"",deviceGroups:i.deviceGroups||null,loaded:!0,opts:{about:i.opts.about,title:i.opts.title,endpoints:{latest:i.opts.endpoints.latest,earlier:i.opts.endpoints.earlier}},selector:"#comp-connected-stream",template:i.template};t.handleSuccess(s)}}}),define("module/components/nexus/templates",{refresh:{button:'<button class="comp-stream__button--refresh"><span class="off-screen">{{label}}</span><span class="comp-stream__button--refresh-icon"></span></button>',error:'<p class="comp-stream__error comp-stream__error--refresh">{{message}}</p>'},show_more:{button:'<button class="show-more"><span class="show-more__inner"><span class="show-more__label">{{label}}</span><span class="show-more__spinner"></span></span></button>',error:'<p class="comp-stream__error comp-stream__error--show-more">{{message}}</p>'}}),define("module/liveEvent/ompLiveMediaPlayer",["module/bootstrap","module/components/mediaPlayer/main","module/featureDetector","module/liveEvent/liveMediaPlayerView"],function(e,t,n,r){function a(e){return i.grep(e,function(e){if(e.video)return!0})}function f(e){o.html(u[e]),t.processNewPlayers()}var i=e.$,s={ITEMS_NOT_ARRAY:"init expects an array as it's first parameter"},o,u;return{init:function(t,n){if(!t||!n)return;if(!document.querySelector(t))return;if(!i.isArray(n))throw TypeError(s.ITEMS_NOT_ARRAY);this.selector=t,this.mediaItems=a(n),o=e.$("#lep-playable-data"),u=o.data("lep-playable-html"),this.createView(),this.bindEvents(),this.loadMediaItem(0)},createView:function(){this.view=r.init(this.selector,this.mediaItems)},bindEvents:function(){e.pubsub.on("medianav:select",i.proxy(function(e,t){f(t)},this))},loadMediaItem:function(e){f(e),this.view.highlightItem(e)}}}),define("module/omp-live-event",["config","module/bootstrap","module/liveEvent/timeline","module/liveEvent/timelineView","module/poller","module/tabbed/tabbed","module/transclude","module/ajaxForm/ajaxForm","module/ajaxForm/ajaxFormView","module/history/history","module/liveEvent/ompLiveMediaPlayer"],function(e,t,n,r,i,s,o,u,a,f,l){return{init:function(e,c){(function(){var e=["Webkit","Moz"],n=[];for(var r in e)n.push(document.body.style[e[r]+"AnimationName"]);t.$("html").addClass(n.indexOf("")>-1?"css-anim":"animated-gif")})(),l.init("#media-wrapper",c);var h=t.$,p=h("#live-tabs li"),d=h("#live-panels .panel"),v=h(".tab-2 a")[0],m=h(".tab-3 a")[0],g=v?d.splice(0,2,d[1],d[0]):null,y=p[0]?new s(p,d):null,b=new o,w=new n(e.channelId,new r("#live-timeline"),new i(e.pollPeriod),{sort:e.channelOrder,active:e.isLive,pulsarPollingHost:e.pollingHost}),E=new f(["tabs:activate"],{eventName:"tabs:activate",data:[0]});w.init(),m&&(m.href+="?transcluded=true",b.get(m,{target:"#contribute-placeholder",success:function(){var e=new u,t=new a("#join-discussion");window.location.hash==="#contribute"&&h(m).trigger("click")}}))}}}),define("module/components/ompLiveEventPage",["module/omp-live-event"],function(e){var t=document.getElementById("live-event-page"),n=t.getAttribute("data-live-event-opts"),r=JSON.parse(n),i=t.getAttribute("data-media-player-items"),s=JSON.parse(i);e.init({channelId:r.channelId,channelOrder:r.channelOrder,pollingHost:r.pollingHost,pollPeriod:r.pollPeriod,isLive:r.isLive},s)}),define("module/components/ompMediaAssetPageView",["module/bootstrap","module/media/mediaLoader","module/media/mediaFilter","module/timestamp","translator","config","deviceInspector","module/featureDetector","module/page"],function(e,t,n,r,i,s,o,u,a){function c(){l=new r((new Date((new Date).toUTCString())).getTime()),e.pubsub.on("map:asset:request:success",g),e.pubsub.on("map:asset:request:error",b),e.pubsub.on("map:asset:load",function(){f("#media-asset-page-video figure").remove()}),v()}function h(e){f(".story-inner .more-wrapper").css("display","block"),f(".story-inner .more-text").text(i.get("moreInfo"));var t=f(".map-body",e),n=1;t.children().first().is("figure")&&n++,e.addClass("contains-more-text"),t.append('<div class="hide-wrapper extra-content"></div>');var r=f(".hide-wrapper",e);f(".map-body > *",e).each(function(){n===0&&!f(this).hasClass("hide-wrapper")?r.append(this):--n}),t.removeClass("display-feature-phone-only")}function p(){var t=f(".story-inner"),n=f("#media-asset-page-text",t),r=f(".map-body",n),s='<div class="more-wrapper" style="display: none;"><a class="more-text" href="#" title="'+i.get("moreInfo")+'">'+i.get("moreInfo")+"</a></div>";n.after(s),f(".more-text",t).on("click",function(t){var r=t.target,s=f(".hide-wrapper",n);s.toggleClass("extra-content"),s.hasClass("extra-content")?(e.pubsub.emit("map:asset:summary",["close"]),r.innerHTML=i.get("moreInfo"),r.setAttribute("title",i.get("moreInfo"))):(e.pubsub.emit("map:asset:summary",["open"]),r.innerHTML=i.get("lessInfo"),r.setAttribute("title",i.get("lessInfo"))),t.preventDefault()})}function d(t){t!=="desktop"&&!w()&&(e.pubsub.off("device",d),p(),h(f(".story-inner #media-asset-page-text")))}function v(){var t=f(".story-inner"),n=f("#media-asset-page-text",t),r=f(".more-text",t),i=f(".map-body > *",n).length;i<=1||i===2&&f(".map-body .related-items",n).length>0||o.getType()==="desktop"||w()?(f(".map-body",n).removeClass("display-feature-phone-only"),r.css("display","none"),n.removeClass("contains-more-text"),e.pubsub.on("deviceGroup",d)):(f(".more-text",t).length===0&&p(),h(n))}function m(e){var t,n=[];if(e.images&&e.images.index){var r=e.images.index;for(t in r)r.hasOwnProperty(t)&&n.push(r[t]);return n.sort(function(e,t){return e.width===t.width?0:e.width<t.width?1:-1}),n[0]}return{}}function g(e,t){y(t.countername);var n=f("#media-asset-page-text");f("#media-asset-page-text").html(t.body),l.insertTime(),v(),E(t.related),window.scrollTo(0,1)}function y(e){a.setCountername(e)}function b(e,t,n){}function w(){var e=!1;return s.features2.hasOwnProperty("channel_page")&&(e=s.asset.asset_uri===s.pathPrefix+"/"+s.features2.channel_page.candy_id),e}function E(e){e.match("media-feed-error")?(f(".media-feed.primary-feed.related-video-audio").addClass("hidden"),f("#media-asset-list-view__tab-1").addClass("hidden off-screen")):(f(".media-feed.primary-feed.related-video-audio").removeClass("hidden"),f("#media-asset-list-view__tab-1").removeClass("hidden off-screen"))}var f=e.$,l;return{init:c}}),define("module/mediaAssetPage/listView",["module/bootstrap","module/featureDetector","module/tabbed/tabbed","module/timestamp","translator","config"],function(e,t,n,r,i,s){function l(e,t,n){n(t)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}function c(e,t){window.history.pushState({title:t,path:e},null,e)}function h(t,n){document.title=n,e.pubsub.emit("map:asset:load",[t.replace(s.pathPrefix+"/","")])}function p(n){S(),f=n,a=new r((new Date((new Date).toUTCString())).getTime()),e.pubsub.on("map:feed:request:success",x),e.pubsub.on("map:feed:request:error",T),e.pubsub.on("map:asset:request:success",C),e.pubsub.on("tabs:activate",b),t.can("UseHistoryApi")&&window.addEventListener("popstate",function(e){e.state!==null&&e.state.title&&e.state.path&&(e.state.path.indexOf("/news/video_and_audio/")===-1?h(e.state.path,e.state.title):window.history.go(0))});var i=o(".top_stories.showmore.open .media-feed-placeholder .media-feed-grid");i.length!==0&&i.append(v(L())),d(),w(),N()}function d(){var e=o(".media-feeds")[0];e&&(e.onclick=function(t){var n=t||window.event,r=n.target||n.srcElement;while(r!==e){var i=r.nodeName==="ARTICLE"||r.nodeName==="DIV"&&r.className.indexOf("HTML5article")!==-1;if(i&&o(r).hasClass("media-feed-item")){l(n,r,m);break}if(r.nodeName==="H2"&&o("a",r).length!==0){l(n,r,y);break}if(o(r).hasClass("more-text")){l(n,r,E);break}r=r.parentNode}})}function v(e){var t='<div class="more-wrapper"><a class="more-text" href="#" data-cps-id="'+e+'" title="'+i.get("showMore")+'">'+i.get("showMore")+"</a></div>";return t}function m(e){if(o(e).hasClass("selected"))return!1;e.attributes["data-uri"]!==null&&(window.location.href=e.attributes["data-uri"].value+window.location.search)}function g(e){return o('.media-feed[data-cps-id="'+e+'"]')}function y(t){var n=t.parentNode.attributes["data-cps-id"].value.replace(s.pathPrefix+"/",""),r=g(n),i=o(".media-feed-grid",r);r.toggleClass("open");var u=r.hasClass("open")?"open":"close",a=r.attr("data-event");e.pubsub.emit("map:index:toggle",[a,u]);if(i.length===0&&r.hasClass("open")){var f=o(".media-feed-error",r);f.length!==0&&f.remove(),r.addClass("loading-after"),e.pubsub.emit("map:feed:load",[n])}return!1}function b(t,n){var r=o(u.tabs[n].t).attr("data-cps-id");if(r){var i=g(r),s=o(".media-feed-grid",i);i.addClass("open"),s.length===0&&(i.addClass("loading-after"),e.pubsub.emit("map:feed:load",[r]))}}function w(){var e;o(".media-panel").each(function(t,n){o(n).hasClass("open")&&(e=t)}),u=new n(o("#media-tabs li"),o(".media-panel"),!0,"media-asset-list-view"),s.features2.map_most_watched===!1&&(e=0),e&&(u.tabs[e].activate(),b("default",e))}function E(t){var n=t,r=g(n.getAttribute("data-cps-id"));return r.toggleClass("showmore"),r.hasClass("showmore")?(e.pubsub.emit("map:index:topstories",["close"]),n.innerHTML=i.get("showMore"),n.setAttribute("title",i.get("showMore"))):(e.pubsub.emit("map:index:topstories",["open"]),n.innerHTML=i.get("showLess"),n.setAttribute("title",i.get("showLess"))),!1}function S(){var e=o(".media-feed.top_stories"),t=o("h2",e);o("a",e).replaceWith(function(){return this.innerHTML}),t.text(o.trim(t.text())),e.addClass("primary-feed")}function x(e,t){var n=g(e),r=o(".media-feed-placeholder",n);t&&r.html(t),a.insertTime();if(n.hasClass("showmore")){var i=o(".media-feed-grid",r);i.append(v(e))}n.removeClass("loading-after"),k()}function T(e,t){var n=g(e);n.removeClass("loading-after"),o(".media-feed-error",n).length===0&&n.append('<div class="media-feed-error">'+i.get("mediaUnavailable")+"</div>")}function N(){var t=o(".media-feed.js-postload");t.each(function(t,n){var r=o(n).attr("data-cps-id");r!==null&&o(".media-feed-item",n).length===0&&(o(n).addClass("loading-after"),e.pubsub.emit("map:feed:load",[r]))})}function C(e,t){k(e);var n=o(".related-video-audio .media-feed-grid"),r=o(".related-video-audio .media-feed-error");if(n.length===1){n.replaceWith(t.related);var i=0;o("#media-asset-list-view__tab-1").hasClass("hidden off-screen")&&(i=1),u.tabs[i].activate()}r.length===1&&r.replaceWith(t.related)}function k(e){e&&(f=s.pathPrefix+"/"+e);var t=o(".media-feed-item.selected");t.each(function(e,t){var n=o(t);n.removeClass("selected"),o(".js-media-duration",n).text(n.attr("data-duration"))});var n=o('.media-feed-item[data-uri="'+f+'"]');n.each(function(e,t){var n=o(t);n.addClass("selected"),o(".js-media-duration",n).text(i.get("nowPlaying"))})}function L(){return s.configuration.hasOwnProperty("videotopiccandyid")&&!!s.configuration.videotopiccandyid?s.configuration.videotopiccandyid:"video_and_audio/top_stories"}var o=e.$,u,a,f;return{init:p,modifyTopStoriesHeader:S}}),define("module/mediaAssetPage/api",["module/bootstrap","module/featureDetector"],function(e,t){var n=function(){var t=this;e.pubsub.on("map:asset:load",function(e){t.request(e,"asset")}),e.pubsub.on("map:feed:load",function(e){t.request(e,"feed")})};return n.prototype={request:function(n,r,i){var s=e.config.pathPrefix;e.pubsub.emit("map:request:start",[n,r]),e.$.ajax({url:s+"/api/av/"+r+"/"+n+".html",type:"get",dataType:"json",success:function(t){t.feed&&(t=t.feed),i&&i(t),e.pubsub.emit("map:"+r+":request:success",[n,t])},error:function(t){e.pubsub.emit("map:"+r+":request:error",[n,t])}})}},n}),define("module/mediaAssetPage/map",["module/bootstrap"],function(e){return{init:function(){this.liveStats=e.$("#livestats");var t=this;e.pubsub.on("map:asset:request:success",function(e,n){t.updateLiveStats(n.beacon),t.updateShareTools(n.shareTools)})},updateLiveStats:function(e){if(!this.liveStats.length)return;var t=this.liveStats.attr("src").split("?")[0]+"?";this.liveStats.attr("src",t+e)},updateShareTools:function(t){e.$(".share").replaceWith(t)}}}),define("vendor/bbc-video-experience/bbcdotcom/adverts",[],function(){var e,t,n=function(){return window.bbcdotcom!==undefined&&window.bbcdotcom.config.isAdsEnabled()===!0},r=function(t){e=t.assetType!==undefined?t.assetType:""},i=function(e){t=e},s=function(r){if(!t)return;if(!n())return;var i;try{i=window.bbcdotcom.av.emp.adverts.getPrerollAdTagWithAdRule()}catch(s){return}if(!r||!r.shortHeadline||!r.uri||!r.assetId)return;var o=encodeURIComponent(r.shortHeadline.toLowerCase().split(" ").join("")),u=r.assetId,a=encodeURIComponent(encodeURIComponent(window.location.origin+r.uri)),f=14,l="";while(f--)l+=Math.floor(Math.random()*10);i=i.replace(/(correlator=)(\d+)/g,"correlator="+l),i=i.replace(/(url=)[^&]*/g,"url="+a),e!==""&&(i=i.replace(/(asset_type%3D(media_asset|index))/g,"asset_type%3D"+e)),i=i.replace(/(headline%3D)\w+/g,"headline%3D"+o),i=i.replace(/(story_id%3D)\w+/g,"story_id%3D"+u),t.dispatchEvent("bbc.smp.plugins.ads.event.updateAdTag",{adTag:i})},o=function(){if(n()){var e=document.getElementById("bbccom_mpu"),t='<div class="bbccom_companion_inner"><a href="'+bbcdotcom.locale.get("advertInfoPageUrl")+'" class="bbccom_text">'+bbcdotcom.locale.get("advertisementText")+"</a>"+'<div class="bbccom_advert_inner" id="bbccom_mpu_inner"></div></div>';e.innerHTML=t;var r=bbcdotcom.adverts.adUnit.get();googletag.cmd.push(function(){googletag.defineSlot(r,[300,60],"bbccom_mpu_inner").addService(googletag.companionAds()).addService(googletag.pubads()),googletag.enableServices()})}};return{init:r,initBump:i,isAdsModuleEnabled:n,updateAdTag:s,initCompanionAds:o}}),define("vendor/bbc-video-experience/continuousPlay/playIntent",[],function(){var e=null,t=null,n=function(n,r){t=e,e={index:n,event:null},r&&(e.event=r)},r=function(){return e.index},i=function(){return t===null?null:t.index},s=function(){return e.event},o=function(){return e!==null},u=function(){return t===null};return{create:n,getIndex:r,getEvent:s,getPreviousIndex:i,isActive:o,isFirst:u}}),define("vendor/bbc-video-experience/continuousPlay/analytics",["vendor/bbc-video-experience/continuousPlay/playIntent"],function(e){var t,n={playlistLoaded:"continuousPlay.mediaStarted",dismissContPlay:"continuousPlay.dismissed",openMoreVideos:"continuousPlay.openedMoreVideos",goneFullScreen:"videoExperience:player:enteredFullScreen"},r=function(){try{return window.bbcdotcom!==undefined&&window.bbcdotcom.config.isAnalyticsEnabled()===!0}catch(e){return!1}},i=function(){try{r()&&window.bbcdotcom.setConfig({isContinuousPlayPage:!0})}catch(e){}},s=function(e){t=e},o=function(e,i){if(!t)return;if(!r())return;if(!u[e])throw e+" is not configured for analytics";var s=n[e],o=u[e](i);try{window.bbcdotcom.av.emp.analytics.trackEvent(s,o)}catch(a){}},u={playlistLoaded:function(t){var n={index:e.getIndex(),title:t.title},r=e.getEvent();return r?(n.origin=r.origin!==undefined?"cp-"+r.origin:null,n.cpTimeout=r.secondsIntoCountdown!==undefined?r.secondsIntoCountdown:null,n.fullscreen=r.fullscreen!==undefined?r.fullscreen:null):n.origin=e.isFirst()?"page-load":"manual",n},dismissContPlay:function(e){return{cpTimeout:e.secondsIntoCountdown}},openMoreVideos:function(){return{}},goneFullScreen:function(){return{}}};return{init:i,setBump:s,track:o}}),define("vendor/bbc-video-experience/continuousPlay/config",[],function(){var e,t,n,r=function(r){e=r||{};var i=e.staticPrefix||null;if(!i)throw"options.staticPrefix not defined";var s=e.pluginPath||"/js/vendor/bbc/smp/continuousPlay/";t=i+s+"js/",n=i+s+"swf/"},i=function(n){return{name:"smp.plugin.continuousplay.playlistSetChanged",data:{items:n,countdownDurationSecs:e.countdownDuration||10,path:t,adPluginExists:e.adsEnabled||!1,autoPlayFirstItem:e.autoPlayFirstItem!==undefined?e.autoPlayFirstItem:!0,copy:e.copy}}},s=function(){return{html:t+"continuousPlayPlugin.js",swf:n+"ContinuousPlayPluginFlash.swf"}};return{init:r,getPluginLocations:s,getConfig:i}}),define("vendor/bbc-video-experience/continuousPlay/dataSource",["vendor/bbc-video-experience/continuousPlay/playIntent"],function(e){var t,n,r,i,s,o=function(e){r=e,i=!1,s=[]},u=function(e){r.findItems(function(s,o){if(s)return e(s);t=[],n=[];var u;for(u in o){var a=r.parseItem(u,o),f=parseInt(u,10);a.index=f,t[f]=a,n[f]=r.parseAdvertMeta(u,o)}i||(i=!0,p()),e(null,t)})},a=function(e){h(function(){e(t)})},f=function(n){h(function(){var r=e.getIndex();l(r)&&n(t[r])})},l=function(e){return t&&t[e]?t[e]:undefined},c=function(t){h(function(){var r=e.getIndex();t(n[r])})},h=function(e){i?e():s.push(e)},p=function(){for(var e in s){var t=s[e];t()}s=[]};return{init:o,refresh:u,getCurrentItem:f,getCurrentAdvertMeta:c,getItemAtIndex:l,getData:a}}),define("vendor/bbc-video-experience/continuousPlay/history",["vendor/bbc-video-experience/continuousPlay/dataSource"],function(e){var t,n,r,i,s,o,u=function(e){var u=e||{};t=window.history,n=u.isEnabled||!1,r=u.maintainHistory||!1,i=u.playHandler||function(){},o=!0,s=t&&t.pushState!==undefined,n&&s&&(window.onpopstate=f)},a=function(){if(!n||!s)return;e.getCurrentItem(function(e){if(!e)return;var n=e.title+" - BBC News",i=e.uri+location.search,s=t.state;if(s&&s.uri===i)return;var u={videoIndex:e.index,uri:i,title:n};r&&!o?t.pushState(u,"",i):t.replaceState(u,"",i),l(n),o=!1})},f=function(e){var t=e.state;t&&t.videoIndex&&(i(t.videoIndex),l(t.title))},l=function(e){document.title=e};return{init:u,update:a}}),define("vendor/bbc-video-experience/continuousPlay/module",["vendor/bbc-video-experience/continuousPlay/config","vendor/bbc-video-experience/continuousPlay/dataSource","vendor/bbc-video-experience/continuousPlay/playIntent","vendor/bbc-video-experience/bbcdotcom/adverts","vendor/bbc-video-experience/continuousPlay/analytics","vendor/bbc-video-experience/continuousPlay/history"],function(e,t,n,r,i,s){var o,u=null,a=!1,f=!1,l=null,c=!1,h=!0,p,d,v,m,g,y,b,w,E=function(o,u){var a=u||{};t.init(o),i.init(),e.init({staticPrefix:a.staticPrefix,adsEnabled:r.isAdsModuleEnabled(),countdownDuration:a.countdownDuration,pluginPath:a.pluginPath,autoPlayFirstItem:a.autoPlayFirstItem,copy:a.copy});var f=a.updateBrowserUrl||{};s.init({isEnabled:f.enabled||!1,maintainHistory:f.maintainHistory||!1,playHandler:T}),r.init({assetType:a.advertAssetType}),a.showCompanionAds===!0&&r.initCompanionAds(),C(a.handlers||{}),n.create(a.startIndex||0)},S=function(e){o=e,r.initBump(o),i.setBump(o),o.bind("pluginLoaded",k),o.bind("playlistLoaded",L),o.bind("continuousPlay.play",A),o.bind("continuousPlay.stats",O),o.bind("uiinfo",M),u!==null&&(T(u),u=null)},x=function(){t.refresh(function(t,r){if(t){g(t);return}o.setData(e.getConfig(r));var i=n.isFirst()?n.getIndex():n.getPreviousIndex();m(o.ended()?null:i)})},T=function(e){if(!o){u=e;return}n.create(e),t.getCurrentItem(function(e){o.loadPlaylist(e.playlist)})},N=function(){var e,r,i;if(n.isActive()){e=n.getIndex();if(n.isFirst()||t.getItemAtIndex(e+1))r=e+1;t.getItemAtIndex(e-1)&&(i=e-1)}return{index:e,nextIndex:r,prevIndex:i}},C=function(e){d=e.videoPlayed||function(){},v=e.videoReplayed||function(){},m=e.dataChanged||function(){},g=e.dataFailed||function(){},y=e.dismissed||function(){},p=e.enabled||function(){},b=e.turnOn||function(){},w=e.turnOff||function(){}},k=function(t){var r=e.getPluginLocations();t.eventData!==undefined?f=t.eventData===r.swf:t.url!==undefined?f=t.url===r.html:f=!1,f&&(s.update(),p(n.getIndex()))},L=function(u){i.track("playlistLoaded",u.playlist),t.getCurrentAdvertMeta(function(e){r.updateAdTag(e)}),t.getCurrentItem(function(e){h&&e.live===!0?D():!h&&e.live===!1&&_()});if(!a){t.refresh(function(t,n){if(t)return g(t);o.updateUiConfig({controls:{availableOnMediaEnded:!0}}),o.loadPlugin(e.getPluginLocations(),e.getConfig(n))}),a=!0;return}f&&(s.update(),d(n.getIndex()))},A=function(e){var t=e.origin;switch(t){case"replay":v();break;case"auto":case"cta":case"carousel":n.create(e.index,e)}},O=function(e){var t=e.id;switch(t){case"dismissContPlay":i.track(t,e),y();break;case"openMoreVideos":i.track(t);break;case"turnCPon":b(n.getIndex());break;case"turnCPoff":w()}},M=function(e){if(c)return;e.isFullscreen&&(c=!0,i.track("goneFullScreen"))},_=function(){h=!0,b(n.getIndex())},D=function(){h=!1,w()};return{init:E,initBump:S,refreshData:x,playItem:T,getPlayingInfo:N}}),define("module/ompContinuousPlay",["module/bootstrap","module/featureDetector","module/components/mediaPlayer/main","vendor/bbc-video-experience/continuousPlay/module"],function(e,t,n,r){var i=e.pubsub,s,o=!1,u=function(o,u){s=u||{};if(a(!0))return;if(!s.enabled)return;r.init(o,{staticPrefix:e.config.staticPrefix,adsEnabled:t.is("DisplayingGnlAds"),pluginPath:"/js/vendor/bbc-video-experience/continuousPlay/smp/",countdownDuration:5,updateBrowserUrl:{enabled:!0,updateHistory:!1},advertAssetType:s.advertAssetType,autoPlayFirstItem:s.autoPlayFirstItem,handlers:{enabled:function(e){i.emit("continuousPlay:videoPlayed",[e])},videoPlayed:function(e){i.emit("continuousPlay:videoPlayed",[e])},dismissed:function(){i.emit("continuousPlay:dismissed")},turnOn:function(e){i.emit("continuousPlay:turnOn",[e])},turnOff:function(){i.emit("continuousPlay:turnOff")}}}),n.subscribeToPlayerEvent("initialised",function(e,t){r.initBump(t)},!0)},a=function(e){return typeof orb.fig!="function"?e:orb.fig("mb")===undefined?e:orb.fig("mb")};return{init:u}}),define("module/mediaUtils/timeInterval",[],function(){function t(t){if(!e[t]){var n=t.match(/PT((\d+)H)?((\d+)M)?((\d+)S)?/);if(n===null)throw"Could not parse time interval: "+t;var r=n[2]!==undefined?parseInt(n[2],10):0,i=n[4]!==undefined?parseInt(n[4],10):0,s=n[6]!==undefined?parseInt(n[6],10):0;e[t]={h:r,m:i,s:s}}return e[t]}function n(e){return e.toString().replace(/^(\d)$/,"0$1")}function r(e){var r=t(e);return r.m+":"+n(r.s)}function i(e){var n=t(e);return n.h*3600+n.m*60+n.s}var e={};return{toTimestamp:r,toSeconds:i}}),define("module/mediaUtils/playlistObjectBuilder",["module/mediaUtils/timeInterval","module/featureDetector"],function(e,t){function i(e,t){var n=[];return s(t,e)&&n.push(r),n.push({vpid:e.externalId,live:e.live,kind:u(e)}),{embedRights:e.allowOffSiteEmbedding?"allowed":"blocked",guidance:e.guidance,holdingImageURL:e.image&&e.image.href?e.image.href:"",items:n,title:e.caption,simulcast:e.live}}function s(t,n){return o()&&u(n)!=="radioProgramme"&&t.editorAdFlag&&e.toSeconds(n.duration)>30}function o(){return t.is("DisplayingGnlAds")}function u(e){if(e.kind!==undefined)return e.kind;for(var t in e.id){var r=e.id[t],i=n[r];if(i!==undefined)return i}return""}var n={audios:"radioProgramme",videos:"programme"},r={kind:"advert",media:{kind:"video",type:"video/mp4"}};return{build:i}}),define("module/mediaAssetPage/continuousPlay/dataProvider",["module/bootstrap","module/mediaUtils/playlistObjectBuilder","module/mediaUtils/timeInterval"],function(e,t,n){var r=e.$,i,s,o=function(e){var t=e||{};s=t.endpoint},u=function(e){r.ajax({url:s,dataType:"jsonp",jsonpCallback:"cpItems",crossDomain:!0}).done(function(t){i=t;var n=r(".related-video-audio article").toArray();n.unshift(r(".media-asset").get(0));if(i.length!==n.length){e("Number of related videos do not match");return}e(null,n)}).fail(function(t){e(t.statusText)})},a=function(e,s){var o=s[e],u=r(o),a=i[e],f=a.media,l={};return e==="0"?(l.title=u.find(".story-body__h1").text(),l.date=u.find(".date--v1 strong").text(),l.uri=u.find(".story-body__h1").data("asset-uri")):(l.title=u.find(".cta").text(),l.date=u.find(".date--v1").data("datetime"),l.uri=u.data("uri")),l.imgUrl=f.image?f.image.href:null,l.duration=f.duration?n.toTimestamp(f.duration):null,l.playlist=t.build(a.media,a.advert),l},f=function(e){var t="/api/av/asset",n,r;if(!e||!e.split||e.indexOf("/")<0)return;return n=e.split?e.split("/"):[],r="/"+n.splice(1,1)+t+n.join("/"),r},l=function(e,t){var n=f(e);if(!n)return;r.ajax({url:n,dataType:"jsonp",jsonpCallback:"cpAsset",crossDomain:!0}).done(function(e){t(null,e)}).fail(function(e){t(e.statusText)})},c=function(e){return i[e].advert},h=function(e){return i[e]};return{init:o,findItems:u,parseItem:a,parseAdvertMeta:c,getMediaAsset:l,getMetaData:h}}),define("module/mediaAssetPage/continuousPlay/view",["module/bootstrap"],function(e){var t=e.$,n,r=function(){n=t(".related-video-audio article").toArray(),n.unshift(t(".media-asset").first())},i=function(e){var r=t(n[e]),i=t(n[e+1]),s=!0;l("next"),e<1&&(s=!1),s&&(l("selected"),e>0&&f(r,"selected","NOW PLAYING")),i.length>0&&f(i,"next","UP NEXT")},s=function(e){t("#media-asset-page-text").empty().append(e.removeClass("display-feature-phone-only")).show()},o=function(e){t(".share-wrapper").empty().append(e).show()},u=function(){t(".share-wrapper").hide()},a=function(e){var n=t("#media-asset-page-text h1");n.data("asset-uri","").text(e),t("#media-asset-page-text").empty().append(n)},f=function(e,n,r){e.addClass(n),t("."+n).find(".js-media-duration").text(r)},l=function(e){var n=t(".media-feed-item."+e);n.each(function(n,r){var i=t(r);i.removeClass(e),t(".js-media-duration",i).text(i.attr("data-duration"))})},c=function(){l("next")},h=function(){return t(".media-asset").first().find(".story-body__h1").data("asset-uri")};return{init:r,updateTags:i,updatePageContent:s,updateShareTools:o,removeNextTag:c,hideShareTools:u,hidePageContent:a,getMediaAssetUri:h}}),define("module/mediaAssetPage/continuousPlay/ompHandler",["module/bootstrap","module/ompContinuousPlay","module/mediaAssetPage/continuousPlay/dataProvider","module/mediaAssetPage/continuousPlay/view"],function(e,t,n,r){var i,s=function(e){i=e||{},i.advertAssetType="media_cplay",a(),n.init(i.dataProvider),r.init(),t.init(n,i)},o=function(e){var t=n.getMetaData(e)||{},i=r.getMediaAssetUri();r.updateTags(e),t.advert&&t.advert.uri!==i&&n.getMediaAsset(t.advert.uri,function(e,n){var i=t.advert.shortHeadline!==undefined?t.advert.shortHeadline:"";e?(r.hidePageContent(i),r.hideShareTools()):(n.body?r.updatePageContent($(n.body)):r.hidePageContent(i),n.shareTools?r.updateShareTools($(n.shareTools)):r.hideShareTools())})},u=function(){r.removeNextTag()},a=function(){e.pubsub.on("continuousPlay:videoPlayed",function(e){o(e)}),e.pubsub.on("continuousPlay:dismissed",function(){u()}),e.pubsub.on("continuousPlay:turnOff",function(){r.removeNextTag()}),e.pubsub.on("continuousPlay:turnOn",function(e){r.updateTags(e)})};return{init:s}}),define("module/components/ompMediaAssetPage",["module/assortedUtils","module/bootstrap","module/transclude","module/components/ompMediaAssetPageView","module/mediaAssetPage/listView","module/mediaAssetPage/api","module/mediaAssetPage/map","module/mediaAssetPage/continuousPlay/ompHandler","module/components/mediaPlayer/autoPlay","module/components/mediaPlayer/view"],function(e,t,n,r,i,s,o,u,a,f){function h(){var e=document.getElementById("page");if(e)return e.getAttribute("data-map-id")}function p(){var e,t=f.getPlayableForPlaceholder(f.findFirstMediaPlaceholder());return e=t.otherSettings.continuousPlayCfg,e.autoPlayFirstItem=a.isEnabled(t),e}var l=new s,c=e.jsonParse,d=function(){r.init();var e=h(),s=p();u.init(s),i.init(e),o.init();if(!t.config.features2.map_most_watched)t.pubsub.emit("map:feed:request:error",["most-watched"]);else{var a=new n;a.get(".media-tab.most-watched a",{target:".most-watched .media-feed-placeholder",success:function(){t.pubsub.emit("map:feed:request:success",["most-watched"])},error:function(){t.pubsub.emit("map:feed:request:error",["most-watched"])},insert:!0})}};d()}),define("module/components/recommendations/ui",["module/bootstrap","module/strategiser"],function(e,t){function r(e,t){var n=[2,3];n.indexOf(e)>=0?t.attr("role","complementary"):t.removeAttr("role")}var n={};return n.init=function(e){n.componentSelector=e;var i=n.getComponent();n.doesArticleContinueBelowRecommendations()||i.addClass("article-does-not-continue-below"),t.subscribeToStrategyChange(function(e,t){r(t,n.getComponent())}),r(n.getStrategy(),i)},n.getComponent=function(){return e.$(n.componentSelector)},n.getStrategy=function(){return t.determineStrategy()},n.getNumberOfRecommendations=function(){return n.getComponent().find(".penguin__item").length},n.doesArticleContinueBelowRecommendations=function(){var e=n.getComponent();return e.parent().next().length>0},n.getRecommendationLinks=function(){return n.getComponent().find("[data-entityid] a")},n.getLinkIstatsLabels=function(t){var n=e.$(t).closest("[data-istats-labels]");if(n.length===0)return!1;var r=n.data("istatsLabels"),i=n.data("entityid");return r.linkLocation=i,r},n}),define("module/components/recommendations",["module/bootstrap","module/components/recommendations/ui","istats-1"],function(e,t,n){function s(e){return e.replace("#","-")}function o(e){var t=e.lastIndexOf("#");return parseInt(e.substr(t+1),10)}var r={},i=e.config.asset||{};return r.init=function(e){t.init(e);var n=t.getComponent(),i=r.getMetaIstats(),s=n.data("pagetype");r.reportComponentStatus(i),r.registerIstatsClickHandling(i,s)},r.getMetaIstats=function(){var n=e.$(t.getComponent()).data("istats");return n.content_count=t.getNumberOfRecommendations(),n.breakpoint_type=t.getStrategy(),n},r.reportComponentStatus=function(t){var n="news:recommendation:"+t.action_type;e.pubsub.emit(n,t)},r.setupIstatsLinkTrack=function(e,t){var r=t.link_location;t.link_location=null,e.linktrack=t,n.track("internal",{region:e,linkLocation:r})},r.registerIstatsClickHandling=function(e,n){t.getRecommendationLinks().each(function(){var i=t.getLinkIstatsLabels(this);if(!i)return;var s=r.buildClickLabels(i,e,n);r.setupIstatsLinkTrack(this,s)})},r.buildClickLabels=function(e,t,n){var r=o(e.linkLocation),u=s(e.linkLocation);return{prev_app_name:"news",prev_page_type:n,link_location:u,prev_content_name:t.content_name,prev_content_count:t.content_count,prev_content_position:r,prev_cps_asset_id:i.asset_id,prev_rec_source:t.rec_source,prev_rec_set:t.rec_set,prev_rec_urn:e.urn,prev_rec_alg:e.alg,prev_rec_position:e.position,prev_rec_key:e.key}},r}),define("module/components/remotePortlet",["module/bootstrap","module/components/handler"],function(e,t){return{runDependent:function(e){if(e.opts.js==="on"){var t=e.opts.js_dependency?e.opts.js_dependency:e.opts.id;require(["module/components/"+t],function(t){t.init(e)})}},handleSuccess:function(e,n){n!==undefined&&t.handleSuccess(e,n),this.runDependent(e)}}}),define("module/components/responsiveSurveyBanner",["module/bootstrap","module/cookieUtils","module/bannerUtils"],function(e,t,n){function o(){r("#responsive-survey__take-me-there").on("click",function(e){e.preventDefault(),e.stopPropagation(),window.open(this.href,"_blank"),s.setSurveyTakenCookie(),u()}),r("#responsive-survey__go-back").on("click",function(e){e.preventDefault(),s.optOut(),u()}),r("#responsive-survey__dismiss").on("click",function(e){s.removeFixedModifierFromBanner(),s.setBannerDismissedCookie(),s.removeOrbFooterPadding()})}function u(){r("#news-banner").hide()}var r=e.$,i,s;return{handleSuccess:function(e){s=new n({cookieName:"ckps_responsive_survey",cookieExpiryInDays:90,optInValue:"i",optOutValue:"o",surveyTakenValue:"s",dismissedValue:"d"}),!s.isOptedOut()&&!s.isSurveyTaken()&&(s.displayBanner(),o())}}}),define("module/components/rollingNews",["module/bootstrap","module/imageenhancer","config"],function(e,t,n){var r=e.$,i,s,o=!1;return{request:function(){r.ajax({url:"/"+n.service+"/api/"+s+".json?limit="+i.find(".rolling-news__story").length,type:"GET",success:function(t){o=!0,e.pubsub.emit("rollingNews:augment",[t]),i.find(".rolling-news__story--loading").each(function(){e.pubsub.emit("rollingNews:openAccordion",[r(this)])})},error:function(t){e.pubsub.emit("rollingNews:error",[t])},timeout:3e4})},augment:function(e){var n,s;i.find(".rolling-news__story a").each(function(){n=r(this),s=e[n.attr("href").trim()],s&&n.parent().find(".rolling-news__story__body__content").append(s)}),new t(".rolling-news img")},toggleAccordion:function(t){t.hasClass("rolling-news__story--open")||t.hasClass("rolling-news__story--loading")?e.pubsub.emit("rollingNews:closeAccordion",[t]):(i.find(".rolling-news__story--open, .rolling-news__story--loading").each(function(){e.pubsub.emit("rollingNews:closeAccordion",[r(this)])}),e.pubsub.emit("rollingNews:openAccordion",[t]))},openAccordion:function(e){o&&e.hasClass("rolling-news__story--loading")&&e.removeClass("rolling-news__story--loading"),e.addClass(o?"rolling-news__story--open":"rolling-news__story--loading")},closeAccordion:function(e){e.removeClass(o?"rolling-news__story--open":"rolling-news__story--loading")},init:function(){i=r(".rolling-news__body"),s=r(".rolling-news").attr("data-asset-id"),e.pubsub.on("rollingNews:request",this.request,this),e.pubsub.on("rollingNews:augment",this.augment,this),e.pubsub.on("rollingNews:toggleAccordion",this.toggleAccordion,this),e.pubsub.on("rollingNews:openAccordion",this.openAccordion,this),e.pubsub.on("rollingNews:closeAccordion",this.closeAccordion,this),i.on("click",".rolling-news__story > a",function(t){t.preventDefault(),t.stopPropagation(),e.pubsub.emit("rollingNews:toggleAccordion",[r(this).parent()])}),e.pubsub.emit("rollingNews:request")}}}),define("module/components/rollingNewsAdapter",["module/components/rollingNews"],function(e){$(".rolling-news").length&&e.init()}),define("module/components/shareToolsAdapter",["module/components/shareTools"],function(e){e.handleSuccess({selector:"#sharetools-lightweight, .js-share-tools"})}),define("module/components/shoebill/view",["module/bootstrap"],function(e){var t=e.$,n=function(e){e=e||{},this.containerClass=e.containerClass||"shoebill",this.itemsCount=e.itemsCount||4,this.interval=e.interval||4e3,this.intervalId=null,this.currentIndex=0,this.itemSelectedClass="shoebill-item--selected",this.imageHiddenClass="shoebill-image--hidden",this.footerHiddenClass="shoebill-footer--hidden",this.animatedClass="shoebill--animated",this.$container=t("."+this.containerClass),this.$leadItem=this.$container.find(".shoebill-lead-item"),this.$leadImageContainer=this.$container.find(".shoebill-lead-item__image"),this.$itemContainer=this.$container.find(".shoebill-item-container"),this.$items=this.$container.find(".shoebill-item"),this.$footer=this.$container.find(".shoebill-footer"),this.$startButton=this.$container.find(".shoebill-footer__button.start-button"),this.$stopButton=this.$container.find(".shoebill-footer__button.stop-button"),this.init()};return n.prototype.init=function(){this.bindEvents(),this.prepareImages(),this.replaceUrls(),this.showFooter(),this.isLeadItemVisible()&&(this.selectItem(this.currentIndex),e.window.setTimeout(t.proxy(this.startTransition,this),2e3))},n.prototype.bindEvents=function(){this.$leadItem.on("mouseenter",t.proxy(this.onLeadItemMouseEnter,this)),this.$leadItem.on("click",t.proxy(this.onLeadItemClick,this)),this.$itemContainer.on("mouseenter",t.proxy(this.onItemContainerMouseEnter,this)),this.$itemContainer.on("mouseleave",t.proxy(this.onItemContainerMouseLeave,this)),this.$items.on("mouseenter",t.proxy(this.onItemMouseEnter,this)),this.$startButton.on("click",t.proxy(this.onStartButtonClick,this)),this.$stopButton.on("click",t.proxy(this.onStopButtonClick,this))},n.prototype.onItemContainerMouseEnter=function(e){this.isAnimated()&&this.stopTransition(),this.$items.removeClass(this.itemSelectedClass)},n.prototype.onItemContainerMouseLeave=function(e){this.$items.eq(this.currentIndex).addClass(this.itemSelectedClass)},n.prototype.onItemMouseEnter=function(e){this.currentIndex=t(e.currentTarget).index(),this.showImage(this.currentIndex)},n.prototype.onLeadItemMouseEnter=function(e){this.stopTransition()},n.prototype.onLeadItemClick=function(e){var t=this.$items.eq(this.currentIndex),n=t.find(".title-link").attr("href");this.updateLocationUrl(n)},n.prototype.onStartButtonClick=function(e){this.selectNextItem(),this.startTransition()},n.prototype.onStopButtonClick=function(e){this.stopTransition()},n.prototype.isLeadItemVisible=function(){return this.$leadItem.css("display")==="block"},n.prototype.prepareImages=function(){var e=this.$leadImageContainer.find(".shoebill-image"),n=this.$container.find(".shoebill-item .responsive-image");if(!e.length)for(var r=0;r<n.length;r++){var i=t("<div></div>").attr("class","shoebill-image "+this.imageHiddenClass).attr("id","shoebill-image-"+r).append(t(n[r]).clone());this.$leadImageContainer.append(i)}},n.prototype.hidePlaceholderImage=function(){this.$leadImageContainer.children(".responsive-image:first").hide()},n.prototype.replaceUrls=function(){var e=this.$container.find(".group-title__link");e.length&&(this.$items.each(function(n){var r=e.attr("href")+"/"+t(this).data("asset-id");t(this).find("a").attr("href",r)}),this.$footer.find("a").attr("href",e.attr("href")))},n.prototype.updateLocationUrl=function(t){t&&(e.window.location.href=t)},n.prototype.showFooter=function(){this.$footer.removeClass(this.footerHiddenClass)},n.prototype.showImage=function(e){var n=t("#shoebill-image-"+e);n.length&&(this.$leadImageContainer.find(".shoebill-image").addClass(this.imageHiddenClass),n.removeClass(this.imageHiddenClass))},n.prototype.selectItem=function(e){this.currentIndex=e,this.showImage(e),this.$items.removeClass(this.itemSelectedClass),this.$items.eq(e).addClass(this.itemSelectedClass)},n.prototype.selectNextItem=function(){var e=this.currentIndex<this.itemsCount-1?this.currentIndex+1:0;this.selectItem(e)},n.prototype.startTransition=function(){this.stopTransition(),this.hidePlaceholderImage();var n=t.proxy(function(){this.selectNextItem(),this.currentIndex===0&&this.stopTransition()},this);this.intervalId=e.window.setInterval(n,this.interval),this.$container.addClass(this.animatedClass),this.showStopButton()},n.prototype.stopTransition=function(){e.window.clearInterval(this.intervalId),this.intervalId=null,this.$container.removeClass(this.animatedClass),this.showStartButton()},n.prototype.showStartButton=function(){this.$startButton.removeClass("start-button--hidden"),this.$stopButton.addClass("stop-button--hidden")},n.prototype.showStopButton=function(){this.$stopButton.removeClass("stop-button--hidden"),this.$startButton.addClass("start-button--hidden")},n.prototype.isAnimated=function(){return this.intervalId!==null},n}),define("module/components/shoebill/main",["module/bootstrap","module/components/shoebill/view"],function(e,t){var n=function(){var e=$(".container-shoebill").length>0?"container-shoebill.wide-only":"shoebill";this.view=new t({containerClass:e}),this.registerEventHandlers()};return n.prototype.registerEventHandlers=function(){e.pubsub.on("deviceGroup",$.proxy(this.handleResize,this))},n.prototype.handleResize=function(e){e==="group4"?this.view.isAnimated()||this.view.startTransition():this.view.stopTransition()},n}),define("module/components/shoebillAdapter",["module/components/shoebill/main"],function(e){new e}),define("module/components/siteCatalystAdapter",["vendor/analytics/siteCatalyst"],function(e){new e}),define("module/components/spoonbill/view",["module/bootstrap"],function(e){var t=e.$,n=function(e){this.currentIndex=0,this.itemSelectedClass="spoonbill-item--selected",this.$container=e,this.$itemContainer=this.$container.find(".spoonbill-item-container"),this.$items=this.$container.find(".spoonbill-item"),this.$footer=this.$container.find(".spoonbill-footer"),this.init()};return n.prototype.init=function(){this.bindEvents(),this.selectItem(this.currentIndex),this.replaceUrls()},n.prototype.bindEvents=function(){this.$itemContainer.on("mouseenter",t.proxy(this.onItemContainerMouseEnter,this)),this.$itemContainer.on("mouseleave",t.proxy(this.onItemContainerMouseLeave,this)),this.$items.on("mouseenter",t.proxy(this.onItemMouseEnter,this))},n.prototype.onItemContainerMouseEnter=function(e){this.$items.removeClass(this.itemSelectedClass)},n.prototype.onItemContainerMouseLeave=function(e){this.$items.eq(this.currentIndex).addClass(this.itemSelectedClass)},n.prototype.onItemMouseEnter=function(e){this.currentIndex=t(e.currentTarget).index()},n.prototype.replaceUrls=function(){var e=this.$container.find(".group-title__link");e.length&&this.$footer.find("a").attr("href",e.attr("href"))},n.prototype.selectItem=function(e){this.$items.removeClass(this.itemSelectedClass),this.$items.eq(e).addClass(this.itemSelectedClass),this.currentIndex=e},n}),define("module/components/spoonbill/main",["module/bootstrap","module/components/spoonbill/view"],function(e,t){var n=e.$,r=function(){var e=[".container-spoonbill.wide-only",".container-spoonbill.compact-tablet-only"];n.each(e,function(e,r){n(r).length>0&&new t(n(r))}),n(".style-guide").length>0&&new t(n(".spoonbill"))};return r}),define("module/components/spoonbillAdapter",["module/components/spoonbill/main"],function(e){new e}),define("module/components/sport",["module/bootstrap","module/components/hardNewsUnit","translator"],function(e,t,n){var r=e.$;return{handleSuccess:function(e,n){this.selector=r(e.selector),this.teams=this.selector.find("#sport-teams").removeClass("hidden").hide(),this.sportStories=this.selector.find("#latest-sport-stories"),t.init(e.selector),this.sportStories.length&&this.teams.length&&this.renderTabs(),this.sportStories.length===0&&this.teams.length&&this.teams.show()},renderTabs:function(){this.selector.find("#latest-sport-stories").before(r('<ul class="tabs-list js-tabs-list" role="tablist">                <li id="tab-1" class="open" role="presentation"><a href="#latest-sport-stories"                    role="tab" tabindex="0">Latest stories<span class="off-screen"> selected</span>                    </a></li>                <li id="tab-2" role="presentation"><a href="#sport-teams"                     role="tab" tabindex="-1">Local teams</a></li></ul>')),this.selector.addClass("has-tabs"),this.tabs=this.selector.find(".js-tabs-list li"),this.tabs.find("a").on("click",r.proxy(this.toggleTabs,this)),this.tabs.find("a").on("keydown",r.proxy(this.handleKeypress,this))},toggleTabs:function(e){this.selector.find(".js-tab-content").attr("aria-hidden","true").hide(),this.tabs.removeClass("open"),this.tabs.find("a").attr("tabindex","-1");var t=r("#"+e.target.href.split("#")[1]),n=r(e.target),i=n.parent();return this.tabs.find("span.off-screen").appendTo(n),i.addClass("open"),n.attr("tabindex","0"),t.attr("aria-hidden","false").show(),!1},handleKeypress:function(e){var t=r(e.target).parent(),n=t.next().find("a"),i=t.prev().find("a"),s=t.parent().find("a").first(),o=t.parent().find("a").last(),u;e.which&&(e.which===39?u=n.length?n:s:e.which===37&&(u=i.length?i:o)),u&&(u.trigger("click"),u[0].focus())}}}),define("module/sport/sportView",["module/bootstrap","module/deviceInspector","translator"],function(e,t,n){var r=e.$,i=function(){},s=4,o=r("#latest-sport-stories .sport-stories__more-button"),u,a=n.get("showMore"),f=n.get("showLess"),l=n.get("latestSportStories");return i.prototype={init:function(e,n){u=n||t.init(),this.selectorContainer=e instanceof r?e:r(e),this.headlineContainer=this.selectorContainer.find(".sport-stories__headline-stories");if(this.selectorContainer.length===0)return;if(!/group(1|2)/i.test(u.getGroup()))return;this.setUpStories(),this.button&&this.bindEvents()},setUpStories:function(){var e=this.selectorContainer.find(".sport-stories__headline-story");if(e.length>s&&/group(1|2)/i.test(u.getGroup())){var t=e.slice(s);t.addClass("sport-stories__headline-story--toggle"),this.headlineContainer.addClass("sport-stories__headline-stories--hide"),this.appendButton()}},bindEvents:function(){r(window).on("resize",r.proxy(this.handleResize,this))},appendButton:function(){this.selectorContainer.find("#latest-sport-stories").append('<button class="sport-stories__more-button">'+a+'<span class="off-screen"> '+l+"</span></button>"),this.button=r(".sport-stories__more-button"),this.button.on("click",r.proxy(this.handleButtonEvent,this))},handleButtonEvent:function(){this.toggleStories(),this.toggleButtonState()},toggleButtonState:function(){var e=this.button[0].childNodes[0];e.nodeValue===a?(e.nodeValue=f,this.selectorContainer.find("a.sport-stories__headline-story--toggle")[0].focus()):(e.nodeValue=a,this.button[0].focus())},toggleStories:function(){this.headlineContainer.toggleClass("sport-stories__headline-stories--hide")},handleResize:function(e){/group3|4/i.test(u.getGroup())?(this.headlineContainer.hasClass("sport-stories__headline-stories--hide")&&(this.toggleStories(),this.button[0].textContent===f+" "+l&&this.toggleButtonState()),this.button.css("display","none")):(r("#latest-sport-stories .sport-stories__more-button").length===0&&this.setUpStories(),this.headlineContainer.addClass("sport-stories__headline-stories--hide"),this.button.css("display","block"))}},i}),define("module/components/sportAdapter",["module/bootstrap","module/components/sport","module/sport/sportView"],function(e,t,n){if(e.$("#comp-sport-stories").length>0){var r=new n;t.handleSuccess(e.$("#comp-sport-stories")),r.init(e.$("#comp-sport-stories"))}}),define("module/components/storiesGroup",["module/components/hardNewsUnit"],function(e){var t=!1;return{handleSuccess:function(n){t||(e.init(".stories-group"),t=!0)}}}),define("module/components/swift/view",["module/bootstrap","module/polyfill/bind"],function(e){var t=function(t){this.element=t,this.$contentContainer=e.$(this.element).find(".js-polling-content-container"),this.events=e.$({}),this.$contentContainer.on("transitionend webkitTransitionEnd",function(e){if(!e.originalEvent||e.originalEvent.propertyName==="opacity")return;this.events.trigger("first-animation-end")}.bind(this)),this.events.on("first-animation-end",function(){this.$contentContainer.html(this.newItemNodes),this.$contentContainer.removeClass("swift-body--start-animation")}.bind(this))};return t.prototype.getSelector=function(){return".swift"},t.prototype.getPollingUrl=function(){if(this.element)return this.element.getAttribute("data-polling-url")},t.prototype.startAnimationAndInsertHtml=function(e){this.$contentContainer.addClass("swift-body--start-animation");var t=document.createElement("div");t.innerHTML=e,this.newItemNodes=t.childNodes},t.prototype.afterEntryIsInsertedAndSecondAnimationStarts=function(e){this.events.on("first-animation-end",e)},t}),define("module/components/swift/main",["module/bootstrap","module/poller","module/components/swift/view","module/alternativeJsStrategy/processJsDependencies","module/polyfill/bind"],function(e,t,n,r){var i=1,s=function(e){this.view=new n(e);var r=this.view.getPollingUrl();if(!r)return;this.pollerInstance=new t(3e4),this.pollerInstance.setUrl(r),this.pollerInstance.startPolling({callbackName:"swift"+i++,success:this.processSuccessfulResponse.bind(this)}),this.view.afterEntryIsInsertedAndSecondAnimationStarts(function(){require(["module/components/timestampAdaptor"],function(e){e.reProcess(this.view.getSelector())}.bind(this))}.bind(this))};return s.prototype.processSuccessfulResponse=function(e){if(!e.entryId||e.entryId===this.currentEntryId||e.html.trim().length===0)return;this.currentEntryId=e.entryId,this.view.startAnimationAndInsertHtml(e.html)},s.prototype.stopPolling=function(){this.pollerInstance.stopPolling()},s}),define("module/components/swift/collection",["module/components/swift/main","module/bootstrap"],function(e,t){var n=function(e,n){e=e||t.window.document,n=n||function(){};var r=e.getElementsByClassName("swift"),i,s=r.length;for(i=0;i<s;i++)n(r[i])},r=function(e){n(e,function(e){e.swiftPoller.stopPolling()})},i=function(t){n(t,function(t){if(t.swiftPoller)return;t.swiftPoller=new e(t)})};return{init:i,cleanup:r}}),define("module/components/swiftAdapter",["module/components/swift/collection"],function(e){e.init()}),define("module/components/topStories",["module/bootstrap","module/components/liveEventPromo","module/components/hardNewsUnit","module/components/localLive"],function(e,t,n,r){return{handleSuccess:function(i){var s=e.$(i.selector);n.init(i.selector),s.hasClass("js-has-live-event-promo")&&t.handleSuccess(),s.hasClass("js-has-local-live-promo")&&r.handleSuccess("#comp-local-live")}}}),define("module/components/topStoriesAdapter",["module/components/topStories"],function(e){e.handleSuccess({selector:"#top-stories"})}),define("module/components/topicalStories",["module/components/hardNewsUnit"],function(e){return{handleSuccess:function(t){e.init(t.selector)}}}),define("module/components/travelComponentAdapter",["module/bootstrap","module/timestamp"],function(e,t){var n=e.$(".js-travel-replace");n.each(function(n,r){var i=e.$(r),s=i.data("region"),o=parseInt(i.data("show-component"),10);if(o&&s){var u=e.$.get(i.data("request-uri")+s);u.done(function(e){i.html(e.html),new t((new Date).getTime())})}})}),define("module/components/twite/analytics",[],function(){var e=!1,t={clicked:"twite:shareTools:clicked"},n=function(){try{e=window.bbcdotcom&&bbcdotcom.config.isAnalyticsEnabled()}catch(t){}},r=function(n,r){if(!e)return;if(!t[n])throw'Event name "'+n+'" not defined';var i=t[n],s=r||{};try{bbcdotcom.trackEvent(i,s)}catch(o){}};return{init:n,track:r}}),define("module/components/twite/view",["module/bootstrap","vendor/lo-dash/lo-dash"],function(e,t){var n={shareButton:".twite__share-button",closeButton:".twite__close-button",panel:".twite__panel",channelLink:".twite__channel-link",shareLink:".twite__share-link"},r=e.$,i,s="resize.twite",o=function(){u(),i=r("#page")},u=function(){r(n.shareButton).on("click",a),r(n.channelLink).on("click",c),r(n.panel).on("click",h),r(n.closeButton).on("click",l),r(n.shareLink).on("click",p),r("html").on("click",d)},a=function(e){e.preventDefault(),e.stopPropagation();var t=r(this).next();t.css("visibility")==="visible"?b(t):(w(),E(t),v(t)),f()},f=function(){r(n.shareButton).each(function(){var e=r(this).next();r(this).attr("aria-expanded",e.css("visibility")==="visible")})},l=function(e){e.preventDefault(),e.stopPropagation(),b(r(this).parent()),f()},c=function(t){t.stopPropagation();var i=r(this).closest(n.panel).prev(),s=r(this).find("p").text().toLowerCase(),o=i.data("origin");e.pubsub.emit("shareTools:channel:clicked",[s,o]),w(),i[0].focus()},h=function(e){e.stopPropagation()},p=function(e){e.preventDefault(),e.stopPropagation(),M(r(this))},d=function(e){w()},v=function(e,t){e.addClass("show"),i.length&&g(T(e)-S()),m()},m=function(){r(window).on(s,t.debounce(function(){var e=r(n.panel+".show");i.length&&g(T(e)-S())},150))},g=function(e){if(!i.length)return;i.css("min-height",e)},y=function(){g(0),r(window).off(s)},b=function(e){e.removeClass("show arrow-top arrow-bottom"),e.prev()[0].focus(),y()},w=function(){r(n.panel).removeClass("show arrow-top arrow-bottom"),y()},E=function(e){e.css("top","auto");var t="arrow-top";!k(e)&&!C(e)&&(t="arrow-bottom",e.css("top",-(N(e)+31))),e.addClass(t)},S=function(){return parseInt(i.offset().top,10)-20},x=function(e){return parseInt(e.offset().top,10)},T=function(e){return x(e)+N(e)},N=function(e){return parseInt(e.css("height"),10)},C=function(e){var t=e.prev().get(0),n=t.getBoundingClientRect(),i=r(window).height()-150;return n.top>=0&&n.top<=i},k=function(e){return e.data("origin")==="player"},L=function(e,t){A(e,t),O(e,t)},A=function(e,t){var i=e.find(n.channelLink);i.each(function(e){var i=t.find(n.channelLink).eq(e);r(this).attr("href")!==i.attr("href")&&i.attr("href",r(this).attr("href"))})},O=function(e,t){var r=e.find(n.panel).data("share-uri"),i=window.location.protocol+"//"+window.location.hostname+r;t.find(n.shareLink).attr("href",i).text(i)},M=function(e){document.execCommand("selectAll",!1,e.get(0))};return{init:o,hidePanels:w,copyLinks:L,selectShareLink:M}}),define("module/components/twite/handler",["module/bootstrap","module/components/twite/view","module/components/twite/analytics"],function(e,t,n){var r=e.$,i=function(){t.init(),n.init(),s()},s=function(){e.pubsub.on("shareTools:channel:clicked",o),e.pubsub.on("shareTools:links:update",u),e.pubsub.on("shareTools:panels:close",a)},o=function(e,t){n.track("clicked",{platform:e,origin:t})},u=function(e,n){t.copyLinks(e,n)},a=function(){t.hidePanels()};return{init:i}}),define("module/components/twiteAdapter",["module/components/twite/handler"],function(e){e.init()}),define("module/components/videoPlayer",["module/media/mediaHandler"],function(e){var t=new e;t.createMedia()}),define("module/local/local",["module/bootstrap"],function(e){var t=function(t){this.options=t||{},this.options.simple=this.options.simple||!1,this.options.story_limit=this.options.story_limit||2,this.options.append_ext=this.options.append_ext||undefined,e.pubsub.on("locator:locationChanged",e.$.proxy(this.updateLocalNews,this))};return t.prototype.updateLocalNews=function(t){t&&t.news&&t.news.id&&t.news.path?(e.pubsub.emit("local:requestStarted"),e.$.ajax({url:e.config.pathPrefix+"/local/"+t.news.path+(this.options.append_ext!==undefined?this.options.append_ext:"")+"?limit="+this.options.story_limit+"&simple="+this.options.simple,dataType:"html",type:"get",success:function(n){e.pubsub.emit("local:newsReceived",[n,t.news.path])},error:function(t){e.pubsub.emit("local:requestError","requestError")}})):e.pubsub.emit("local:locationInvalid","locationInvalid")},t}),define("module/local/localView",["module/bootstrap","module/timestamp","module/imageenhancer","module/components/hardNewsUnit","config","translator"],function(e,t,n,r,i,s){var o=function(t,n){this.container=e.$(t,n);if(!this.container.length)return;this.moduleTitle=e.$(".local-weather__title",n),this.hideLocal(),e.pubsub.on("local:requestStarted",e.$.proxy(this.handleLoading,this)),e.pubsub.on("local:newsReceived",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("local:requestError",e.$.proxy(this.handleError,this))};return o.prototype={handleLoading:function(){e.pubsub.emit("local:handleLoaded",this.container),this.setContent(null,"loading")},handleSuccess:function(t,n){this.showLocal(),this.setContent(t),e.pubsub.emit("local:newsRendered",this.container),n&&this.setTitle(n)},handleError:function(){this.setContent(s.get("localNewsCouldNotBeLoaded"),"error")},setTitle:function(t){var n,r=e.$("#local-stories",this.container);r&&r.attr("data-title")&&(n='<a href="{{link}}" class="local-weather__link right-arrow">{{title}}</a>'.replace("{{link}}","/news/"+t).replace("{{title}}",r.attr("data-title")),this.moduleTitle.html(n))},setContent:function(e,i){i&&(e='<div class="'+i+'">'+(e||"")+"</div>"),this.container.html(e);var s=new n,o=new t((new Date((new Date).toUTCString())).getTime());r.init("#local-stories")},hideLocal:function(){this.container.addClass("hidden")},showLocal:function(){this.container.removeClass("hidden")}},o}),define("module/weather/weather",["module/bootstrap"],function(e){var t=function(t){this.options=t||{},this.options.type=this.options.type||"hourly",this.options.append_ext=this.options.append_ext||undefined,e.pubsub.on("weather:locationChanged",e.$.proxy(this.updateWeather,this))};return t.prototype.updateWeather=function(t){t&&t.id&&(this.url=e.config.pathPrefix+"/weather/"+t.id.toString().toLowerCase()+"/"+this.options.type,e.pubsub.emit("weather:requestStarted"),e.$.ajax({url:this.url+(this.options.append_ext!==undefined?this.options.append_ext:""),type:"get",dataType:"html",success:function(n){e.pubsub.emit("weather:success",[n,t])},error:function(t){e.pubsub.emit("weather:requestError",[t])}}))},t}),define("module/weather/weatherView",["module/bootstrap"],function(e){var t=function(t){this.container=e.$(t);if(!this.container.length)return;this.weatherLinkHref=this.container.attr("href"),this.hideWeather(),e.pubsub.on("weather:success",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("weather:requestError",e.$.proxy(this.handleError,this))};return t.prototype={setContent:function(e){this.container.html(e)},setLink:function(e){return e=e?e:"",this.weatherLinkHref+"/"+e.toString().toLowerCase()},setLocationName:function(t){if(t!==undefined){var n=e.$(".weather-location");n.length&&n.html('<h3 class="weather-location__current"><a href="'+this.setLink(this.location.id)+'" class="weather-location__current-link right-arrow">'+t+" weather</a></h3>")}},handleSuccess:function(e,t){this.setContent(e),this.location=t,this.container.attr("href",this.setLink(this.location.id)),this.showWeather(),this.setLocationName(this.location.name),this.highlightDropdownButton()},handleError:function(){this.hideWeather()},showWeather:function(){this.container.removeClass("hidden")},hideWeather:function(){this.container.addClass("hidden")},highlightDropdownButton:function(){e.$(".weather-location__show-locations").on("mouseenter",function(){e.$(".weather-location__current").addClass("hover")}).on("mouseleave",function(){e.$(".weather-location__current").removeClass("hover")}).on("keyup",function(t){var n=t.keyCode||t.which;n===9&&e.$(".weather-location__current").addClass("hover")}).on("blur",function(){e.$(".weather-location__current").removeClass("hover")})}},t}),define("module/weather/weatherLocation",["module/bootstrap"],function(e){var t=function(){this.retrieveWeatherItems()};return t.prototype={retrieveWeatherItems:function(){e.pubsub.emit("weatherLocation:requestStarted");var t=window.location.pathname,n=e.config.pathPrefix+"/weather/regions"+t.toLowerCase();e.$.ajax({url:n,type:"get",dataType:"html",success:function(t){e.pubsub.emit("weatherLocation:success",[t])},error:function(t){e.pubsub.emit("weatherLocation:requestError",[t])}})}},t}),define("module/weather/weatherLocationView",["module/bootstrap","deviceInspector"],function(e,t){var n=function(t){this.container=e.$(t),this.weatherModule=e.$(".weather-forecast");if(!this.container.length)return;this.hideWeatherLocation(),e.pubsub.on("weatherLocation:success",e.$.proxy(this.handleSuccess,this)),e.pubsub.on("weatherLocation:requestError",e.$.proxy(this.handleError,this))};return n.prototype={insertWeatherLocationDropdown:function(t){this.container.append(t),e.$(".weather-location__list li:first-child",this.container).length&&this.assignEventListeners();var n=e.$(".weather-location__current",this.container).attr("data-weather");e.pubsub.emit("weather:locationChanged",[{id:n}])},assignEventListeners:function(){this.locations=e.$(this.container),this.list=e.$(".weather-location__list",this.container),this.listItems=e.$("li",this.container),this.button=e.$(".weather-location__show-locations",this.container);var n=this;n.button[0].addEventListener("click",function(){n.list.hasClass("hidden")?n.button.text("Hide locations"):n.button.text("Show locations"),n.button.toggleClass("weather-location__show-locations--open"),n.list.toggleClass("hidden")},!0);var r=function(r){var i=r||window.event;if(r.type!=="keypress"||r.type==="keypress"&&i.keyCode===13){var s=i.target||i.srcElement,o=e.$(s),u={},a=document.getElementById("comp-weather");n.clicked=o.text(),n.listItems.removeClass("hidden"),o.addClass("hidden"),e.$(".weather-location__current",this.locations).text(n.clicked),n.button.removeClass("weather-location__show-locations--open"),n.list.addClass("hidden"),u.id=r.target.getAttribute("data-weather"),e.pubsub.emit("weather:locationChanged",[u]),!n.elementInView(n.button)&&t.getType()!=="desktop"&&a.scrollIntoView()}};e.$("li",n.list).each(function(){this.addEventListener("click",function(e){r(e)},!0)}),n.list[0].addEventListener("keypress",function(e){r(e)},!0)},elementInView:function(t){return t.offset().top>e.$(window).scrollTop()},handleSuccess:function(e){this.insertWeatherLocationDropdown(e),this.showWeatherLocation()},handleError:function(){this.hideWeatherLocation()},showWeatherLocation:function(){this.container.removeClass("hidden")},hideWeatherLocation:function(){this.container.addClass("hidden")}},n});try{define("module/localnewsandweather",["module/bootstrap","module/locatorFacade","module/local/local","module/local/localView","module/weather/weather","module/weather/weatherView","config","translator","module/weather/weatherLocation","module/weather/weatherLocationView"],function(e,t,n,r,i,s,o,u,a,f){var l={LOCATOR:".locator",WEATHER:".weather-forecast",LOCAL:".locator-stories-placeholder"},c={init:function(t){this.moduleElement=e.$(t);if(!this.moduleElement.length)return;this.moduleTitle=e.$(".local-weather__title",this.moduleElement),this.locatorElement=e.$(".locator",this.moduleElement),this.localNewsElement=e.$(".locator-stories-placeholder",this.moduleElement),this.titleLink=e.$("a",this.moduleTitle);var u=e.$(".weather-dropdown",this.moduleElement);u.length&&(this.weatherLocation=new a,this.weatherLocationView=new f(u),e.pubsub.on("weather:locationChanged",e.$.proxy(this.setTitleLink,this))),this.local=new n({simple:o.local&&o.local.simple?o.local.simple:!1,story_limit:o.local&&o.local.story_limit?o.local.story_limit:2,append_ext:o.local&&o.local.append_ext?o.local.append_ext:undefined}),this.type="average",o.local&&o.local.weather_type&&(this.type=o.local.weather_type),this.weather=new i({type:this.type,append_ext:o.local&&o.local.append_ext?o.local.append_ext:undefined}),this.localView=new r(l.LOCAL,this.moduleElement),this.weatherView=new s(l.WEATHER),this.locatorElement.length&&this.renderLocator(),this.localNewsElement.length&&this.renderLocal(),this.renderWeather(),this.show()},setTitle:function(e,t){t&&(e='<a href="{{link}}">{{title}}</a>'.replace("{{link}}",t).replace("{{title}}",e)),this.moduleTitle.html(e)},setTitleLink:function(e){this.weatherBaseUrl||(this.weatherBaseUrl=this.titleLink[0].href),this.titleLink.attr("href",this.weatherBaseUrl+"/"+e.id.toString().toLowerCase())},renderLocator:function(){t.open(l.LOCATOR),this.location=t.getLocation(),this.location||(this.setTitle(u.get("localNewsAndWeather")),e.pubsub.emit("locator:renderForm"))},renderLocal:function(){this.local.updateLocalNews(this.location)},renderWeather:function(){this.weather.updateWeather(this.location)},show:function(){this.moduleElement.removeClass("hidden")},hide:function(){this.moduleElement.addClass("hidden")}};return c})}catch(e){}define("module/components/weatherAdaptor",["module/localnewsandweather"],function(e){e.init("#comp-weather")}),define("module/comscoreAdapter",["config","module/stats/comscore"],function(e,t){var n=new t(e);n.sendPageViewBeacon()}),define("module/continuousPlay",["module/bootstrap","module/featureDetector","vendor/bbc-video-experience/continuousPlay/module"],function(e,t,n){var r=e.pubsub,i,s=!1,o=function(s,o){i=o||{};if(f(!0))return;if(typeof i.enabled=="undefined"||!u(a()?"international":"domestic"))return;n.init(s,{staticPrefix:e.config.staticPrefix,adsEnabled:t.is("DisplayingGnlAds"),pluginPath:"/js/vendor/bbc-video-experience/continuousPlay/smp/",countdownDuration:5,updateBrowserUrl:{enabled:!0,updateHistory:!1},advertAssetType:i.advertAssetType,autoPlayFirstItem:i.autoPlayFirstItem,handlers:{enabled:function(e){r.emit("continuousPlay:videoPlayed",[e])},videoPlayed:function(e){r.emit("continuousPlay:videoPlayed",[e])},dismissed:function(){r.emit("continuousPlay:dismissed")}}}),r.on("player:initialised",function(e){n.initBump(e)})},u=function(e){return typeof i.enabled[e]!="undefined"&&i.enabled[e]},a=function(){return typeof orb.fig=="function"&&!orb.fig("uk")},f=function(e){return typeof orb.fig!="function"?e:orb.fig("mb")===undefined?e:orb.fig("mb")};return{init:o}}),define("module/dotcom/handlerAdapter",["module/dotcom/handler"],function(e){e.init()}),define("module/findLocalNewsAdaptor",["module/findLocalNews"],function(e){e.init()}),define("module/gazzetta",["module/bootstrap","module/tabbed/tabbed"],function(e,t){return{init:function(){var n=e.$,r=n("#tracker-tab li"),i=n(".tracker-container"),s=r[0]?new t(r,i):null,o;n("#tracker-tab").attr("data-knockout-status")==="started"&&s.tabs[1].activate(),n(".knockout__title").on("click",function(e){n(this).parent().toggleClass("knockout--closed")}),n(".live-scores__refresh").on("click",function(e){e.preventDefault();var t=n(this),r=t.closest(".live-scores").attr("id");return window.location.href=t.attr("href")+"#"+r,window.location.reload(),!1})}}}),define("module/gazzettaAdapter",["module/bootstrap","module/gazzetta"],function(e,t){e.$(".live-scores").length&&t.init()}),define("module/hotspot/handlerAdapter",["module/hotspot/handler"],function(e){e.init()}),define("module/hotspot/handlerPostLoad",["module/hotspot/handler"],function(e){return{reProcess:e.init}}),define("module/iconLoaderAdapter",["module/iconLoader"],function(e){e.init()}),define("module/index",["module/bootstrap","module/imageenhancer","module/timestamp","module/history/history","module/localnewsandweather","module/components/rollingNews","module/sport/sportView","module/gazzetta","config"],function(e,t,n,r,i,s,o,u,a){var f=e.$;return{init:function(){var e=new n((new Date((new Date).toUTCString())).getTime()),r=f("#travel"),i=new o;new t,a.features.localnews&&a.locatorFlagPole&&require(["module/localnewsandweather"],function(e){e.init("#comp-weather")}),f(".rolling-news").length&&s.init(),f("#comp-sport-stories").length>0&&i.init(f("#comp-sport-stories")),f(".live-scores").length&&u.init()}}}),define("module/indexTitleAdaptor",["module/indexTitle"],function(e){e.init()}),define("module/live-event-component",["config","module/bootstrap","module/poller","module/timestamp"],function(e,t,n,r){return{pollingUrl:function(e,t,n){return typeof t=="undefined"&&(t={service:"nfp"}),e+"/"+t.service+"/walkietalkie/latest_index_asset/"+n},handleSuccess:function(){e.features.liveeventcomponent&&this.init(e.pollingHost,null)},init:function(i,s){var o=t.$,u=this;o("[data-channel]").each(function(){var t=o(".article-inner",this),a=o(".live-event-summary",t),f=o(".live-event-entries",t),l=o(this).attr("data-channel"),c=new n(30),h="",p=u.pollingUrl(i,e,l);c.startCacheBusting(),c.setUrl(p),c.startPolling({success:function(e){o.trim(f.html())||a.remove();if(e.entryId!==h){var t=null;if(e.createTime){var n=e.createTime.split(/[\-T:]/g),i=new Date(n[0],n[1]-1,n[2]);i.setHours(n[3],n[4],n[5]);var u=((new Date).getTime()-i.getTime())/1e3,l=new r(null),c=l.timeAgoInWords(u);c&&(t='<em class="entry-timestamp">'+c+"</em>")}if(t){var d=e.html.indexOf(">")+1,v=e.html.substring(0,d),m=e.html.substring(d);e.html=v+t+m}return s?s(f,e.html):(f.css("opacity","0"),setTimeout(function(){f.html(e.html).css("opacity","1")},1200)),h=e.entryId,p}},error:function(){o.trim(f.html())||(f.css("display","none"),a.css("visibility","visible"),c.stopPolling())}})})}}}),define("module/local/localSwift",["module/bootstrap","module/components/swift/collection"],function(e,t){return{init:function(){e.pubsub.on("local:handleLoaded",t.cleanup),e.pubsub.on("local:newsRendered",t.init)}}}),define("module/local/localSwiftAdapter",["module/local/localSwift"],function(e){e.init()}),define("module/localisation/scriptToggleAdapter",["module/localisation/scriptToggle"],function(e){e.init()}),define("module/locator",["config","module/bootstrap","vendor/locator/main"],function(e,t,n){return new n({pubsub:t.pubsub,enableReverseGeocode:e.local&&e.local.allowLocationLookup?e.local.allowLocationLookup:!1,enableAutoComplete:e.local&&e.local.allowAutoComplete?e.local.allowAutoComplete:!1,host:e.locatorHost,confirmLocationSelection:!0,persistLocation:!0})}),define("module/mediaAssetPage/assetView",["module/bootstrap","module/media/mediaLoader","module/media/mediaFilter","module/media/longformFilter","module/timestamp","translator","config","deviceInspector","module/featureDetector","module/page"],function(e,t,n,r,i,s,o,u,a,f){function h(t,n,r,s){y(t,null,n,r,s),c=new i((new Date((new Date).toUTCString())).getTime()),e.pubsub.on("map:asset:request:success",w),e.pubsub.on("map:asset:request:error",S),e.pubsub.on("video:load",p),e.pubsub.on("map:asset:load",function(){l("#media-asset-page-video figure").remove()}),g()}function p(){var e=l("#media-asset-placeholder");e.length&&e.addClass("hide-placeholder")}function d(e){l(".story-inner .more-wrapper").css("display","block"),l(".story-inner .more-text").text(s.get("moreInfo"));var t=l(".map-body",e),n=1;t.children().first().is("figure")&&n++,e.addClass("contains-more-text"),t.append('<div class="hide-wrapper extra-content"></div>');var r=l(".hide-wrapper",e);l(".map-body > *",e).each(function(){n===0&&!l(this).hasClass("hide-wrapper")?r.append(this):--n}),t.removeClass("display-feature-phone-only")}function v(){var t=l(".story-inner"),n=l("#media-asset-page-text",t),r=l(".map-body",n),i='<div class="more-wrapper" style="display: none;"><a class="more-text" href="#" title="'+s.get("moreInfo")+'">'+s.get("moreInfo")+"</a></div>";n.after(i),l(".more-text",t).on("click",function(t){var r=t.target,i=l(".hide-wrapper",n);i.toggleClass("extra-content"),i.hasClass("extra-content")?(e.pubsub.emit("map:asset:summary",["close"]),r.innerHTML=s.get("moreInfo"),r.setAttribute("title",s.get("moreInfo"))):(e.pubsub.emit("map:asset:summary",["open"]),r.innerHTML=s.get("lessInfo"),r.setAttribute("title",s.get("lessInfo"))),t.preventDefault()})}function m(t){t!=="desktop"&&!x()&&(e.pubsub.off("device",m),v(),d(l(".story-inner #media-asset-page-text")))}function g(){var t=l(".story-inner"),n=l("#media-asset-page-text",t),r=l(".more-text",t),i=l(".map-body > *",n).length;i<=1||i===2&&l(".map-body .related-items",n).length>0||u.getType()==="desktop"||x()?(l(".map-body",n).removeClass("display-feature-phone-only"),r.css("display","none"),n.removeClass("contains-more-text"),e.pubsub.on("deviceGroup",m)):(l(".more-text",t).length===0&&v(),d(n))}function y(e,i,s,o,u){var f,l,c=e.videos?e.videos:e.audios,h=c===e.videos?"video":"audio",p,d,v,m;o=typeof o!="undefined"?o:!0;for(f in c.primary)if(c.primary.hasOwnProperty(f)){l=c.primary[f],p=f;break}d={width:"100%",height:"100%",mediaType:h,forceErrorMessages:!0,mediaId:p,adsEnabled:o,autoplay:u},i&&(d.assetId=i),s&&(l.vpid=s),l.sourceFiles&&(v=new n(l.sourceFiles,h),d.href=v.url),l.image||(l.image=b(e));if(a.can("PlayProgressiveDownload")&&l.hasOwnProperty("href")&&!r.isLongformContent(l.href)){var g=window.location;l.href=g.origin+g.pathname+"/smp_playlist.xml"+g.search}m=new t("#media-asset-page-video",l,d)}function b(e){var t,n=[];if(e.images&&e.images.index){var r=e.images.index;for(t in r)r.hasOwnProperty(t)&&n.push(r[t]);return n.sort(function(e,t){return e.width===t.width?0:e.width<t.width?1:-1}),n[0]}return{}}function w(e,t){E(t.countername),y(t.media,t.assetId);var n=l("#media-asset-page-text");l("#media-asset-page-text").html(t.body),c.insertTime(),g(),T(t.related),window.scrollTo(0,1)}function E(e){f.setCountername(e)}function S(e,t,n){}function x(){var e=!1;return o.features2.hasOwnProperty("channel_page")&&(e=o.asset.asset_uri===o.pathPrefix+"/"+o.features2.channel_page.candy_id),e}function T(e){e.match("media-feed-error")?(l(".media-feed.primary-feed.related-video-audio").addClass("hidden"),l("#media-asset-list-view__tab-1").addClass("hidden off-screen")):(l(".media-feed.primary-feed.related-video-audio").removeClass("hidden"),l("#media-asset-list-view__tab-1").removeClass("hidden off-screen"))}var l=e.$,c;return{init:h}}),define("module/mediaAssetPage/continuousPlay/handler",["module/bootstrap","module/continuousPlay","module/mediaAssetPage/continuousPlay/dataProvider","module/mediaAssetPage/continuousPlay/view"],function(e,t,n,r){var i,s=function(e){i=e||{},i.advertAssetType="media_cplay",a(),n.init(i.dataProvider),r.init(),t.init(n,i)},o=function(e){var t=n.getMetaData(e)||{},i=r.getMediaAssetUri();r.updateTags(e),t.advert&&t.advert.uri!==i&&n.getMediaAsset(t.advert.uri,function(e,n){var i=t.advert.shortHeadline!==undefined?t.advert.shortHeadline:"";e?(r.hidePageContent(i),r.hideShareTools()):(n.body?r.updatePageContent($(n.body)):r.hidePageContent(i),n.shareTools?r.updateShareTools($(n.shareTools)):r.hideShareTools())})},u=function(){r.removeNextTag()},a=function(){e.pubsub.on("continuousPlay:videoPlayed",function(e){o(e)}),e.pubsub.on("continuousPlay:dismissed",function(){u()})};return{init:s}}),define("module/mediaAssetPage/mediaAssetPage",["module/bootstrap","module/transclude","module/mediaAssetPage/assetView","module/mediaAssetPage/listView","module/mediaAssetPage/api","module/mediaAssetPage/map","module/mediaAssetPage/continuousPlay/handler","module/featureDetector","deviceInspector","config"],function(e,t,n,r,i,s,o,u,a,f){var l=new i,c=function(e){var t=u.is("FromUK");if(t===undefined)return!1;var n=t?"domestic":"international";return!!e&&e[n]===!0};return{init:function(i,u,f,l,h,p){var d,v=i.videos?i.videos.primary:i.audios.primary;for(var m in v)if(v.hasOwnProperty(m)){d=m;break}var g=a.getType()!=="smart"&&c(p);h.autoPlayFirstItem=g,o.init(h),n.init(i,f,l,g),r.init(u),s.init();if(!e.config.features2.map_most_watched)e.pubsub.emit("map:feed:request:error",["most-watched"]);else{var y=new t;y.get(".media-tab.most-watched a",{target:".most-watched .media-feed-placeholder",success:function(){e.pubsub.emit("map:feed:request:success",["most-watched"])},error:function(){e.pubsub.emit("map:feed:request:error",["most-watched"])},insert:!0})}}}}),define("module/nav/nav",["module/bootstrap"],function(e){var t=e.$,n=function(e,t){this.button=e,this.nav=t,this.state=!1,this.name=this.button&&this.button.attr?this.button.attr("data-event"):"",this.setupBindings(),this.setupListeners()};return n.prototype={getName:function(){return this.name},setupListeners:function(){e.pubsub.on("nav:all:close",t.proxy(this.close,this)),e.pubsub.on(this.getEventName("close"),t.proxy(this.close,this)),e.pubsub.on("nav:all:open",t.proxy(this.open,this)),e.pubsub.on(this.getEventName("open"),t.proxy(this.open,this)),e.pubsub.on("tabs:click",t.proxy(this.close,this))},setupBindings:function(){this.button.on("click",t.proxy(function(t){t.preventDefault(),this.state?e.pubsub.emit(this.getEventName("close"),"close"):e.pubsub.emit(this.getEventName("open"),"open")},this)),this.nav.on("click",t.proxy(function(t){e.pubsub.emit(this.getEventName("close"),"close")},this))},close:function(){this.state=!1,t(".site-brand").removeClass(this.getOpenClass()),t("#js-navigation-sections-wrapper").removeClass(this.getOpenClass()),t(".navigation--footer").removeClass(this.getOpenClass())},open:function(){e.pubsub.emit("nav:all:close","close"),this.state=!0,!t(".navigation--footer").hasClass(this.getOpenClass())&&this.getName()==="footer"?t(".navigation--footer").addClass(this.getOpenClass()):(t("#js-navigation-sections-wrapper").addClass(this.getOpenClass()),t(".site-brand").addClass(this.getOpenClass()))},getOpenClass:function(){return"navigation__"+this.getName()+"--open"},getEventName:function(e){return"nav:"+this.getName()+":"+e}},n}),define("module/nav/navManager",["module/bootstrap","module/nav/nav","translator","config"],function(e,t,n,r){var i=e.$;return{init:function(){var e=i("#js-navigation-cta-header"),t=i("<button>"+e.html()+"</button>");i.each(e.prop("attributes"),function(){this.name!=="href"&&t.attr(this.name,this.value)}),e.replaceWith(t),this.bottomNav=i("#js-navigation-sections").removeAttr("role").removeAttr("aria-label"),this.topButton=i("#js-navigation-cta-header"),this.topNavPlaceholder=i(".navigation--open .navigation__panel"),this.createFooterButton(n.get("section")),this.cloneNavToHead(),this.createNavs()},createFooterButton:function(e){var t=r.service.charAt(0).toUpperCase()+r.service.slice(1);this.bottomNav.before('<button class="navigation__cta-footer" data-event="footer" role="navigation" aria-label="'+t+'">'+e+"</button>"),this.bottomButton=i(".navigation__cta-footer")},cloneNavToHead:function(){var e=this.bottomNav[0].cloneNode(!0);e.id="js-navigation-sections-header",this.bottomNav.addClass("footer").attr("id","js-navigation-sections-footer"),this.topNavPlaceholder.append(e),this.topNav=i(e)},createNavs:function(){new t(this.topButton,this.topNav),new t(this.bottomButton,this.bottomNav)}}}),define("module/navigation/handlerAdaptor",["module/navigation/handler"],function(e){e.init()}),define("module/touchEvents",["module/bootstrap","module/featureDetector"],function(e,t){var n=e.$,r={touchStart:function(e){this.startX=e.originalEvent.targetTouches[0].clientX,this.fastFlick=!0,setTimeout(n.proxy(function(){this.fastFlick=!1},this),this.flickTime)},touchMove:function(t){this.endX=t.originalEvent.targetTouches[0].clientX,this.transformFunction(this.endX-this.startX),e.pubsub.emit("touch:move"),this.enableTouchMove=!0},isSwipeOrFlick:function(e){return Math.abs(e)>this.flickDistance&&this.fastFlick||Math.abs(e)>this.swipeDistance},handleTouchMove:function(){var e=this.endX-this.startX;this.slidingElementContainer.addClass("snap-position"),this.isSwipeOrFlick(e)?(this.swipe=!0,e>0?(this.transformFunction(this.snapInterval),this.swipeDirection="right"):(this.transformFunction(-this.snapInterval),this.swipeDirection="left")):this.transformFunction(0)},touchEnd:function(){this.enableTouchMove&&this.handleTouchMove(),this.enableTouchMove=!1},setSnapInterval:function(e){this.snapInterval=window.document.documentElement.clientWidth*(1+e)},swipeEnd:function(){e.pubsub.emit("touchmove:"+this.swipeDirection),this.transformFunction(0),this.swipe=!1},transitionEnd:function(){this.slidingElementContainer.removeClass("snap-position"),this.swipe&&this.swipeEnd(),e.pubsub.emit("touch:end")},handleResize:function(){this.setSwipeDistance(),this.setSnapInterval(this.spaceBetweenItemsRatio)},bindEvents:function(){this.container.on("touchstart",n.proxy(function(e){this.touchStart(e)},this)),this.container.on("touchmove",n.proxy(function(e){e.preventDefault(),this.touchMove(e)},this)),this.container.on("touchend",n.proxy(function(){this.touchEnd()},this)),n(window).on("resize",n.proxy(function(e){this.handleResize()},this)),this.slidingElementContainer.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",n.proxy(function(){this.transitionEnd()},this))},setSwipeDistance:function(){this.swipeDistance=window.document.documentElement.clientWidth*this.swipeDistanceRatio},transform3d:function(e){this.slidingElementContainer.css("transform","translate3d("+e+"px,0,0)")},transform:function(e){this.slidingElementContainer.css("transform","translateX("+e+"px)")},positionLeft:function(e){this.slidingElementContainer.css("left",e)},setTransformFunction:function(){return this.canTransform3d=!1,t.can("CssTransform3d")?(this.canTransform3d=!0,this.transform3d):t.can("CssTransform")?this.transform:(n("body").addClass("no-translate"),this.positionLeft)},config:function(e){this.container=n(e.touchEventContainer),this.slidingElementContainer=n(e.slidingElementContainer),this.swipeDistanceRatio=.5,this.flickDistance=30,this.flickTime=250,this.setSwipeDistance(),this.spaceBetweenItemsRatio=e.spaceBetweenItemsRatio,this.setSnapInterval(this.spaceBetweenItemsRatio)},handleTouchEventsSupport:function(e){this.config(e),this.transformFunction=this.setTransformFunction(),this.canTransform3d&&this.transform3d(0),this.enableTouchMove=!1,this.bindEvents(),n("html").addClass("swipe-on")},init:function(e){t.can("TouchEvents")&&this.handleTouchEventsSupport(e)}};return r}),define("module/pictureViewer",["module/bootstrap","module/featureDetector","vendor/lo-dash/lo-dash","module/touchEvents","module/urlShrinker"],function(e,t,n,r,i){var s=e.$,o,u,a={global:null,body:s(".direction"),request:function(t,n){s.ajax({url:e.config.pathPrefix+"/api/pictures/"+t,type:"get",dataType:"json",success:function(t){n&&n(),e.pubsub.emit("pictureViewer:loaded",[t])}}),this.pictureViewerRequested=!0},loadViewer:function(e){this.body.append(e.body),r.init({touchEventContainer:"#picture-viewer",slidingElementContainer:".picture-viewer__pictures",spaceBetweenItemsRatio:.2}),this.pictureViewer=s("#picture-viewer"),this.pictureContainer=s(".picture-viewer__pictures")},setHeightToFillScreen:function(){s(".image-container").height(this.browserHeight)},setImageHeight:function(e,t){e.element.css({height:t})},setImageMaxWidth:function(e,t){e.element.css({"max-width":t+"px"})},getWindowMeasurements:function(){var e=this.doc.documentElement;this.browserHeight=e.clientHeight,this.browserWidth=e.clientWidth,this.browserRatio=this.browserWidth/this.browserHeight},calculateDimensions:function(e){var t=e.height,n=e.width,r=e.ratio,i=1/r,s={};return e.element.attr("style",""),n>this.browserWidth&&t>this.browserHeight?r>this.browserRatio?(s.maxWidth=this.browserWidth,s.height=i*this.browserWidth):(s.height=this.browserHeight,s.maxWidth=r*this.browserHeight):n>this.browserWidth?s.height=i*this.browserWidth:t>this.browserHeight?(s.maxWidth=r*this.browserHeight,s.height=this.browserHeight):(s.maxWidth=n,s.height=t),s},handleImageCalculations:function(){o(),this.setImageDimensions(this.image,this.calculateDimensions(this.image)),u()},setImageDimensions:function(e,t){t.maxWidth&&this.setImageMaxWidth(e,t.maxWidth),t.height&&this.setImageHeight(e,t.height)},replaceDivWithImage:function(e,t){var n=e.element;if(!n.hasClass("image--placeholder"))return;n.replaceWith('<img src="'+n.attr("data-hq-src")+'" id="'+n.attr("id")+'" width="'+n.attr("data-width")+'" height="'+n.attr("data-height")+'" class="image">'),e.element=s(".image").eq(t)},calculateImageData:function(){this.images=s(".image").map(function(){var e=s(this),t=e.attr("data-width"),n=e.attr("data-height");return{element:e,width:t,height:n,ratio:t/n}}),this.numberOfImages=this.images.length,this.imageContainers=s(".picture")},toggleViewerVisibility:function(e){this.pictureViewer&&this.pictureViewer.length?this.pictureViewer.toggleClass("hidden"):(this.loadViewer(e),this.calculateImageData(),this.getWindowMeasurements(),this.setHeightToFillScreen())},handleResize:function(){this.getWindowMeasurements(),this.setHeightToFillScreen(),this.handleImageCalculations()},toggleViewerEvent:function(){var t=s("html"),n="picture-viewer-enable";t.hasClass(n)?(t.removeClass(n),s(this.global).off("resize",s.proxy(this.handleResize,this)),e.pubsub.emit("pictureViewer:close")):(t.addClass(n),s(this.global).on("resize",s.proxy(this.handleResize,this)),e.pubsub.emit("pictureViewer:open"))},toggleViewer:function(e){this.toggleViewerVisibility(e),this.toggleViewerEvent(),this.changeImage(),this.updatePaginationText()},handlePictureInteraction:function(){var e=s("#js-photos").attr("data-asset-id");this.pictureViewerRequested?this.toggleViewer(""):this.request(e)},createGalleryHeadline:function(e){this.pictureViewer.find(".picture__information").prepend('<h3 class="picture__headline">'+this.galleryHeadline+"</h3>")},toggleCaptionButtonText:function(){var e=s(".picture-viewer__button--captions").find("span");e.toggleClass("show")},getPrevPictureNumber:function(){var e=this.numberOfImages;return this.currentPictureNumber!==0&&(e=this.currentPictureNumber),e-1},getNextPictureNumber:function(){var e=this.currentPictureNumber+1;return this.currentPictureNumber===this.numberOfImages-1&&(e=0),e},paginate:function(e){var t="getNextPictureNumber",n=0;e==="left"&&(t="getPrevPictureNumber"),this.currentPictureNumber=this[t](),this.setHash(this.currentPictureNumber+1)},updatePaginationText:function(){s(".picture__picture-no").text(this.currentPictureNumber+1),s(".picture__picture-total").text(this.numberOfImages)},handleStats:function(t){var n=[];t.visibility&&n.push(t.visibility),s("#asset-type-pgl").length&&(n.push(t.targetClass.indexOf(t.selector)!==-1?t.position:t.defaultPosition),e.pubsub.emit(t.pubsubEvent,n))},statsBackButton:function(e){this.handleStats({position:"top",selector:"picture-viewer__button--back",defaultPosition:"bottom",pubsubEvent:"gallery:viewer:toggle",targetClass:e.target.className})},statsShowImageOnlyButton:function(){var t=this.pictureViewer.hasClass("show-image-only")?"on":"off";e.pubsub.emit("gallery:imageonly:toggle",[t])},statsCaptionButton:function(){var t=this.pictureViewer.hasClass("hide-captions")?"off":"on";e.pubsub.emit("gallery:caption:toggle",[t])},statsNavigation:function(e){this.handleStats({position:"left",selector:"picture-viewer__pagination--left",defaultPosition:"right",visibility:t.is("TouchDevice")?"off":"on",pubsubEvent:"gallery:paginate:click",targetClass:e&&e.target?e.target.className:""})},processPictureViewer:function(e,t){this.galleryHeadline=t,this.currentPictureNumber=e-1,this.handlePictureInteraction()},handlePaginateEvent:function(e,t){this.enableHiddenButtons&&(this.paginate(t),this.changeImage(),this.updatePaginationText(),this.statsNavigation(e)),this.enableHiddenButtons=!0},handleRemovalOfCoveringScreen:function(){var e=s("#js-hidegallery");e.length&&window.setTimeout(function(){e.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.remove()}),t.can("CssTransition")||e.remove(),e.addClass("hidden-content--visible")},0)},handleTurningHiddenButtonsOff:function(){this.enableHiddenButtons=!1},handleTurningHiddenButtonsOn:function(){this.enableHiddenButtons=!0},handlePictureSlidingRight:function(){this.paginate("right"),this.changeImage()},handlePictureSlidingLeft:function(){this.paginate("left"),this.changeImage()},handlePictureViewerLoaded:function(t){this.toggleViewer(t),this.createGalleryHeadline(),this.shareTools=this.pictureViewer.find(".share"),this.handleBackButtonFunctionality(),this.pictureViewer.on("click","#js-prev-picture",s.proxy(this.handleMovingToPrevPicture,this)),this.pictureViewer.on("click","#js-next-picture",s.proxy(this.handleMovingToNextPicture,this)),this.pictureViewer.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",s.proxy(this.updatePaginationText,this)),s(document).on("keydown",s.proxy(this.emitKeyEvents,this)),s(".picture-viewer__button--captions").on("click",s.proxy(this.handleTogglingCaptions,this)),s(".picture-viewer__show-image-only").on("click",s.proxy(this.handleTogglingUI,this)),s(".picture-viewer__button--grid").on("click",s.proxy(this.handleGoingBackToTheGrid,this)),s(".share__button").on("click",s.proxy(this.handleTogglingShareToolsVisibility,this)),i.find("#picture-viewer .shortenUrl").bindEvents(),e.pubsub.emit("pictureViewer:loadcomplete",[t])},emitKeyEvents:function(t){t.keyCode===37?e.pubsub.emit("key:left"):t.keyCode===39?e.pubsub.emit("key:right"):t.keyCode===27?e.pubsub.emit("key:escape"):t.keyCode===13&&e.pubsub.emit("key:enter")},handleTogglingCaptions:function(){this.shareTools.hasClass("share--visible")&&this.shareTools.hasClass("share--sliding")&&this.handleTogglingShareToolsVisibility(),this.pictureViewer.toggleClass("hide-captions"),this.toggleCaptionButtonText(),this.statsCaptionButton()},handleTogglingUI:function(){this.enableHiddenButtons&&(this.pictureViewer.toggleClass("show-image-only"),this.statsShowImageOnlyButton()),this.enableHiddenButtons=!0},handleMovingToPrevPicture:function(e){this.handlePaginateEvent(e,"left")},handleMovingToNextPicture:function(e){this.handlePaginateEvent(e,"right")},handleGoingBackToTheGrid:function(e){this.toggleViewerVisibility(),this.toggleViewerEvent(),this.setHash(""),this.statsBackButton(e)},handleBackButtonFunctionality:function(){var e=s(".picture-viewer__button--back");this.global.history.length===1?e.remove():e.on("click",s.proxy(this.goBack,this))},goBack:function(){this.global.history.back()},handleTogglingShareToolsVisibility:function(){!this.pictureViewer.hasClass("hide-captions")&&this.shareTools.hasClass("share--sliding")&&this.handleTogglingCaptions(),this.shareTools.toggleClass("share--visible")},bindEvents:function(){e.pubsub.on("gallery:picture:click",s.proxy(this.processPictureViewer,this)),e.pubsub.on("pictureViewer:open",s.proxy(this.handleRemovalOfCoveringScreen,this)),e.pubsub.on("touch:move",s.proxy(this.handleTurningHiddenButtonsOff,this)),e.pubsub.on("touch:end",s.proxy(this.handleTurningHiddenButtonsOn,this)),e.pubsub.on("touchmove:left",s.proxy(this.handlePictureSlidingRight,this)),e.pubsub.on("touchmove:right",s.proxy(this.handlePictureSlidingLeft,this)),e.pubsub.on("pictureViewer:loaded",s.proxy(this.handlePictureViewerLoaded,this)),e.pubsub.on("key:left",s.proxy(this.handleMovingToPrevPicture,this)),e.pubsub.on("key:right",s.proxy(this.handleMovingToNextPicture,this)),e.pubsub.on("key:escape",s.proxy(this.goBack,this)),e.pubsub.on("key:enter",s.proxy(this.handleTogglingCaptions,this))},setPictureClasses:function(e,t){this.imageContainers.removeClass("picture--before-current"),this.imageContainers.removeClass("picture--current"),this.imageContainers.removeClass("picture--after-current"),this.imageContainers.eq(e).addClass("picture--before-current"),this.imageContainers.eq(this.currentPictureNumber).addClass("picture--current"),this.imageContainers.eq(t).addClass("picture--after-current")},setImages:function(){var e=this.getPrevPictureNumber(),t=this.getNextPictureNumber();this.prevImage=this.images.eq(e)[0],this.image=this.images.eq(this.currentPictureNumber)[0],this.nextImage=this.images.eq(t)[0],this.setPictureClasses(e,t),this.setHash(this.currentPictureNumber+1)},changeImage:function(){this.setImages(),this.handleImageCalculations(),this.replaceDivWithImage(this.prevImage,this.getPrevPictureNumber()),this.replaceDivWithImage(this.image,this.currentPictureNumber),this.replaceDivWithImage(this.nextImage,this.getNextPictureNumber()),this.handleImageCalculations()},checkTouchSupport:function(){t.is("TouchDevice")||s("body").addClass("no-touch")},withinValidRange:function(e){return e>0&&e<=s(".photo").length},updateShareToolsUrl:function(){var e=this.stripHashCharacter();this.pictureViewer.find(".share__tool a").each(function(t,n){var r=n.href.replace(/%23$|%23\d+$|$/i,"%23"+e),i=n.getAttribute("data-target-url"),s=i?i.replace(/#$|#\d+$|$/i,"#"+e):null;n.href=r,n.setAttribute("data-target-url",s)})},stripHashCharacter:function(){return this.global.location.hash.slice(1)},checkHash:function(e){e=this.stripHashCharacter(),e=this.global.parseInt(e),this.withinValidRange(e)&&this.processPictureViewer(e,s("h1").html())},setHash:function(e){this.global.location.replace("#"+e),this.updateShareToolsUrl()},checkDevice:function(){t.is("IE10")&&s("body").addClass("ie10"),t.is("WindowsPhone")&&s("body").addClass("windows-phone")},init:function(e){this.global=e||window,this.doc=this.global.document,this.checkDevice(),this.pictureViewerRequested=!1,this.enableHiddenButtons=!0,this.currentPictureNumber=0,this.checkTouchSupport(),this.bindEvents()}};return o=n.debounce(function(){a.setImageDimensions(a.prevImage,a.calculateDimensions(a.prevImage))},100),u=n.debounce(function(){a.nextImage&&a.setImageDimensions(a.nextImage,a.calculateDimensions(a.nextImage))},100),a}),define("module/pictureGallery",["module/bootstrap","deviceInspector","vendor/lo-dash/lo-dash","module/pictureViewer"],function(e,t,n,r){var i=e.$,s,o={setConfigProperties:function(){var n=e.config.features2&&e.config.features2.rtl?"margin-right":"margin-left";this.threshold=t.getType()==="smart"?150:200,this.gutter=parseInt(i(".photo").eq(0).css(n),10),this.containerWidth=i("#js-photos").width()},getImages:function(){return i(".photos img")},getListOfImageRatios:function(e){return i.map(e,function(e){return e=i(e),{element:e[0],ratio:e.attr("width")/e.attr("height")}})},addArrayElements:function(e){var t=0;for(var n=0;n<e.length;n++)t+=e[n];return t},calculateRowLength:function(e){var t;return t=i.map(e,function(e){return e.ratio}),Math.ceil(this.addArrayElements(t)*this.threshold)},setRowHeight:function(e,t){i.each(e,function(e,n){i(n.element).css({height:t+"px",width:Math.floor(n.ratio*t)+"px"})})},calculateAvailableWidth:function(e){var t;return t=this.gutter*e,this.containerWidth-t},calculateRowHeight:function(e,t){return Math.floor(this.threshold/e*t)-1},processImageRowsRecursively:function(e){var t,n,r,i,s=1;while(s<=e.length)t=this.calculateRowLength(e.slice(0,s)),n=this.calculateAvailableWidth(s),t>n&&(r=this.calculateRowHeight(t,n),i=e.splice(0,s),this.setRowHeight(i,r),this.processImageRowsRecursively(e)),s+=1;e.length&&this.setRowHeight(e,this.threshold)},calculateImages:function(){var e=this.allImages.slice(0);this.processImageRowsRecursively(e),i("#js-photos").addClass("grid-layout-complete")},storeImage:function(){o.loadedImages.push(this),e.pubsub.emit("image:stored")},processLoadedImages:function(){var e;while(e=this.loadedImages.shift())i(e).addClass("image-loaded")},isImageCached:function(){this.complete&&i(this).trigger("load")},checkHash:function(){window.location.hash&&e.pubsub.emit("pictureGallery:hashchange",[window.location.hash])},bindEvents:function(){e.pubsub.on("image:stored",i.proxy(this.processLoadedImages,this)),e.pubsub.on("pictureGallery:hashchange",i.proxy(r.checkHash,r)),i(".photos img").one("load",o.storeImage).each(this.isImageCached),i(".photos img").on("click",function(){e.pubsub.emit("gallery:picture:click",[this.getAttribute("data-photo-no"),i("h1").html()])}),i(window).on("resize",s),e.pubsub.on("pictureViewer:open",i.proxy(function(){i(window).off("resize",s)},this)),e.pubsub.on("pictureViewer:close",i.proxy(function(){this.setConfigProperties(),this.calculateImages(this.allImages),i(window).on("resize",s)},this))},init:function(){r.init(),this.loadedImages=[],this.allImages=this.getListOfImageRatios(this.getImages()),this.imageCount=this.allImages.length,this.setConfigProperties(),this.calculateImages(),this.bindEvents(),this.checkHash()}};return s=n.debounce(function(){o.setConfigProperties(),o.calculateImages(o.allImages)},50),o}),define("module/pulseSurvey",["config"],function(e){function f(e){return Math.floor(Math.random()*e)===0}function l(){return!!document.getElementById("bbccookies-prompt")}function c(){return document.cookie.indexOf(r)===0||document.cookie.indexOf("; "+r)!==-1}function h(e,t){var n=document.getElementById(e);n.addEventListener?n.addEventListener("click",t,!1):n.attachEvent&&n.attachEvent("onclick",t)}function p(){var e,t=new Date;t.setDate(t.getDate()+n),e=r+"; expires="+t.toGMTString()+"; path=/"+a+"; domain=",document.cookie=e+"bbc.co.uk;",document.cookie=e+"bbc.com;"}function d(e){var n,r,f=document.createElement("div");switch(a){case"news":r=(e?s:i).replace("{siteid}",t);break;case"hausa":r=u;break;default:r=o.replace("{service}",a)}n=document.getElementById("orb-pulse-tmpl").innerHTML.replace("<![CDATA[","").replace("]]>","").replace(/\{\{pulseaccepthref\}\}/g,r),f.innerHTML=n,document.getElementById("blq-pre-mast").appendChild(f)}function v(){h("pulse-reject",function(e){return e=e||window.event,p(),document.getElementById("pulse-container").style.display="none",e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1}),h("pulse-accept",function(e){return p(),!0})}var t=972352687,n=90,r="ckns_pulse=1",i="http://ecustomeropinions.com/survey/survey.php?sid={siteid}",s="http://www.edigitalresearch.com/test/?sid={siteid}&vault=_",o="https://six.surveys.com/projects/UKC14000152/default.asp?fromsrc=www.bbc.co.uk/{service}&js=no&langid=11",u="https://six.surveys.com/projects/UKC14000152M/start.asp",a;return{init:function(t,n){t==="zhongwen"?a=t+"/"+e.languageVariant:a=t,"getElementById"in document&&"cookie"in document&&(n.override||!c()&&!l()&&f(n.probability))&&(d(n.override),v())}}}),define("module/radioPlayerLink",[],function(){var e=function(e){var t=this.getAttribute("data-radio-player-link");window.open(t,"BBC","toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=512,height=270,left=0,top=0"),e.preventDefault()},t=document.querySelectorAll("[data-radio-player-link]"),n=t.length;while(n--)t[n].addEventListener("click",e,!1)}),define("module/recommendationsAdapter",["module/bootstrap","module/components/recommendations"],function(e,t){t.init("#comp-story-recommendations")}),define("module/rumAdaptor",["module/rum"],function(e){e.init()}),define("module/shareTools",["module/bootstrap","deviceInspector"],function(e,t){return{init:function(){var n,r,i,s,o=e.$;t.getType()==="desktop"&&(r=o(".share"),i=this,n=o(".share__tool--facebook a",r),n.on("click",function(e){e.preventDefault(),i.openSharePopup("Facebook",n)}),s=o(".share__tool--twitter a",r),s.on("click",function(e){e.preventDefault(),i.openSharePopup("Twitter",s)}))},openSharePopup:function(e,t){e==="Facebook"?window.open(t.attr("href"),"Facebook_Share","width=650,height=280"):e==="Twitter"&&window.open(t.attr("href"),"Twitter_Share","width=550,height=420")}}}),define("module/simpleXMLHttpRequest",[],function(){var e=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onload=function(){n.status>=200&&n.status<400&&t(n.responseText)},n.onerror=function(){},n.send()};return e}),define("module/sport/sportViewAdapter",["module/sport/sportView"],function(e){$("#comp-sport-stories").length>0&&e.init($("#comp-sport-stories"))}),define("module/stats/statsSubscriberAdapter",["module/stats/statsConfig","module/stats/statsSubscriber"],function(e,t){new t(e)}),define("module/story",["module/bootstrap","module/timestamp","module/imageenhancer","module/transclude","module/media/mediaHandler","config"],function(e,t,n,r,i,s){return{init:function(){var o=new t((new Date((new Date).toUTCString())).getTime()),u=new n(".story-body figure img,.story-body .HTML5figure img"),a=new r;e.$(".column--primary > .share--lightweight").addClass("show"),e.$(".column--primary > .share__title--lightweight").show();if(s.features.video){var f=new i;f.createMedia()}}}}),define("module/strategiserAdaptor",["module/strategiser"],function(e){e.init()}),define("module/tableScrollAdapter",["module/tableScroll"],function(e){e.init()}),define("vendor/locator/autoCompleteView",["module/bootstrap"],function(e){var t,n,r,i;return t=e.$,r=2,i=500,n=function(){var n=this;this.inputHasFocus=!1,this.hasMouseDown=!1,this.$searchResults=null,this.highlightedSearchResultIndex=null,this.input=document.getElementById("locator-search-input"),this.$input=t("#locator-search-input"),this.$input.attr("autocomplete","off"),this.keyCode={enter:13,escape:27,upArrow:38,downArrow:40},this.input&&(this.$input.on("focus.locatorAutoCompleteInput",function(e){n.startInteraction(),e.preventDefault()}),this.$input.on("blur.locatorAutoCompleteInput",function(e){n.hasMouseDown||n.stopInteraction(),e.preventDefault()})),e.pubsub.on("locator:autoCompleteSearchResults",function(e){n.inputHasFocus&&(n.stopWaitingForRequest(),n.renderSearchResults(e))}),e.pubsub.on("locator:renderChangePrompt",function(e){n.inputHasFocus&&(n.stopInteraction(),n.currentSearchTerm=null)}),e.pubsub.on("locator:error",function(e,t){"autocomplete"===t&&n.stopWaitingForRequest(),e&&e.flagpoles&&!e.flagpoles.autoComplete&&(n.stopInteraction(),n.$input.off("focus.locatorAutoCompleteInput"),n.$input.off("blur.locatorAutoCompleteInput"))})},n.prototype.checkInput=function(){var t,n,r;t=this,n=this.prepareSearchTerm(this.input.value),r=this.isValidSearchTerm(n);if(!r)return this.$searchResults&&(this.clearInputChangedTimeout(),this.clearSearchResults()),this.currentSearchTerm=n,!1;if(this.currentSearchTerm===n||null!==this.highlightedSearchResultIndex)return!1;this.currentSearchTerm=n,this.clearInputChangedTimeout(),this.inputChangedTimeoutId=setTimeout(function(){e.pubsub.emit("locator:submitAutoCompleteSearch",[n]),t.startWaitingForRequest()},i)},n.prototype.prepareSearchTerm=function(e){return String(e).replace(/^\s\s*/,"").replace(/\s\s*$/,"")},n.prototype.isValidSearchTerm=function(e){var t,n;return"string"!=typeof e?!1:(t=this.prepareSearchTerm(e),n=t.length>=r,n?!0:!1)},n.prototype.renderSearchResults=function(e){var n,r,i,s;n=this,this.searchResultsData=e,s=e.results.length;if(0===s){this.clearSearchResults();return}null===this.$searchResults&&(t("body").append('<ul id="locator-autocomplete-results"></ul>'),this.$searchResults=t("#locator-autocomplete-results"),this.$searchResults.on("mouseover","li",function(e){n.highlightSearchResultByIndex(t(this).index(),!1)}).on("mouseout","li",function(e){n.searchResultMouseOutHandler(e.target)}),this.positionSearchResults(),this.addSearchResultClickListener(),n.addSearchResultKeyHandler()),r="";for(i=0;i<s;i++)r+="<li>"+e.results[i].fullName+"</li>";this.$searchResults.html(r)},n.prototype.clearSearchResults=function(){this.searchResultsData=null,this.highlightedSearchResultIndex=null,this.$searchResults&&(this.$searchResults.remove(),this.$searchResults=null,this.removeSearchResultKeyHandler())},n.prototype.addSearchResultKeyHandler=function(){var e;this.removeSearchResultKeyHandler(),e=this,t(document).on("keydown.locatorAutoCompleteSearchResults",function(t){e.keyDownHandler(t)})},n.prototype.removeSearchResultKeyHandler=function(){t(document).off("keydown.locatorAutoCompleteSearchResults")},n.prototype.keyDownHandler=function(e){switch(e.keyCode){case this.keyCode.escape:this.escapeKeyHandler();break;case this.keyCode.enter:this.enterKeyHandler(e);break;case this.keyCode.upArrow:e.preventDefault(),this.highlightPrevSearchResult();break;case this.keyCode.downArrow:this.highlightNextSearchResult();break;default:}},n.prototype.escapeKeyHandler=function(){null!==this.highlightedSearchResultIndex&&this.$input.val(this.currentSearchTerm),this.clearSearchResults()},n.prototype.enterKeyHandler=function(e){null!==this.highlightedSearchResultIndex&&(e.preventDefault(),this.submitSearchResultByIndex(this.highlightedSearchResultIndex)),this.clearInputChangedTimeout(),this.clearSearchResults()},n.prototype.highlightNextSearchResult=function(){var e;e=this.highlightedSearchResultIndex;if(null===e)e=0;else{e++;if(this.searchResultsData.results.length<=e){this.removeSearchResultHighlight(!0);return}}this.highlightSearchResultByIndex(e,!0)},n.prototype.highlightPrevSearchResult=function(){var e;e=this.highlightedSearchResultIndex;if(null===e)e=this.searchResultsData.results.length-1;else{e--;if(0>e){this.removeSearchResultHighlight(!0);return}}this.highlightSearchResultByIndex(e,!0)},n.prototype.highlightSearchResultByIndex=function(e,n){var r;this.removeSearchResultHighlight(),r=this.searchResultsData.results[e],this.highlightedSearchResultIndex=e,t(this.$searchResults.find("li")[e]).addClass("active"),n&&this.$input.val(r.fullName)},n.prototype.removeSearchResultHighlight=function(e){this.highlightedSearchResultIndex=null,this.$searchResults.find("li.active").removeClass("active"),e&&this.$input.val(this.currentSearchTerm)},n.prototype.searchResultMouseOutHandler=function(e){t(e).removeClass("active")},n.prototype.addSearchResultClickListener=function(){var t,n,r;t=this,this.$searchResults.on("mousedown",function(n){t.hasMouseDown=!0,e.$("body").one("mouseup",function(e){t.bodyMouseUpHandler(e)})})},n.prototype.bodyMouseUpHandler=function(e){var n,r;this.hasMouseDown=!1,this.$searchResults.find(e.target).length&&(r=t(e.target).index(),this.submitSearchResultByIndex(r)),this.clearSearchResults()},n.prototype.submitSearchResultByIndex=function(t){var n;n=this.searchResultsData.results[t],this.$input.val(n.fullName),e.pubsub.emit("locator:submitAutoCompleteLocation",[n.id,n.name])},n.prototype.positionSearchResults=function(){var e;e=this.$input.offset(),this.$searchResults.css({left:parseInt(e.left,0),top:parseInt(e.top,0)+this.$input.outerHeight()})},n.prototype.startInteraction=function(){var e=this;this.inputHasFocus=!0,this.$input.on("keyup",function(){e.checkInput()})},n.prototype.stopInteraction=function(){var e;e=this.$input.val(),null!==this.highlightedSearchResultIndex&&e!==this.currentSearchTerm&&(this.currentSearchTerm=e),this.clearInputChangedTimeout(),this.clearSearchResults(),this.stopWaitingForRequest(),this.$input.off("keyup"),this.inputHasFocus=!1},n.prototype.startWaitingForRequest=function(){this.$input.addClass("waiting")},n.prototype.stopWaitingForRequest=function(){this.$input.removeClass("waiting")},n.prototype.clearInputChangedTimeout=function(){this.inputChangedTimeoutId&&(clearTimeout(this.inputChangedTimeoutId),this.inputChangedTimeoutId=null)},n}),define("vendor/locator/bootstrap",["jquery","vendor/events/pubsub"],function(e){var t={pubsub:e,$:e,ajax:e.ajax};return t}),define("vendor/locator/locatorView",["module/bootstrap"],function(e){var t,n,r;return t="/locator/default/mobile/en-GB/confirm/",r=function(e){if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},n=function(t,n){var i=this,s='<div id="locator"><form id="locator-form" action="#">';n=n||{},typeof n.pubsub!="undefined"&&(e.pubsub=n.pubsub),this.inputPlaceholderMessage="Enter a UK town or postcode",this.autoCompleteEnabled=!1,!0===n.enableAutoComplete&&(this.autoCompleteEnabled=!0),this.supportsGeoLocation=!1,typeof navigator.geolocation!="undefined"&&n.enableReverseGeocode!==!1&&(this.geoLocationEnabled=!0,this.supportsGeoLocation=!0),this.supportsGeoLocation&&window.locator&&window.locator.disableGeoLocation&&(this.supportsGeoLocation=!1),this.supportsGeoLocation&&(s+='<a href="" id="locator-geolocation"><span class="link-text">Use my current location</span><span class="crosshair"></span></a><p id="geolocation-error"></p>'),s+='<div id="locator-search-container"><span class="locator-search-input"><label for="locator-search">Search Term</label><input id="locator-search-input" name="locator-search" type="text"/></span><input name="locator-submit" class="submit" type="submit" value="Search"/><button id="locator-submit" value="Search">Search <span class="magnifier"></span></button></div></form><p id="locator-message-search"/><ul id="locator-results"></ul><a id="locator-results-more" href="">Show More</a><a id="locator-prompt-change" href="">Change your location<span class="crosshair"></span></a></div>',e.$(t).append(s),this.elm=document.getElementById("locator"),this.form=document.getElementById("locator-form"),this.searchMessage=document.getElementById("locator-message-search"),this.changePrompt=document.getElementById("locator-prompt-change"),this.input=document.getElementById("locator-search-input"),this.results=document.getElementById("locator-results"),this.moreResults=document.getElementById("locator-results-more"),this.supportsPlaceholder=typeof this.input.placeholder!="undefined",this.supportsPlaceholder?this.input.placeholder=this.inputPlaceholderMessage:(this.inputFocusHandler=function(e){i.inputPlaceholderMessage===i.input.value&&(i.input.value="")},this.inputBlurHandler=function(e){""===i.input.value&&(i.input.value=i.inputPlaceholderMessage)},this.createEventListener(this.input,"focus",this.inputFocusHandler,!1),this.createEventListener(this.input,"blur",this.inputBlurHandler,!1)),this.autoCompleteView=null,this.autoCompleteEnabled&&require(["locator/autoCompleteView"],function(e){i.autoCompleteView=new e}),this.geolocation=null,this.supportsGeoLocation&&(this.geolocation=e.$("#locator-geolocation")[0],this.geolocationMessage=e.$("p#geolocation-error")[0]),this.formHandler=function(e){var t=i.input.value;return 0<t.length&&(i.input.blur(),i.clearResults(),i.sendSearchData(t.toLowerCase(),0)),r(e),!1},this.createEventListener(this.form,"submit",this.formHandler,!1),this.resultsHandler=function(t){var n,s,o,u,a;return r(t),n=t.target||t.srcElement,n.blur(),s=n.href,e.$("li",this).removeClass("selected"),e.$(n).parent("li").addClass("selected"),s&&0<s.length&&(a=s.match(/confirm\/(\w{0,2}\d+)\/?(\w+)?/),3===a.length&&(u=a[2]),2<=a.length&&(o=a[1],i.sendLocationData(o,u))),!1},this.createEventListener(this.results,"click",this.resultsHandler,!1),this.moreResultsHandler=function(t){r(t),i.moreResultsEnabled&&(e.$("#locator-results-error").remove(),i.disableMoreResults(),i.sendSearchData(i.currentResults.searchTerm,i.currentResults.offset+i.currentResults.limit))},this.createEventListener(this.moreResults,"click",this.moreResultsHandler,!1),this.supportsGeoLocation&&(this.geolocationClickHandler=function(t){r(t),i.geoLocationEnabled&&(i.clearResults(),i.disableGeolocation("active"),navigator.geolocation.getCurrentPosition(function(t){e.pubsub.emit("locator:geoLocation",[t])},function(e){var t="We were unable to detect your location.";e.code===e.PERMISSION_DENIED&&(t="Please enable Location Services in your device settings or browser"),i.setMessage(i.geolocationMessage,t,"error"),i.enableGeolocation()},{enableHighAccuracy:!0,maximumAge:60,timeout:1e4}))},this.createEventListener(this.geolocation,"click",this.geolocationClickHandler,!1)),this.createEventListener(this.changePrompt,"click",function(t){e.pubsub.emit("locator:changeLocationPrompt"),i.renderForm(),r(t)},!1),e.pubsub.on("locator:searchResults",function(e){i.renderSearchResults(e)}),e.pubsub.on("locator:newsLocalRegions",function(e){i.renderNewsLocalRegions(e)}),e.pubsub.on("locator:locationOutOfContext",function(e){i.setMessage(i.searchMessage,null),i.setMessage(i.geolocationMessage,"Sorry, location setting is not available for your location","error")}),e.pubsub.on("locator:renderForm",function(){i.renderForm()}),e.pubsub.on("locator:renderChangePrompt",function(){i.renderStopWait(),i.resetForm(),i.renderChangePrompt()}),e.pubsub.on("locator:renderWait",function(){i.renderWait()}),e.pubsub.on("locator:error",function(e,t){i.renderError(e,t)})},n.prototype.sendSearchData=function(t,n){e.pubsub.emit("locator:submitSearch",[t,n])},n.prototype.sendLocationData=function(t,n){e.pubsub.emit("locator:submitLocation",[t,n])},n.prototype.close=function(){this.elm.parentNode.removeChild(this.elm)},n.prototype.clearResults=function(){this.setMessage(this.searchMessage,null),this.setMessage(this.geolocationMessage,null),this.currentResults=null,this.results.innerHTML="",this.setMoreResultsDisplay("none")},n.prototype.renderChangePrompt=function(){this.setFormIsShown(!1),this.setChangePromptIsShown(!0)},n.prototype.renderForm=function(){this.setFormIsShown(!0),this.setChangePromptIsShown(!1),this.resetForm()},n.prototype.renderGeolocationResult=function(e){var t;this.resetForm(),this.setMessage(this.searchMessage,"Your location"),t='<li class="selected"><a href="#">'+e.name+"</a></li>",this.results.innerHTML=t,this.results.display=""},n.prototype.resetForm=function(){this.input.value=this.supportsPlaceholder?"":this.inputPlaceholderMessage,this.clearResults(),this.setMessage(this.searchMessage,null),this.enableGeolocation()},n.prototype.disableForm=function(){this.destroyEventListener(this.form,"submit",this.formHandler),this.createEventListener(this.form,"submit",function(e){return r(e),!1},!1),e.$("#locator-search-container").addClass("disabled"),e.$(this.input).attr("disabled",!0)},n.prototype.setFormIsShown=function(e){var t;t=e?"block":"none",this.form.style.display=t},n.prototype.setChangePromptIsShown=function(e){this.changePrompt.style.display=e?"block":"none"},n.prototype.enableMoreResults=function(){this.moreResultsEnabled=!0,e.$(this.moreResults).removeClass("disabled")},n.prototype.disableMoreResults=function(){this.moreResultsEnabled=!1,e.$(this.moreResults).addClass("disabled")},n.prototype.enableGeolocation=function(){this.geoLocationEnabled=!0,e.$(this.geolocation).removeClass("active")},n.prototype.disableGeolocation=function(t){this.geoLocationEnabled=!1,t=t||"disabled",e.$(this.geolocation).addClass(t)},n.prototype.setMessage=function(e,t,n){e&&(typeof n=="string"&&n.length>0&&(e.className=n),e.style.display=null===t||""===t?"none":"block",e.innerHTML=t)},n.prototype.setMoreResultsDisplay=function(e){e=e||"",this.moreResults.style.display=e},n.prototype.renderError=function(t,n){var r="Sorry an error has occurred, please try again";"autocomplete"!==n&&this.renderStopWait();if(t&&t.flagpoles){if(!t.flagpoles.locator){this.clearResults(),this.disableForm(),this.disableGeolocation(),this.setMessage(this.searchMessage,"Sorry location setting is not currently available","error");return}if(!t.flagpoles.reverseGeocode){this.disableGeolocation(),this.setMessage(this.geolocationMessage,'Sorry the "use my current location" feature is not currently available',"error");if("geolocate"===n)return}}"geolocate"===n?(this.setMessage(this.geolocationMessage,"Sorry an error occurred trying to detect your location. Please try again","error"),this.enableGeolocation()):"search"===n&&this.currentResults?e.$(this.moreResults).after('<p id="locator-results-error" class="error">'+r+"</p>"):"autocomplete"!==n&&this.setMessage(this.searchMessage,r,"error")},n.prototype.renderWait=function(){this.currentResults||this.setMessage(this.searchMessage,"Please wait...")},n.prototype.renderStopWait=function(){this.currentResults||this.setMessage(this.searchMessage,null)},n.prototype.renderSearchResults=function(n){var r,i,s="",o=t,u="?ptrt="+window.location,a=!1,f="";this.currentResults=n,this.renderStopWait(),this.enableGeolocation();if(0===n.results.length)this.setMessage(this.searchMessage,'There were no results for "'+n.searchTerm+'"');else{this.setMessage(this.searchMessage,"Search results:");for(i=0;i<n.results.length;i++)r=n.results[i],f=n.results.length===1?' class="selected"':"",s+="<li"+f+">",s+='<a href="'+o+r.id+u+'">'+r.name+"</a></li>"}this.results.style.display="",0===n.offset?(this.results.innerHTML=s,this.setFocusOnFirstResult(),a=n.limit<n.total):(e.$(this.results).append(s),a=n.offset+n.limit<n.total),this.setMoreResultsDisplay(a?"block":"none"),a&&this.enableMoreResults()},n.prototype.renderNewsLocalRegions=function(e){var n,r,i="",s=t+e.location.id+"/",o="?ptrt="+window.location;this.renderStopWait(),this.enableGeolocation(),this.setMessage(this.searchMessage,"Your chosen location falls between two News Regions. To set your location, please select one of the regions below.");for(r=0;r<e.regions.length;r++)n=e.regions[r],i+='<li><a href="'+s+n.id+o+'">'+n.name+"</a></li>";this.results.style.display="",this.results.innerHTML=i,this.setFocusOnFirstResult()},n.prototype.setFocusOnFirstResult=function(){var t;t=e.$("#locator-results li a"),t.length>0&&t[0].focus()},n.prototype.createEventListener=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n)},n.prototype.destroyEventListener=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n)},n}),define("vendor/locator/stats",["istats-1"],function(e){var t,n;return t=function(e,t){n=e,typeof t=="function"&&(this.logEvent=t)},t.prototype.logEvent=function(n,r){r=r||{},r.screen=t.isMDot(document.location.hostname)?"mobile":"desktop",e.log(n,"locator",r)},t.prototype.applyEvents=function(){var e;e=this,n.on("locator:open",function(){e.logEvent("open",{supports_geolocation:typeof navigator.geolocation!="undefined"?1:0,has_locserv_cookie:t.hasLocation()})}),n.on("locator:changeLocationPrompt",function(){e.logEvent("open")}),n.on("locator:geoLocation",function(t){e.logEvent("geo_location",{latitude:t.coords.latitude,longitude:t.coords.longitude})}),n.on("locator:searchResults",function(t){var n;if(t.total===0){e.logEvent("no_search_results",{ns_search_term:t.searchTerm});return}typeof t.offset=="undefined"&&(t.offset=0),typeof t.limit=="undefined"&&(t.limit=10),n={ns_search_term:t.searchTerm,offset:t.offset,page_num:(t.offset+t.limit)/t.limit},n.page_num>1?e.logEvent("more_results",n):e.logEvent("search",n)}),n.on("locator:submitAutoCompleteSearch",function(t){var n;n={ns_search_term:t},e.logEvent("autocomplete_search",n)}),n.on("locator:submitAutoCompleteLocation",function(t,n){var r;r={location_id:t,location_name:n},e.logEvent("autocomplete_click",r)}),n.on("locator:error",function(){e.logEvent("http_error")}),n.on("locator:locationChanged",function(t){var n;if(t===null)return;n={location_id:t.id,location_name:t.name},t.local_region&&(n.news_region=t.local_region),e.logEvent("confirm",n)}),n.on("locator:newsLocalRegions",function(t){var n,r,i;n={location_id:t.location.id,location_name:t.location.name},i=[];for(r in t.regions)t.regions.hasOwnProperty(r)&&i.push(t.regions[r].name);n.location_regions=i.join(", "),e.logEvent("news_local_regions",n)})},t.isMDot=function(e){return!!e.match(/^m\.([a-z\.]*)?bbc(\.co\.uk|\.com)$/)},t.getCookie=function(){return document.cookie},t.hasLocation=function(){var e;return e=this.getCookie().match("locserv=(.*?)(;|$)"),!e||e.length<2?!1:!0},t});